execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_48 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_dom_rem_trans_cnt_1m / NULLIF (transaction_dom_rem_trans_cnt_3m, 0) AS transaction_dom_rem_trans_cnt_1m_to_3m,
    transaction_dom_rem_trans_gum_1m / NULLIF (transaction_dom_rem_trans_sum_3m, 0) AS transaction_dom_rem_trans_sum_1m_to_3m,
    transaction_dom rem_trans_cnt_3m / NULLIF (transaction_dom_rem_trans_cnt_6m, 0) AS transaction_dom_rem_trans_cnt_3m_to_6m,
    transaction_dom_rem_trans_sum_3m / NULLIF (transaction_dom rem_trans_sum_6m, 0) AS transaction_dom_rem_trans_sum_3m_to_6m,
    transaction_dom_rem_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_dom_rem_trans_cnt_1m_to_total_1m, 
    transaction_dom_rem_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_dom_rem_trans_sum_1m_to_total_1m, 
    transaction_dom_rem_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_dom_rem_trans_cnt_3m_to_total_3m, 
    transaction_dom_rem_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_dom_rem_trans_sum_3m_to_total_3m,
    transaction_dom rem_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_dom_rem_trans_cnt_3m_to_total_6m, 
    transaction_dom_rem_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_dom_rem_trans_sum_3m_to_total_6m, 
    transaction_dom_rem_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_dom_rem_trans_cnt_6m_to_total_6m, 
    transaction_dom_rem_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_dom_rem_trans_sum_6m_to_total_6m, 
    transaction_dom_rem_trans_avg_sum_1m / NULLIF (transaction_dom_rem_trans_avg_sum_3m, 0) AS transaction_dom_rem_trans_avg_sum_1m_to_3m, 
    transaction_dom_rem_trans_avg_cnt_Im / NULLIF (transaction_dom_rem_trans_avg_cnt_3m, 0) AS transaction_dom rem_trans_avg_cnt_1m_to_3m, 
    transaction_dom_rem_trans_avg_sum_3m / NULLIF (transaction_dom_rem_trans_avg_sum_6m, 0) AS transaction_dom_rem_trans_avg_sum_3m_to_6m, 
    transaction_dom_rem_trans_avg_cnt_3m / NULLIF (transaction_dom_rem_trans_avg_cnt_6m, 0) AS transaction_dom_rem_trans_avg_cnt_3m_to_6m, 
    transaction_dom_rem_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_dom_rem_trans_avg_sum_1m_to_total_1m,
    transaction_dom_rem_trang_avg_cnt_1m / NULLIF (transaction_total_trang_avg_cnt_1m, 0) As transaction_dom_rem_trang_avg_cnt_1m_to_total_1m,
    transaction_dom_rem_trans_avg_gum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_dom_rem_trans_avg_sum_3m_to_total_3m, 
    transaction_dom_rem_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_dom_rem_trans_avg_cnt_3m_to_total_3m, 
    transaction_dom_rem_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_dom_rem_trans_avg_sum_3m_to_total_6m, 
    transaction_dom_rem_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_dom_rem_trans_avg_cnt_3m_to_total_6m, 
    transaction_dom_rem_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_dom_rem_trans_avg_sum_6m_to_total_6m, 
    transaction_dom_rem_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_dom_rem_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_1 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_49 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_cafe_trans_cnt_1m / NULLIF (transaction_cafe_trans_cnt_3m, 0) AS transaction_cafe_trans_cnt_1m_to_3m,
    transaction_cafe_trans_sum_1m / NULLIF (transaction_cafe_trans_sum_3m, 0) AS transaction_cafe_trans_sum_1m_to_3m,
    transaction_cafe_trans_cnt_3m / NULLIF (transaction_cafe_trans_cnt_6m, 0) AS transaction_cafe_trans_cnt_3m_to_6m,
    transaction_cafe_trans_sum_3m / NULLIF (transaction_cafe_trans_sum_6m, 0) AS transaction_cafe_trans_sum_3m_to_6m,
    transaction_cafe_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_cafe_trans_cnt_1m_to_total_1m, 
    transaction_cafe_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_cafe_trans_sum_1m_to_total_1m, 
    transaction_cafe_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_cafe_trans_cnt_3m_to_total_3m, 
    transaction_cafe_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_cafe_trans_sum_3m_to_total_3m,
    transaction_cafe_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_cafe_trans_cnt_3m_to_total_6m, 
    transaction_cafe_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_cafe_trans_sum_3m_to_total_6m, 
    transaction_cafe_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_cafe_trans_cnt_6m_to_total_6m, 
    transaction_cafe_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_cafe_trans_sum_6m_to_total_6m, 
    transaction_cafe_trans_avg_sum_1m / NULLIF (transaction_cafe_trans_avg_sum_3m, 0) AS transaction_cafe_trans_avg_sum_1m_to_3m, 
    transaction_cafe_trans_avg_cnt_1m / NULLIF (transaction_cafe_trans_avg_cnt_3m, 0) AS transaction_cafe_trans_avg_cnt_1m_to_3m, 
    transaction_cafe_trans_avg_sum_3m / NULLIF (transaction_cafe_trans_avg_sum_6m, 0) AS transaction_cafe_trans_avg_sum_3m_to_6m, 
    transaction_cafe_trans_avg_cnt_3m / NULLIF (transaction_cafe_trans_avg_cnt_6m, 0) AS transaction_cafe_trans_avg_cnt_3m_to_6m, 
    transaction_cafe_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_cafe_trans_avg_sum_1m_to_total_1m,
    transaction_cafe_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_cafe_trans_avg_cnt_1m_to_total_1m,
    transaction_cafe_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_cafe_trans_avg_sum_3m_to_total_3m, 
    transaction_cafe_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_cafe_trans_avg_cnt_3m_to_total_3m, 
    transaction_cafe_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_cafe_trans_avg_sum_3m_to_total_6m, 
    transaction_cafe_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_cafe_trans_avg_cnt_3m_to_total_6m, 
    transaction_cafe_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_cafe_trans_avg_sum_6m_to_total_6m, 
    transaction_cafe_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_cafe_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_2 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_50 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_rent_auto_trans_cnt_1m / NULLIF (transaction_rent_auto_trans_cnt_3m, 0) AS transaction_rent_auto_trans_cnt_1m_to_3m,
    transaction_rent_auto_trans_sum_1m / NULLIF (transaction_rent_auto_trans_sum_3m, 0) AS transaction_rent_auto_trans_sum_1m_to_3m,
    transaction_rent_auto_trans_cnt_3m / NULLIF (transaction_rent_auto_trans_cnt_6m, 0) AS transaction_rent_auto_trans_cnt_3m_to_6m,
    transaction_rent_auto_trans_sum_3m / NULLIF (transaction_rent_auto_trans_sum_6m, 0) AS transaction_rent_auto_trans_sum_3m_to_6m,
    transaction_rent_auto_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_rent_auto_trans_cnt_1m_to_total_1m, 
    transaction_rent_auto_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_rent_auto_trans_sum_1m_to_total_1m, 
    transaction_rent_auto_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_rent_auto_trans_cnt_3m_to_total_3m, 
    transaction_rent_auto_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_rent_auto_trans_sum_3m_to_total_3m,
    transaction_rent_auto_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_rent_auto_trans_cnt_3m_to_total_6m, 
    transaction_rent_auto_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_rent_auto_trans_sum_3m_to_total_6m, 
    transaction_rent_auto_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_rent_auto_trans_cnt_6m_to_total_6m, 
    transaction_rent_auto_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_rent_auto_trans_sum_6m_to_total_6m, 
    transaction_rent_auto_trans_avg_sum_1m / NULLIF (transaction_rent_auto_trans_avg_sum_3m, 0) AS transaction_rent_auto_trans_avg_sum_1m_to_3m, 
    transaction_rent_auto_trans_avg_cnt_1m / NULLIF (transaction_rent_auto_trans_avg_cnt_3m, 0) AS transaction_rent_auto_trans_avg_cnt_1m_to_3m, 
    transaction_rent_auto_trans_avg_sum_3m / NULLIF (transaction_rent_auto_trans_avg_sum_6m, 0) AS transaction_rent_auto_trans_avg_sum_3m_to_6m, 
    transaction_rent_auto_trans_avg_cnt_3m / NULLIF (transaction_rent_auto_trans_avg_cnt_6m, 0) AS transaction_rent_auto_trans_avg_cnt_3m_to_6m, 
    transaction_rent_auto_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_rent_auto_trans_avg_sum_1m_to_total_1m,
    transaction_rent_auto_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_rent_auto_trans_avg_cnt_1m_to_total_1m,
    transaction_rent_auto_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_rent_auto_trans_avg_sum_3m_to_total_3m, 
    transaction_rent_auto_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_rent_auto_trans_avg_cnt_3m_to_total_3m, 
    transaction_rent_auto_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_rent_auto_trans_avg_sum_3m_to_total_6m, 
    transaction_rent_auto_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_rent_auto_trans_avg_cnt_3m_to_total_6m, 
    transaction_rent_auto_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_rent_auto_trans_avg_sum_6m_to_total_6m, 
    transaction_rent_auto_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_rent_auto_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_3 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_51 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_transport_trans_cnt_1m / NULLIF (transaction_transport_trans_cnt_3m, 0) AS transaction_transport_trans_cnt_1m_to_3m,
    transaction_transport_trans_sum_1m / NULLIF (transaction_transport_trans_sum_3m, 0) AS transaction_transport_trans_sum_1m_to_3m,
    transaction_transport_trans_cnt_3m / NULLIF (transaction_transport_trans_cnt_6m, 0) AS transaction_transport_trans_cnt_3m_to_6m,
    transaction_transport_trans_sum_3m / NULLIF (transaction_transport_trans_sum_6m, 0) AS transaction_transport_trans_sum_3m_to_6m,
    transaction_transport_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_transport_trans_cnt_1m_to_total_1m, 
    transaction_transport_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_transport_trans_sum_1m_to_total_1m, 
    transaction_transport_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_transport_trans_cnt_3m_to_total_3m, 
    transaction_transport_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_transport_trans_sum_3m_to_total_3m,
    transaction_transport_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_transport_trans_cnt_3m_to_total_6m, 
    transaction_transport_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_transport_trans_sum_3m_to_total_6m, 
    transaction_transport_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_transport_trans_cnt_6m_to_total_6m, 
    transaction_transport_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_transport_trans_sum_6m_to_total_6m, 
    transaction_transport_trans_avg_sum_1m / NULLIF (transaction_transport_trans_avg_sum_3m, 0) AS transaction_transport_trans_avg_sum_1m_to_3m, 
    transaction_transport_trans_avg_cnt_1m / NULLIF (transaction_transport_trans_avg_cnt_3m, 0) AS transaction_transport_trans_avg_cnt_1m_to_3m, 
    transaction_transport_trans_avg_sum_3m / NULLIF (transaction_transport_trans_avg_sum_6m, 0) AS transaction_transport_trans_avg_sum_3m_to_6m, 
    transaction_transport_trans_avg_cnt_3m / NULLIF (transaction_transport_trans_avg_cnt_6m, 0) AS transaction_transport_trans_avg_cnt_3m_to_6m, 
    transaction_transport_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_transport_trans_avg_sum_1m_to_total_1m,
    transaction_transport_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_transport_trans_avg_cnt_1m_to_total_1m,
    transaction_transport_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_transport_trans_avg_sum_3m_to_total_3m, 
    transaction_transport_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_transport_trans_avg_cnt_3m_to_total_3m, 
    transaction_transport_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_transport_trans_avg_sum_3m_to_total_6m, 
    transaction_transport_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_transport_trans_avg_cnt_3m_to_total_6m, 
    transaction_transport_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_transport_trans_avg_sum_6m_to_total_6m, 
    transaction_transport_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_transport_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_4 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_52 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_travel_trans_cnt_1m / NULLIF (transaction_travel_trans_cnt_3m, 0) AS transaction_travel_trans_cnt_1m_to_3m,
    transaction_travel_trans_sum_1m / NULLIF (transaction_travel_trans_sum_3m, 0) AS transaction_travel_trans_sum_1m_to_3m,
    transaction_travel_trans_cnt_3m / NULLIF (transaction_travel_trans_cnt_6m, 0) AS transaction_travel_trans_cnt_3m_to_6m,
    transaction_travel_trans_sum_3m / NULLIF (transaction_travel_trans_sum_6m, 0) AS transaction_travel_trans_sum_3m_to_6m,
    transaction_travel_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_travel_trans_cnt_1m_to_total_1m, 
    transaction_travel_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_travel_trans_sum_1m_to_total_1m, 
    transaction_travel_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_travel_trans_cnt_3m_to_total_3m, 
    transaction_travel_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_travel_trans_sum_3m_to_total_3m,
    transaction_travel_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_travel_trans_cnt_3m_to_total_6m, 
    transaction_travel_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_travel_trans_sum_3m_to_total_6m, 
    transaction_travel_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_travel_trans_cnt_6m_to_total_6m, 
    transaction_travel_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_travel_trans_sum_6m_to_total_6m, 
    transaction_travel_trans_avg_sum_1m / NULLIF (transaction_travel_trans_avg_sum_3m, 0) AS transaction_travel_trans_avg_sum_1m_to_3m, 
    transaction_travel_trans_avg_cnt_1m / NULLIF (transaction_travel_trans_avg_cnt_3m, 0) AS transaction_travel_trans_avg_cnt_1m_to_3m, 
    transaction_travel_trans_avg_sum_3m / NULLIF (transaction_travel_trans_avg_sum_6m, 0) AS transaction_travel_trans_avg_sum_3m_to_6m, 
    transaction_travel_trans_avg_cnt_3m / NULLIF (transaction_travel_trans_avg_cnt_6m, 0) AS transaction_travel_trans_avg_cnt_3m_to_6m, 
    transaction_travel_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_travel_trans_avg_sum_1m_to_total_1m,
    transaction_travel_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_travel_trans_avg_cnt_1m_to_total_1m,
    transaction_travel_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_travel_trans_avg_sum_3m_to_total_3m, 
    transaction_travel_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_travel_trans_avg_cnt_3m_to_total_3m, 
    transaction_travel_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_travel_trans_avg_sum_3m_to_total_6m, 
    transaction_travel_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_travel_trans_avg_cnt_3m_to_total_6m, 
    transaction_travel_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_travel_trans_avg_sum_6m_to_total_6m, 
    transaction_travel_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_travel_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_5 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_53 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_medicine_trans_cnt_1m / NULLIF (transaction_medicine_trans_cnt_3m, 0) AS transaction_medicine_trans_cnt_1m_to_3m,
    transaction_medicine_trans_sum_1m / NULLIF (transaction_medicine_trans_sum_3m, 0) AS transaction_medicine_trans_sum_1m_to_3m,
    transaction_medicine_trans_cnt_3m / NULLIF (transaction_medicine_trans_cnt_6m, 0) AS transaction_medicine_trans_cnt_3m_to_6m,
    transaction_medicine_trans_sum_3m / NULLIF (transaction_medicine_trans_sum_6m, 0) AS transaction_medicine_trans_sum_3m_to_6m,
    transaction_medicine_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_medicine_trans_cnt_1m_to_total_1m, 
    transaction_medicine_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_medicine_trans_sum_1m_to_total_1m, 
    transaction_medicine_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_medicine_trans_cnt_3m_to_total_3m, 
    transaction_medicine_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_medicine_trans_sum_3m_to_total_3m,
    transaction_medicine_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_medicine_trans_cnt_3m_to_total_6m, 
    transaction_medicine_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_medicine_trans_sum_3m_to_total_6m, 
    transaction_medicine_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_medicine_trans_cnt_6m_to_total_6m, 
    transaction_medicine_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_medicine_trans_sum_6m_to_total_6m, 
    transaction_medicine_trans_avg_sum_1m / NULLIF (transaction_medicine_trans_avg_sum_3m, 0) AS transaction_medicine_trans_avg_sum_1m_to_3m, 
    transaction_medicine_trans_avg_cnt_1m / NULLIF (transaction_medicine_trans_avg_cnt_3m, 0) AS transaction_medicine_trans_avg_cnt_1m_to_3m, 
    transaction_medicine_trans_avg_sum_3m / NULLIF (transaction_medicine_trans_avg_sum_6m, 0) AS transaction_medicine_trans_avg_sum_3m_to_6m, 
    transaction_medicine_trans_avg_cnt_3m / NULLIF (transaction_medicine_trans_avg_cnt_6m, 0) AS transaction_medicine_trans_avg_cnt_3m_to_6m, 
    transaction_medicine_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_medicine_trans_avg_sum_1m_to_total_1m,
    transaction_medicine_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_medicine_trans_avg_cnt_1m_to_total_1m,
    transaction_medicine_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_medicine_trans_avg_sum_3m_to_total_3m, 
    transaction_medicine_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_medicine_trans_avg_cnt_3m_to_total_3m, 
    transaction_medicine_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_medicine_trans_avg_sum_3m_to_total_6m, 
    transaction_medicine_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_medicine_trans_avg_cnt_3m_to_total_6m, 
    transaction_medicine_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_medicine_trans_avg_sum_6m_to_total_6m, 
    transaction_medicine_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_medicine_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_6 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_54 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_online_shops_trans_cnt_1m / NULLIF (transaction_online_shops_trans_cnt_3m, 0) AS transaction_online_shops_trans_cnt_1m_to_3m,
    transaction_online_shops_trans_sum_1m / NULLIF (transaction_online_shops_trans_sum_3m, 0) AS transaction_online_shops_trans_sum_1m_to_3m,
    transaction_online_shops_trans_cnt_3m / NULLIF (transaction_online_shops_trans_cnt_6m, 0) AS transaction_online_shops_trans_cnt_3m_to_6m,
    transaction_online_shops_trans_sum_3m / NULLIF (transaction_online_shops_trans_sum_6m, 0) AS transaction_online_shops_trans_sum_3m_to_6m,
    transaction_online_shops_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_online_shops_trans_cnt_1m_to_total_1m, 
    transaction_online_shops_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_online_shops_trans_sum_1m_to_total_1m, 
    transaction_online_shops_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_online_shops_trans_cnt_3m_to_total_3m, 
    transaction_online_shops_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_online_shops_trans_sum_3m_to_total_3m,
    transaction_online_shops_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_online_shops_trans_cnt_3m_to_total_6m, 
    transaction_online_shops_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_online_shops_trans_sum_3m_to_total_6m, 
    transaction_online_shops_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_online_shops_trans_cnt_6m_to_total_6m, 
    transaction_online_shops_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_online_shops_trans_sum_6m_to_total_6m, 
    transaction_online_shops_trans_avg_sum_1m / NULLIF (transaction_online_shops_trans_avg_sum_3m, 0) AS transaction_online_shops_trans_avg_sum_1m_to_3m, 
    transaction_online_shops_trans_avg_cnt_1m / NULLIF (transaction_online_shops_trans_avg_cnt_3m, 0) AS transaction_online_shops_trans_avg_cnt_1m_to_3m, 
    transaction_online_shops_trans_avg_sum_3m / NULLIF (transaction_online_shops_trans_avg_sum_6m, 0) AS transaction_online_shops_trans_avg_sum_3m_to_6m, 
    transaction_online_shops_trans_avg_cnt_3m / NULLIF (transaction_online_shops_trans_avg_cnt_6m, 0) AS transaction_online_shops_trans_avg_cnt_3m_to_6m, 
    transaction_online_shops_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_online_shops_trans_avg_sum_1m_to_total_1m,
    transaction_online_shops_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_online_shops_trans_avg_cnt_1m_to_total_1m,
    transaction_online_shops_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_online_shops_trans_avg_sum_3m_to_total_3m, 
    transaction_online_shops_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_online_shops_trans_avg_cnt_3m_to_total_3m, 
    transaction_online_shops_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_online_shops_trans_avg_sum_3m_to_total_6m, 
    transaction_online_shops_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_online_shops_trans_avg_cnt_3m_to_total_6m, 
    transaction_online_shops_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_online_shops_trans_avg_sum_6m_to_total_6m, 
    transaction_online_shops_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_online_shops_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_7 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_55 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_music_trans_cnt_1m / NULLIF (transaction_music_trans_cnt_3m, 0) AS transaction_music_trans_cnt_1m_to_3m,
    transaction_music_trans_sum_1m / NULLIF (transaction_music_trans_sum_3m, 0) AS transaction_music_trans_sum_1m_to_3m,
    transaction_music_trans_cnt_3m / NULLIF (transaction_music_trans_cnt_6m, 0) AS transaction_music_trans_cnt_3m_to_6m,
    transaction_music_trans_sum_3m / NULLIF (transaction_music_trans_sum_6m, 0) AS transaction_music_trans_sum_3m_to_6m,
    transaction_music_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_music_trans_cnt_1m_to_total_1m, 
    transaction_music_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_music_trans_sum_1m_to_total_1m, 
    transaction_music_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_music_trans_cnt_3m_to_total_3m, 
    transaction_music_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_music_trans_sum_3m_to_total_3m,
    transaction_music_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_music_trans_cnt_3m_to_total_6m, 
    transaction_music_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_music_trans_sum_3m_to_total_6m, 
    transaction_music_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_music_trans_cnt_6m_to_total_6m, 
    transaction_music_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_music_trans_sum_6m_to_total_6m, 
    transaction_music_trans_avg_sum_1m / NULLIF (transaction_music_trans_avg_sum_3m, 0) AS transaction_music_trans_avg_sum_1m_to_3m, 
    transaction_music_trans_avg_cnt_1m / NULLIF (transaction_music_trans_avg_cnt_3m, 0) AS transaction_music_trans_avg_cnt_1m_to_3m, 
    transaction_music_trans_avg_sum_3m / NULLIF (transaction_music_trans_avg_sum_6m, 0) AS transaction_music_trans_avg_sum_3m_to_6m, 
    transaction_music_trans_avg_cnt_3m / NULLIF (transaction_music_trans_avg_cnt_6m, 0) AS transaction_music_trans_avg_cnt_3m_to_6m, 
    transaction_music_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_music_trans_avg_sum_1m_to_total_1m,
    transaction_music_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_music_trans_avg_cnt_1m_to_total_1m,
    transaction_music_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_music_trans_avg_sum_3m_to_total_3m, 
    transaction_music_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_music_trans_avg_cnt_3m_to_total_3m, 
    transaction_music_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_music_trans_avg_sum_3m_to_total_6m, 
    transaction_music_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_music_trans_avg_cnt_3m_to_total_6m, 
    transaction_music_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_music_trans_avg_sum_6m_to_total_6m, 
    transaction_music_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_music_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_8 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_56 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_lombards_trans_cnt_1m / NULLIF (transaction_lombards_trans_cnt_3m, 0) AS transaction_lombards_trans_cnt_1m_to_3m,
    transaction_lombards_trans_sum_1m / NULLIF (transaction_lombards_trans_sum_3m, 0) AS transaction_lombards_trans_sum_1m_to_3m,
    transaction_lombards_trans_cnt_3m / NULLIF (transaction_lombards_trans_cnt_6m, 0) AS transaction_lombards_trans_cnt_3m_to_6m,
    transaction_lombards_trans_sum_3m / NULLIF (transaction_lombards_trans_sum_6m, 0) AS transaction_lombards_trans_sum_3m_to_6m,
    transaction_lombards_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_lombards_trans_cnt_1m_to_total_1m, 
    transaction_lombards_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_lombards_trans_sum_1m_to_total_1m, 
    transaction_lombards_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_lombards_trans_cnt_3m_to_total_3m, 
    transaction_lombards_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_lombards_trans_sum_3m_to_total_3m,
    transaction_lombards_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_lombards_trans_cnt_3m_to_total_6m, 
    transaction_lombards_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_lombards_trans_sum_3m_to_total_6m, 
    transaction_lombards_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_lombards_trans_cnt_6m_to_total_6m, 
    transaction_lombards_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_lombards_trans_sum_6m_to_total_6m, 
    transaction_lombards_trans_avg_sum_1m / NULLIF (transaction_lombards_trans_avg_sum_3m, 0) AS transaction_lombards_trans_avg_sum_1m_to_3m, 
    transaction_lombards_trans_avg_cnt_1m / NULLIF (transaction_lombards_trans_avg_cnt_3m, 0) AS transaction_lombards_trans_avg_cnt_1m_to_3m, 
    transaction_lombards_trans_avg_sum_3m / NULLIF (transaction_lombards_trans_avg_sum_6m, 0) AS transaction_lombards_trans_avg_sum_3m_to_6m, 
    transaction_lombards_trans_avg_cnt_3m / NULLIF (transaction_lombards_trans_avg_cnt_6m, 0) AS transaction_lombards_trans_avg_cnt_3m_to_6m, 
    transaction_lombards_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_lombards_trans_avg_sum_1m_to_total_1m,
    transaction_lombards_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_lombards_trans_avg_cnt_1m_to_total_1m,
    transaction_lombards_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_lombards_trans_avg_sum_3m_to_total_3m, 
    transaction_lombards_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_lombards_trans_avg_cnt_3m_to_total_3m, 
    transaction_lombards_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_lombards_trans_avg_sum_3m_to_total_6m, 
    transaction_lombards_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_lombards_trans_avg_cnt_3m_to_total_6m, 
    transaction_lombards_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_lombards_trans_avg_sum_6m_to_total_6m, 
    transaction_lombards_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_lombards_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_9 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_57 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_zoo_trans_cnt_1m / NULLIF (transaction_zoo_trans_cnt_3m, 0) AS transaction_zoo_trans_cnt_1m_to_3m,
    transaction_zoo_trans_sum_1m / NULLIF (transaction_zoo_trans_sum_3m, 0) AS transaction_zoo_trans_sum_1m_to_3m,
    transaction_zoo_trans_cnt_3m / NULLIF (transaction_zoo_trans_cnt_6m, 0) AS transaction_zoo_trans_cnt_3m_to_6m,
    transaction_zoo_trans_sum_3m / NULLIF (transaction_zoo_trans_sum_6m, 0) AS transaction_zoo_trans_sum_3m_to_6m,
    transaction_zoo_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_zoo_trans_cnt_1m_to_total_1m, 
    transaction_zoo_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_zoo_trans_sum_1m_to_total_1m, 
    transaction_zoo_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_zoo_trans_cnt_3m_to_total_3m, 
    transaction_zoo_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_zoo_trans_sum_3m_to_total_3m,
    transaction_zoo_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_zoo_trans_cnt_3m_to_total_6m, 
    transaction_zoo_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_zoo_trans_sum_3m_to_total_6m, 
    transaction_zoo_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_zoo_trans_cnt_6m_to_total_6m, 
    transaction_zoo_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_zoo_trans_sum_6m_to_total_6m, 
    transaction_zoo_trans_avg_sum_1m / NULLIF (transaction_zoo_trans_avg_sum_3m, 0) AS transaction_zoo_trans_avg_sum_1m_to_3m, 
    transaction_zoo_trans_avg_cnt_1m / NULLIF (transaction_zoo_trans_avg_cnt_3m, 0) AS transaction_zoo_trans_avg_cnt_1m_to_3m, 
    transaction_zoo_trans_avg_sum_3m / NULLIF (transaction_zoo_trans_avg_sum_6m, 0) AS transaction_zoo_trans_avg_sum_3m_to_6m, 
    transaction_zoo_trans_avg_cnt_3m / NULLIF (transaction_zoo_trans_avg_cnt_6m, 0) AS transaction_zoo_trans_avg_cnt_3m_to_6m, 
    transaction_zoo_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_zoo_trans_avg_sum_1m_to_total_1m,
    transaction_zoo_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_zoo_trans_avg_cnt_1m_to_total_1m,
    transaction_zoo_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_zoo_trans_avg_sum_3m_to_total_3m, 
    transaction_zoo_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_zoo_trans_avg_cnt_3m_to_total_3m, 
    transaction_zoo_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_zoo_trans_avg_sum_3m_to_total_6m, 
    transaction_zoo_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_zoo_trans_avg_cnt_3m_to_total_6m, 
    transaction_zoo_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_zoo_trans_avg_sum_6m_to_total_6m, 
    transaction_zoo_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_zoo_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_10 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_58 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_air_tickets_trans_cnt_1m / NULLIF (transaction_air_tickets_trans_cnt_3m, 0) AS transaction_air_tickets_trans_cnt_1m_to_3m,
    transaction_air_tickets_trans_sum_1m / NULLIF (transaction_air_tickets_trans_sum_3m, 0) AS transaction_air_tickets_trans_sum_1m_to_3m,
    transaction_air_tickets_trans_cnt_3m / NULLIF (transaction_air_tickets_trans_cnt_6m, 0) AS transaction_air_tickets_trans_cnt_3m_to_6m,
    transaction_air_tickets_trans_sum_3m / NULLIF (transaction_air_tickets_trans_sum_6m, 0) AS transaction_air_tickets_trans_sum_3m_to_6m,
    transaction_air_tickets_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_air_tickets_trans_cnt_1m_to_total_1m, 
    transaction_air_tickets_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_air_tickets_trans_sum_1m_to_total_1m, 
    transaction_air_tickets_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_air_tickets_trans_cnt_3m_to_total_3m, 
    transaction_air_tickets_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_air_tickets_trans_sum_3m_to_total_3m,
    transaction_air_tickets_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_air_tickets_trans_cnt_3m_to_total_6m, 
    transaction_air_tickets_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_air_tickets_trans_sum_3m_to_total_6m, 
    transaction_air_tickets_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_air_tickets_trans_cnt_6m_to_total_6m, 
    transaction_air_tickets_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_air_tickets_trans_sum_6m_to_total_6m, 
    transaction_air_tickets_trans_avg_sum_1m / NULLIF (transaction_air_tickets_trans_avg_sum_3m, 0) AS transaction_air_tickets_trans_avg_sum_1m_to_3m, 
    transaction_air_tickets_trans_avg_cnt_1m / NULLIF (transaction_air_tickets_trans_avg_cnt_3m, 0) AS transaction_air_tickets_trans_avg_cnt_1m_to_3m, 
    transaction_air_tickets_trans_avg_sum_3m / NULLIF (transaction_air_tickets_trans_avg_sum_6m, 0) AS transaction_air_tickets_trans_avg_sum_3m_to_6m, 
    transaction_air_tickets_trans_avg_cnt_3m / NULLIF (transaction_air_tickets_trans_avg_cnt_6m, 0) AS transaction_air_tickets_trans_avg_cnt_3m_to_6m, 
    transaction_air_tickets_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_air_tickets_trans_avg_sum_1m_to_total_1m,
    transaction_air_tickets_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_air_tickets_trans_avg_cnt_1m_to_total_1m,
    transaction_air_tickets_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_air_tickets_trans_avg_sum_3m_to_total_3m, 
    transaction_air_tickets_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_air_tickets_trans_avg_cnt_3m_to_total_3m, 
    transaction_air_tickets_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_air_tickets_trans_avg_sum_3m_to_total_6m, 
    transaction_air_tickets_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_air_tickets_trans_avg_cnt_3m_to_total_6m, 
    transaction_air_tickets_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_air_tickets_trans_avg_sum_6m_to_total_6m, 
    transaction_air_tickets_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_air_tickets_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_11 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_59 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_hotels_trans_cnt_1m / NULLIF (transaction_hotels_trans_cnt_3m, 0) AS transaction_hotels_trans_cnt_1m_to_3m,
    transaction_hotels_trans_sum_1m / NULLIF (transaction_hotels_trans_sum_3m, 0) AS transaction_hotels_trans_sum_1m_to_3m,
    transaction_hotels_trans_cnt_3m / NULLIF (transaction_hotels_trans_cnt_6m, 0) AS transaction_hotels_trans_cnt_3m_to_6m,
    transaction_hotels_trans_sum_3m / NULLIF (transaction_hotels_trans_sum_6m, 0) AS transaction_hotels_trans_sum_3m_to_6m,
    transaction_hotels_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_hotels_trans_cnt_1m_to_total_1m, 
    transaction_hotels_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_hotels_trans_sum_1m_to_total_1m, 
    transaction_hotels_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_hotels_trans_cnt_3m_to_total_3m, 
    transaction_hotels_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_hotels_trans_sum_3m_to_total_3m,
    transaction_hotels_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_hotels_trans_cnt_3m_to_total_6m, 
    transaction_hotels_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_hotels_trans_sum_3m_to_total_6m, 
    transaction_hotels_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_hotels_trans_cnt_6m_to_total_6m, 
    transaction_hotels_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_hotels_trans_sum_6m_to_total_6m, 
    transaction_hotels_trans_avg_sum_1m / NULLIF (transaction_hotels_trans_avg_sum_3m, 0) AS transaction_hotels_trans_avg_sum_1m_to_3m, 
    transaction_hotels_trans_avg_cnt_1m / NULLIF (transaction_hotels_trans_avg_cnt_3m, 0) AS transaction_hotels_trans_avg_cnt_1m_to_3m, 
    transaction_hotels_trans_avg_sum_3m / NULLIF (transaction_hotels_trans_avg_sum_6m, 0) AS transaction_hotels_trans_avg_sum_3m_to_6m, 
    transaction_hotels_trans_avg_cnt_3m / NULLIF (transaction_hotels_trans_avg_cnt_6m, 0) AS transaction_hotels_trans_avg_cnt_3m_to_6m, 
    transaction_hotels_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_hotels_trans_avg_sum_1m_to_total_1m,
    transaction_hotels_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_hotels_trans_avg_cnt_1m_to_total_1m,
    transaction_hotels_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_hotels_trans_avg_sum_3m_to_total_3m, 
    transaction_hotels_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_hotels_trans_avg_cnt_3m_to_total_3m, 
    transaction_hotels_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_hotels_trans_avg_sum_3m_to_total_6m, 
    transaction_hotels_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_hotels_trans_avg_cnt_3m_to_total_6m, 
    transaction_hotels_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_hotels_trans_avg_sum_6m_to_total_6m, 
    transaction_hotels_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_hotels_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_12 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_60 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_courier_trans_cnt_1m / NULLIF (transaction_courier_trans_cnt_3m, 0) AS transaction_courier_trans_cnt_1m_to_3m,
    transaction_courier_trans_sum_1m / NULLIF (transaction_courier_trans_sum_3m, 0) AS transaction_courier_trans_sum_1m_to_3m,
    transaction_courier_trans_cnt_3m / NULLIF (transaction_courier_trans_cnt_6m, 0) AS transaction_courier_trans_cnt_3m_to_6m,
    transaction_courier_trans_sum_3m / NULLIF (transaction_courier_trans_sum_6m, 0) AS transaction_courier_trans_sum_3m_to_6m,
    transaction_courier_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_courier_trans_cnt_1m_to_total_1m, 
    transaction_courier_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_courier_trans_sum_1m_to_total_1m, 
    transaction_courier_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_courier_trans_cnt_3m_to_total_3m, 
    transaction_courier_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_courier_trans_sum_3m_to_total_3m,
    transaction_courier_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_courier_trans_cnt_3m_to_total_6m, 
    transaction_courier_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_courier_trans_sum_3m_to_total_6m, 
    transaction_courier_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_courier_trans_cnt_6m_to_total_6m, 
    transaction_courier_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_courier_trans_sum_6m_to_total_6m, 
    transaction_courier_trans_avg_sum_1m / NULLIF (transaction_courier_trans_avg_sum_3m, 0) AS transaction_courier_trans_avg_sum_1m_to_3m, 
    transaction_courier_trans_avg_cnt_1m / NULLIF (transaction_courier_trans_avg_cnt_3m, 0) AS transaction_courier_trans_avg_cnt_1m_to_3m, 
    transaction_courier_trans_avg_sum_3m / NULLIF (transaction_courier_trans_avg_sum_6m, 0) AS transaction_courier_trans_avg_sum_3m_to_6m, 
    transaction_courier_trans_avg_cnt_3m / NULLIF (transaction_courier_trans_avg_cnt_6m, 0) AS transaction_courier_trans_avg_cnt_3m_to_6m, 
    transaction_courier_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_courier_trans_avg_sum_1m_to_total_1m,
    transaction_courier_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_courier_trans_avg_cnt_1m_to_total_1m,
    transaction_courier_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_courier_trans_avg_sum_3m_to_total_3m, 
    transaction_courier_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_courier_trans_avg_cnt_3m_to_total_3m, 
    transaction_courier_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_courier_trans_avg_sum_3m_to_total_6m, 
    transaction_courier_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_courier_trans_avg_cnt_3m_to_total_6m, 
    transaction_courier_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_courier_trans_avg_sum_6m_to_total_6m, 
    transaction_courier_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_courier_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_13 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_61 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_souvenirs_trans_cnt_1m / NULLIF (transaction_souvenirs_trans_cnt_3m, 0) AS transaction_souvenirs_trans_cnt_1m_to_3m,
    transaction_souvenirs_trans_sum_1m / NULLIF (transaction_souvenirs_trans_sum_3m, 0) AS transaction_souvenirs_trans_sum_1m_to_3m,
    transaction_souvenirs_trans_cnt_3m / NULLIF (transaction_souvenirs_trans_cnt_6m, 0) AS transaction_souvenirs_trans_cnt_3m_to_6m,
    transaction_souvenirs_trans_sum_3m / NULLIF (transaction_souvenirs_trans_sum_6m, 0) AS transaction_souvenirs_trans_sum_3m_to_6m,
    transaction_souvenirs_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_souvenirs_trans_cnt_1m_to_total_1m, 
    transaction_souvenirs_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_souvenirs_trans_sum_1m_to_total_1m, 
    transaction_souvenirs_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_souvenirs_trans_cnt_3m_to_total_3m, 
    transaction_souvenirs_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_souvenirs_trans_sum_3m_to_total_3m,
    transaction_souvenirs_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_souvenirs_trans_cnt_3m_to_total_6m, 
    transaction_souvenirs_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_souvenirs_trans_sum_3m_to_total_6m, 
    transaction_souvenirs_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_souvenirs_trans_cnt_6m_to_total_6m, 
    transaction_souvenirs_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_souvenirs_trans_sum_6m_to_total_6m, 
    transaction_souvenirs_trans_avg_sum_1m / NULLIF (transaction_souvenirs_trans_avg_sum_3m, 0) AS transaction_souvenirs_trans_avg_sum_1m_to_3m, 
    transaction_souvenirs_trans_avg_cnt_1m / NULLIF (transaction_souvenirs_trans_avg_cnt_3m, 0) AS transaction_souvenirs_trans_avg_cnt_1m_to_3m, 
    transaction_souvenirs_trans_avg_sum_3m / NULLIF (transaction_souvenirs_trans_avg_sum_6m, 0) AS transaction_souvenirs_trans_avg_sum_3m_to_6m, 
    transaction_souvenirs_trans_avg_cnt_3m / NULLIF (transaction_souvenirs_trans_avg_cnt_6m, 0) AS transaction_souvenirs_trans_avg_cnt_3m_to_6m, 
    transaction_souvenirs_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_souvenirs_trans_avg_sum_1m_to_total_1m,
    transaction_souvenirs_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_souvenirs_trans_avg_cnt_1m_to_total_1m,
    transaction_souvenirs_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_souvenirs_trans_avg_sum_3m_to_total_3m, 
    transaction_souvenirs_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_souvenirs_trans_avg_cnt_3m_to_total_3m, 
    transaction_souvenirs_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_souvenirs_trans_avg_sum_3m_to_total_6m, 
    transaction_souvenirs_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_souvenirs_trans_avg_cnt_3m_to_total_6m, 
    transaction_souvenirs_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_souvenirs_trans_avg_sum_6m_to_total_6m, 
    transaction_souvenirs_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_souvenirs_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_14 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_62 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_card_transfer_trans_cnt_1m / NULLIF (transaction_card_transfer_trans_cnt_3m, 0) AS transaction_card_transfer_trans_cnt_1m_to_3m,
    transaction_card_transfer_trans_sum_1m / NULLIF (transaction_card_transfer_trans_sum_3m, 0) AS transaction_card_transfer_trans_sum_1m_to_3m,
    transaction_card_transfer_trans_cnt_3m / NULLIF (transaction_card_transfer_trans_cnt_6m, 0) AS transaction_card_transfer_trans_cnt_3m_to_6m,
    transaction_card_transfer_trans_sum_3m / NULLIF (transaction_card_transfer_trans_sum_6m, 0) AS transaction_card_transfer_trans_sum_3m_to_6m,
    transaction_card_transfer_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_card_transfer_trans_cnt_1m_to_total_1m, 
    transaction_card_transfer_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_card_transfer_trans_sum_1m_to_total_1m, 
    transaction_card_transfer_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_card_transfer_trans_cnt_3m_to_total_3m, 
    transaction_card_transfer_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_card_transfer_trans_sum_3m_to_total_3m,
    transaction_card_transfer_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_card_transfer_trans_cnt_3m_to_total_6m, 
    transaction_card_transfer_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_card_transfer_trans_sum_3m_to_total_6m, 
    transaction_card_transfer_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_card_transfer_trans_cnt_6m_to_total_6m, 
    transaction_card_transfer_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_card_transfer_trans_sum_6m_to_total_6m, 
    transaction_card_transfer_trans_avg_sum_1m / NULLIF (transaction_card_transfer_trans_avg_sum_3m, 0) AS transaction_card_transfer_trans_avg_sum_1m_to_3m, 
    transaction_card_transfer_trans_avg_cnt_1m / NULLIF (transaction_card_transfer_trans_avg_cnt_3m, 0) AS transaction_card_transfer_trans_avg_cnt_1m_to_3m, 
    transaction_card_transfer_trans_avg_sum_3m / NULLIF (transaction_card_transfer_trans_avg_sum_6m, 0) AS transaction_card_transfer_trans_avg_sum_3m_to_6m, 
    transaction_card_transfer_trans_avg_cnt_3m / NULLIF (transaction_card_transfer_trans_avg_cnt_6m, 0) AS transaction_card_transfer_trans_avg_cnt_3m_to_6m, 
    transaction_card_transfer_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_card_transfer_trans_avg_sum_1m_to_total_1m,
    transaction_card_transfer_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_card_transfer_trans_avg_cnt_1m_to_total_1m,
    transaction_card_transfer_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_card_transfer_trans_avg_sum_3m_to_total_3m, 
    transaction_card_transfer_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_card_transfer_trans_avg_cnt_3m_to_total_3m, 
    transaction_card_transfer_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_card_transfer_trans_avg_sum_3m_to_total_6m, 
    transaction_card_transfer_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_card_transfer_trans_avg_cnt_3m_to_total_6m, 
    transaction_card_transfer_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_card_transfer_trans_avg_sum_6m_to_total_6m, 
    transaction_card_transfer_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_card_transfer_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_15 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_63 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_fun_trans_cnt_1m / NULLIF (transaction_fun_trans_cnt_3m, 0) AS transaction_fun_trans_cnt_1m_to_3m,
    transaction_fun_trans_sum_1m / NULLIF (transaction_fun_trans_sum_3m, 0) AS transaction_fun_trans_sum_1m_to_3m,
    transaction_fun_trans_cnt_3m / NULLIF (transaction_fun_trans_cnt_6m, 0) AS transaction_fun_trans_cnt_3m_to_6m,
    transaction_fun_trans_sum_3m / NULLIF (transaction_fun_trans_sum_6m, 0) AS transaction_fun_trans_sum_3m_to_6m,
    transaction_fun_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_fun_trans_cnt_1m_to_total_1m, 
    transaction_fun_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_fun_trans_sum_1m_to_total_1m, 
    transaction_fun_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_fun_trans_cnt_3m_to_total_3m, 
    transaction_fun_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_fun_trans_sum_3m_to_total_3m,
    transaction_fun_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_fun_trans_cnt_3m_to_total_6m, 
    transaction_fun_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_fun_trans_sum_3m_to_total_6m, 
    transaction_fun_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_fun_trans_cnt_6m_to_total_6m, 
    transaction_fun_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_fun_trans_sum_6m_to_total_6m, 
    transaction_fun_trans_avg_sum_1m / NULLIF (transaction_fun_trans_avg_sum_3m, 0) AS transaction_fun_trans_avg_sum_1m_to_3m, 
    transaction_fun_trans_avg_cnt_1m / NULLIF (transaction_fun_trans_avg_cnt_3m, 0) AS transaction_fun_trans_avg_cnt_1m_to_3m, 
    transaction_fun_trans_avg_sum_3m / NULLIF (transaction_fun_trans_avg_sum_6m, 0) AS transaction_fun_trans_avg_sum_3m_to_6m, 
    transaction_fun_trans_avg_cnt_3m / NULLIF (transaction_fun_trans_avg_cnt_6m, 0) AS transaction_fun_trans_avg_cnt_3m_to_6m, 
    transaction_fun_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_fun_trans_avg_sum_1m_to_total_1m,
    transaction_fun_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_fun_trans_avg_cnt_1m_to_total_1m,
    transaction_fun_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_fun_trans_avg_sum_3m_to_total_3m, 
    transaction_fun_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_fun_trans_avg_cnt_3m_to_total_3m, 
    transaction_fun_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_fun_trans_avg_sum_3m_to_total_6m, 
    transaction_fun_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_fun_trans_avg_cnt_3m_to_total_6m, 
    transaction_fun_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_fun_trans_avg_sum_6m_to_total_6m, 
    transaction_fun_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_fun_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_16 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_64 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_taxes_fines_trans_cnt_1m / NULLIF (transaction_taxes_fines_trans_cnt_3m, 0) AS transaction_taxes_fines_trans_cnt_1m_to_3m,
    transaction_taxes_fines_trans_sum_1m / NULLIF (transaction_taxes_fines_trans_sum_3m, 0) AS transaction_taxes_fines_trans_sum_1m_to_3m,
    transaction_taxes_fines_trans_cnt_3m / NULLIF (transaction_taxes_fines_trans_cnt_6m, 0) AS transaction_taxes_fines_trans_cnt_3m_to_6m,
    transaction_taxes_fines_trans_sum_3m / NULLIF (transaction_taxes_fines_trans_sum_6m, 0) AS transaction_taxes_fines_trans_sum_3m_to_6m,
    transaction_taxes_fines_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_taxes_fines_trans_cnt_1m_to_total_1m, 
    transaction_taxes_fines_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_taxes_fines_trans_sum_1m_to_total_1m, 
    transaction_taxes_fines_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_taxes_fines_trans_cnt_3m_to_total_3m, 
    transaction_taxes_fines_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_taxes_fines_trans_sum_3m_to_total_3m,
    transaction_taxes_fines_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_taxes_fines_trans_cnt_3m_to_total_6m, 
    transaction_taxes_fines_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_taxes_fines_trans_sum_3m_to_total_6m, 
    transaction_taxes_fines_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_taxes_fines_trans_cnt_6m_to_total_6m, 
    transaction_taxes_fines_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_taxes_fines_trans_sum_6m_to_total_6m, 
    transaction_taxes_fines_trans_avg_sum_1m / NULLIF (transaction_taxes_fines_trans_avg_sum_3m, 0) AS transaction_taxes_fines_trans_avg_sum_1m_to_3m, 
    transaction_taxes_fines_trans_avg_cnt_1m / NULLIF (transaction_taxes_fines_trans_avg_cnt_3m, 0) AS transaction_taxes_fines_trans_avg_cnt_1m_to_3m, 
    transaction_taxes_fines_trans_avg_sum_3m / NULLIF (transaction_taxes_fines_trans_avg_sum_6m, 0) AS transaction_taxes_fines_trans_avg_sum_3m_to_6m, 
    transaction_taxes_fines_trans_avg_cnt_3m / NULLIF (transaction_taxes_fines_trans_avg_cnt_6m, 0) AS transaction_taxes_fines_trans_avg_cnt_3m_to_6m, 
    transaction_taxes_fines_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_taxes_fines_trans_avg_sum_1m_to_total_1m,
    transaction_taxes_fines_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_taxes_fines_trans_avg_cnt_1m_to_total_1m,
    transaction_taxes_fines_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_taxes_fines_trans_avg_sum_3m_to_total_3m, 
    transaction_taxes_fines_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_taxes_fines_trans_avg_cnt_3m_to_total_3m, 
    transaction_taxes_fines_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_taxes_fines_trans_avg_sum_3m_to_total_6m, 
    transaction_taxes_fines_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_taxes_fines_trans_avg_cnt_3m_to_total_6m, 
    transaction_taxes_fines_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_taxes_fines_trans_avg_sum_6m_to_total_6m, 
    transaction_taxes_fines_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_taxes_fines_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_17 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_65 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_supermarkets_trans_cnt_1m / NULLIF (transaction_supermarkets_trans_cnt_3m, 0) AS transaction_supermarkets_trans_cnt_1m_to_3m,
    transaction_supermarkets_trans_sum_1m / NULLIF (transaction_supermarkets_trans_sum_3m, 0) AS transaction_supermarkets_trans_sum_1m_to_3m,
    transaction_supermarkets_trans_cnt_3m / NULLIF (transaction_supermarkets_trans_cnt_6m, 0) AS transaction_supermarkets_trans_cnt_3m_to_6m,
    transaction_supermarkets_trans_sum_3m / NULLIF (transaction_supermarkets_trans_sum_6m, 0) AS transaction_supermarkets_trans_sum_3m_to_6m,
    transaction_supermarkets_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_supermarkets_trans_cnt_1m_to_total_1m, 
    transaction_supermarkets_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_supermarkets_trans_sum_1m_to_total_1m, 
    transaction_supermarkets_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_supermarkets_trans_cnt_3m_to_total_3m, 
    transaction_supermarkets_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_supermarkets_trans_sum_3m_to_total_3m,
    transaction_supermarkets_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_supermarkets_trans_cnt_3m_to_total_6m, 
    transaction_supermarkets_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_supermarkets_trans_sum_3m_to_total_6m, 
    transaction_supermarkets_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_supermarkets_trans_cnt_6m_to_total_6m, 
    transaction_supermarkets_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_supermarkets_trans_sum_6m_to_total_6m, 
    transaction_supermarkets_trans_avg_sum_1m / NULLIF (transaction_supermarkets_trans_avg_sum_3m, 0) AS transaction_supermarkets_trans_avg_sum_1m_to_3m, 
    transaction_supermarkets_trans_avg_cnt_1m / NULLIF (transaction_supermarkets_trans_avg_cnt_3m, 0) AS transaction_supermarkets_trans_avg_cnt_1m_to_3m, 
    transaction_supermarkets_trans_avg_sum_3m / NULLIF (transaction_supermarkets_trans_avg_sum_6m, 0) AS transaction_supermarkets_trans_avg_sum_3m_to_6m, 
    transaction_supermarkets_trans_avg_cnt_3m / NULLIF (transaction_supermarkets_trans_avg_cnt_6m, 0) AS transaction_supermarkets_trans_avg_cnt_3m_to_6m, 
    transaction_supermarkets_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_supermarkets_trans_avg_sum_1m_to_total_1m,
    transaction_supermarkets_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_supermarkets_trans_avg_cnt_1m_to_total_1m,
    transaction_supermarkets_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_supermarkets_trans_avg_sum_3m_to_total_3m, 
    transaction_supermarkets_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_supermarkets_trans_avg_cnt_3m_to_total_3m, 
    transaction_supermarkets_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_supermarkets_trans_avg_sum_3m_to_total_6m, 
    transaction_supermarkets_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_supermarkets_trans_avg_cnt_3m_to_total_6m, 
    transaction_supermarkets_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_supermarkets_trans_avg_sum_6m_to_total_6m, 
    transaction_supermarkets_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_supermarkets_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_18 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_66 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_sport_trans_cnt_1m / NULLIF (transaction_sport_trans_cnt_3m, 0) AS transaction_sport_trans_cnt_1m_to_3m,
    transaction_sport_trans_sum_1m / NULLIF (transaction_sport_trans_sum_3m, 0) AS transaction_sport_trans_sum_1m_to_3m,
    transaction_sport_trans_cnt_3m / NULLIF (transaction_sport_trans_cnt_6m, 0) AS transaction_sport_trans_cnt_3m_to_6m,
    transaction_sport_trans_sum_3m / NULLIF (transaction_sport_trans_sum_6m, 0) AS transaction_sport_trans_sum_3m_to_6m,
    transaction_sport_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_sport_trans_cnt_1m_to_total_1m, 
    transaction_sport_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_sport_trans_sum_1m_to_total_1m, 
    transaction_sport_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_sport_trans_cnt_3m_to_total_3m, 
    transaction_sport_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_sport_trans_sum_3m_to_total_3m,
    transaction_sport_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_sport_trans_cnt_3m_to_total_6m, 
    transaction_sport_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_sport_trans_sum_3m_to_total_6m, 
    transaction_sport_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_sport_trans_cnt_6m_to_total_6m, 
    transaction_sport_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_sport_trans_sum_6m_to_total_6m, 
    transaction_sport_trans_avg_sum_1m / NULLIF (transaction_sport_trans_avg_sum_3m, 0) AS transaction_sport_trans_avg_sum_1m_to_3m, 
    transaction_sport_trans_avg_cnt_1m / NULLIF (transaction_sport_trans_avg_cnt_3m, 0) AS transaction_sport_trans_avg_cnt_1m_to_3m, 
    transaction_sport_trans_avg_sum_3m / NULLIF (transaction_sport_trans_avg_sum_6m, 0) AS transaction_sport_trans_avg_sum_3m_to_6m, 
    transaction_sport_trans_avg_cnt_3m / NULLIF (transaction_sport_trans_avg_cnt_6m, 0) AS transaction_sport_trans_avg_cnt_3m_to_6m, 
    transaction_sport_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_sport_trans_avg_sum_1m_to_total_1m,
    transaction_sport_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_sport_trans_avg_cnt_1m_to_total_1m,
    transaction_sport_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_sport_trans_avg_sum_3m_to_total_3m, 
    transaction_sport_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_sport_trans_avg_cnt_3m_to_total_3m, 
    transaction_sport_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_sport_trans_avg_sum_3m_to_total_6m, 
    transaction_sport_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_sport_trans_avg_cnt_3m_to_total_6m, 
    transaction_sport_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_sport_trans_avg_sum_6m_to_total_6m, 
    transaction_sport_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_sport_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_19 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_67 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_sber_trans_cnt_1m / NULLIF (transaction_sber_trans_cnt_3m, 0) AS transaction_sber_trans_cnt_1m_to_3m,
    transaction_sber_trans_sum_1m / NULLIF (transaction_sber_trans_sum_3m, 0) AS transaction_sber_trans_sum_1m_to_3m,
    transaction_sber_trans_cnt_3m / NULLIF (transaction_sber_trans_cnt_6m, 0) AS transaction_sber_trans_cnt_3m_to_6m,
    transaction_sber_trans_sum_3m / NULLIF (transaction_sber_trans_sum_6m, 0) AS transaction_sber_trans_sum_3m_to_6m,
    transaction_sber_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_sber_trans_cnt_1m_to_total_1m, 
    transaction_sber_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_sber_trans_sum_1m_to_total_1m, 
    transaction_sber_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_sber_trans_cnt_3m_to_total_3m, 
    transaction_sber_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_sber_trans_sum_3m_to_total_3m,
    transaction_sber_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_sber_trans_cnt_3m_to_total_6m, 
    transaction_sber_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_sber_trans_sum_3m_to_total_6m, 
    transaction_sber_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_sber_trans_cnt_6m_to_total_6m, 
    transaction_sber_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_sber_trans_sum_6m_to_total_6m, 
    transaction_sber_trans_avg_sum_1m / NULLIF (transaction_sber_trans_avg_sum_3m, 0) AS transaction_sber_trans_avg_sum_1m_to_3m, 
    transaction_sber_trans_avg_cnt_1m / NULLIF (transaction_sber_trans_avg_cnt_3m, 0) AS transaction_sber_trans_avg_cnt_1m_to_3m, 
    transaction_sber_trans_avg_sum_3m / NULLIF (transaction_sber_trans_avg_sum_6m, 0) AS transaction_sber_trans_avg_sum_3m_to_6m, 
    transaction_sber_trans_avg_cnt_3m / NULLIF (transaction_sber_trans_avg_cnt_6m, 0) AS transaction_sber_trans_avg_cnt_3m_to_6m, 
    transaction_sber_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_sber_trans_avg_sum_1m_to_total_1m,
    transaction_sber_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_sber_trans_avg_cnt_1m_to_total_1m,
    transaction_sber_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_sber_trans_avg_sum_3m_to_total_3m, 
    transaction_sber_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_sber_trans_avg_cnt_3m_to_total_3m, 
    transaction_sber_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_sber_trans_avg_sum_3m_to_total_6m, 
    transaction_sber_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_sber_trans_avg_cnt_3m_to_total_6m, 
    transaction_sber_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_sber_trans_avg_sum_6m_to_total_6m, 
    transaction_sber_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_sber_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_20 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_68 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_gosuslugi_trans_cnt_1m / NULLIF (transaction_gosuslugi_trans_cnt_3m, 0) AS transaction_gosuslugi_trans_cnt_1m_to_3m,
    transaction_gosuslugi_trans_sum_1m / NULLIF (transaction_gosuslugi_trans_sum_3m, 0) AS transaction_gosuslugi_trans_sum_1m_to_3m,
    transaction_gosuslugi_trans_cnt_3m / NULLIF (transaction_gosuslugi_trans_cnt_6m, 0) AS transaction_gosuslugi_trans_cnt_3m_to_6m,
    transaction_gosuslugi_trans_sum_3m / NULLIF (transaction_gosuslugi_trans_sum_6m, 0) AS transaction_gosuslugi_trans_sum_3m_to_6m,
    transaction_gosuslugi_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_gosuslugi_trans_cnt_1m_to_total_1m, 
    transaction_gosuslugi_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_gosuslugi_trans_sum_1m_to_total_1m, 
    transaction_gosuslugi_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_gosuslugi_trans_cnt_3m_to_total_3m, 
    transaction_gosuslugi_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_gosuslugi_trans_sum_3m_to_total_3m,
    transaction_gosuslugi_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_gosuslugi_trans_cnt_3m_to_total_6m, 
    transaction_gosuslugi_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_gosuslugi_trans_sum_3m_to_total_6m, 
    transaction_gosuslugi_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_gosuslugi_trans_cnt_6m_to_total_6m, 
    transaction_gosuslugi_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_gosuslugi_trans_sum_6m_to_total_6m, 
    transaction_gosuslugi_trans_avg_sum_1m / NULLIF (transaction_gosuslugi_trans_avg_sum_3m, 0) AS transaction_gosuslugi_trans_avg_sum_1m_to_3m, 
    transaction_gosuslugi_trans_avg_cnt_1m / NULLIF (transaction_gosuslugi_trans_avg_cnt_3m, 0) AS transaction_gosuslugi_trans_avg_cnt_1m_to_3m, 
    transaction_gosuslugi_trans_avg_sum_3m / NULLIF (transaction_gosuslugi_trans_avg_sum_6m, 0) AS transaction_gosuslugi_trans_avg_sum_3m_to_6m, 
    transaction_gosuslugi_trans_avg_cnt_3m / NULLIF (transaction_gosuslugi_trans_avg_cnt_6m, 0) AS transaction_gosuslugi_trans_avg_cnt_3m_to_6m, 
    transaction_gosuslugi_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_gosuslugi_trans_avg_sum_1m_to_total_1m,
    transaction_gosuslugi_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_gosuslugi_trans_avg_cnt_1m_to_total_1m,
    transaction_gosuslugi_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_gosuslugi_trans_avg_sum_3m_to_total_3m, 
    transaction_gosuslugi_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_gosuslugi_trans_avg_cnt_3m_to_total_3m, 
    transaction_gosuslugi_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_gosuslugi_trans_avg_sum_3m_to_total_6m, 
    transaction_gosuslugi_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_gosuslugi_trans_avg_cnt_3m_to_total_6m, 
    transaction_gosuslugi_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_gosuslugi_trans_avg_sum_6m_to_total_6m, 
    transaction_gosuslugi_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_gosuslugi_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_21 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_69 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_art_trans_cnt_1m / NULLIF (transaction_art_trans_cnt_3m, 0) AS transaction_art_trans_cnt_1m_to_3m,
    transaction_art_trans_sum_1m / NULLIF (transaction_art_trans_sum_3m, 0) AS transaction_art_trans_sum_1m_to_3m,
    transaction_art_trans_cnt_3m / NULLIF (transaction_art_trans_cnt_6m, 0) AS transaction_art_trans_cnt_3m_to_6m,
    transaction_art_trans_sum_3m / NULLIF (transaction_art_trans_sum_6m, 0) AS transaction_art_trans_sum_3m_to_6m,
    transaction_art_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_art_trans_cnt_1m_to_total_1m, 
    transaction_art_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_art_trans_sum_1m_to_total_1m, 
    transaction_art_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_art_trans_cnt_3m_to_total_3m, 
    transaction_art_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_art_trans_sum_3m_to_total_3m,
    transaction_art_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_art_trans_cnt_3m_to_total_6m, 
    transaction_art_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_art_trans_sum_3m_to_total_6m, 
    transaction_art_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_art_trans_cnt_6m_to_total_6m, 
    transaction_art_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_art_trans_sum_6m_to_total_6m, 
    transaction_art_trans_avg_sum_1m / NULLIF (transaction_art_trans_avg_sum_3m, 0) AS transaction_art_trans_avg_sum_1m_to_3m, 
    transaction_art_trans_avg_cnt_1m / NULLIF (transaction_art_trans_avg_cnt_3m, 0) AS transaction_art_trans_avg_cnt_1m_to_3m, 
    transaction_art_trans_avg_sum_3m / NULLIF (transaction_art_trans_avg_sum_6m, 0) AS transaction_art_trans_avg_sum_3m_to_6m, 
    transaction_art_trans_avg_cnt_3m / NULLIF (transaction_art_trans_avg_cnt_6m, 0) AS transaction_art_trans_avg_cnt_3m_to_6m, 
    transaction_art_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_art_trans_avg_sum_1m_to_total_1m,
    transaction_art_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_art_trans_avg_cnt_1m_to_total_1m,
    transaction_art_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_art_trans_avg_sum_3m_to_total_3m, 
    transaction_art_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_art_trans_avg_cnt_3m_to_total_3m, 
    transaction_art_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_art_trans_avg_sum_3m_to_total_6m, 
    transaction_art_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_art_trans_avg_cnt_3m_to_total_6m, 
    transaction_art_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_art_trans_avg_sum_6m_to_total_6m, 
    transaction_art_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_art_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_22 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_70 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_pharmacies_trans_cnt_1m / NULLIF (transaction_pharmacies_trans_cnt_3m, 0) AS transaction_pharmacies_trans_cnt_1m_to_3m,
    transaction_pharmacies_trans_sum_1m / NULLIF (transaction_pharmacies_trans_sum_3m, 0) AS transaction_pharmacies_trans_sum_1m_to_3m,
    transaction_pharmacies_trans_cnt_3m / NULLIF (transaction_pharmacies_trans_cnt_6m, 0) AS transaction_pharmacies_trans_cnt_3m_to_6m,
    transaction_pharmacies_trans_sum_3m / NULLIF (transaction_pharmacies_trans_sum_6m, 0) AS transaction_pharmacies_trans_sum_3m_to_6m,
    transaction_pharmacies_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_pharmacies_trans_cnt_1m_to_total_1m, 
    transaction_pharmacies_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_pharmacies_trans_sum_1m_to_total_1m, 
    transaction_pharmacies_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_pharmacies_trans_cnt_3m_to_total_3m, 
    transaction_pharmacies_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_pharmacies_trans_sum_3m_to_total_3m,
    transaction_pharmacies_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_pharmacies_trans_cnt_3m_to_total_6m, 
    transaction_pharmacies_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_pharmacies_trans_sum_3m_to_total_6m, 
    transaction_pharmacies_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_pharmacies_trans_cnt_6m_to_total_6m, 
    transaction_pharmacies_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_pharmacies_trans_sum_6m_to_total_6m, 
    transaction_pharmacies_trans_avg_sum_1m / NULLIF (transaction_pharmacies_trans_avg_sum_3m, 0) AS transaction_pharmacies_trans_avg_sum_1m_to_3m, 
    transaction_pharmacies_trans_avg_cnt_1m / NULLIF (transaction_pharmacies_trans_avg_cnt_3m, 0) AS transaction_pharmacies_trans_avg_cnt_1m_to_3m, 
    transaction_pharmacies_trans_avg_sum_3m / NULLIF (transaction_pharmacies_trans_avg_sum_6m, 0) AS transaction_pharmacies_trans_avg_sum_3m_to_6m, 
    transaction_pharmacies_trans_avg_cnt_3m / NULLIF (transaction_pharmacies_trans_avg_cnt_6m, 0) AS transaction_pharmacies_trans_avg_cnt_3m_to_6m, 
    transaction_pharmacies_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_pharmacies_trans_avg_sum_1m_to_total_1m,
    transaction_pharmacies_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_pharmacies_trans_avg_cnt_1m_to_total_1m,
    transaction_pharmacies_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_pharmacies_trans_avg_sum_3m_to_total_3m, 
    transaction_pharmacies_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_pharmacies_trans_avg_cnt_3m_to_total_3m, 
    transaction_pharmacies_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_pharmacies_trans_avg_sum_3m_to_total_6m, 
    transaction_pharmacies_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_pharmacies_trans_avg_cnt_3m_to_total_6m, 
    transaction_pharmacies_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_pharmacies_trans_avg_sum_6m_to_total_6m, 
    transaction_pharmacies_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_pharmacies_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_23 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_71 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_flowers_trans_cnt_1m / NULLIF (transaction_flowers_trans_cnt_3m, 0) AS transaction_flowers_trans_cnt_1m_to_3m,
    transaction_flowers_trans_sum_1m / NULLIF (transaction_flowers_trans_sum_3m, 0) AS transaction_flowers_trans_sum_1m_to_3m,
    transaction_flowers_trans_cnt_3m / NULLIF (transaction_flowers_trans_cnt_6m, 0) AS transaction_flowers_trans_cnt_3m_to_6m,
    transaction_flowers_trans_sum_3m / NULLIF (transaction_flowers_trans_sum_6m, 0) AS transaction_flowers_trans_sum_3m_to_6m,
    transaction_flowers_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_flowers_trans_cnt_1m_to_total_1m, 
    transaction_flowers_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_flowers_trans_sum_1m_to_total_1m, 
    transaction_flowers_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_flowers_trans_cnt_3m_to_total_3m, 
    transaction_flowers_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_flowers_trans_sum_3m_to_total_3m,
    transaction_flowers_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_flowers_trans_cnt_3m_to_total_6m, 
    transaction_flowers_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_flowers_trans_sum_3m_to_total_6m, 
    transaction_flowers_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_flowers_trans_cnt_6m_to_total_6m, 
    transaction_flowers_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_flowers_trans_sum_6m_to_total_6m, 
    transaction_flowers_trans_avg_sum_1m / NULLIF (transaction_flowers_trans_avg_sum_3m, 0) AS transaction_flowers_trans_avg_sum_1m_to_3m, 
    transaction_flowers_trans_avg_cnt_1m / NULLIF (transaction_flowers_trans_avg_cnt_3m, 0) AS transaction_flowers_trans_avg_cnt_1m_to_3m, 
    transaction_flowers_trans_avg_sum_3m / NULLIF (transaction_flowers_trans_avg_sum_6m, 0) AS transaction_flowers_trans_avg_sum_3m_to_6m, 
    transaction_flowers_trans_avg_cnt_3m / NULLIF (transaction_flowers_trans_avg_cnt_6m, 0) AS transaction_flowers_trans_avg_cnt_3m_to_6m, 
    transaction_flowers_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_flowers_trans_avg_sum_1m_to_total_1m,
    transaction_flowers_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_flowers_trans_avg_cnt_1m_to_total_1m,
    transaction_flowers_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_flowers_trans_avg_sum_3m_to_total_3m, 
    transaction_flowers_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_flowers_trans_avg_cnt_3m_to_total_3m, 
    transaction_flowers_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_flowers_trans_avg_sum_3m_to_total_6m, 
    transaction_flowers_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_flowers_trans_avg_cnt_3m_to_total_6m, 
    transaction_flowers_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_flowers_trans_avg_sum_6m_to_total_6m, 
    transaction_flowers_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_flowers_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_24 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_72 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_train_trans_cnt_1m / NULLIF (transaction_train_trans_cnt_3m, 0) AS transaction_train_trans_cnt_1m_to_3m,
    transaction_train_trans_sum_1m / NULLIF (transaction_train_trans_sum_3m, 0) AS transaction_train_trans_sum_1m_to_3m,
    transaction_train_trans_cnt_3m / NULLIF (transaction_train_trans_cnt_6m, 0) AS transaction_train_trans_cnt_3m_to_6m,
    transaction_train_trans_sum_3m / NULLIF (transaction_train_trans_sum_6m, 0) AS transaction_train_trans_sum_3m_to_6m,
    transaction_train_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_train_trans_cnt_1m_to_total_1m, 
    transaction_train_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_train_trans_sum_1m_to_total_1m, 
    transaction_train_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_train_trans_cnt_3m_to_total_3m, 
    transaction_train_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_train_trans_sum_3m_to_total_3m,
    transaction_train_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_train_trans_cnt_3m_to_total_6m, 
    transaction_train_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_train_trans_sum_3m_to_total_6m, 
    transaction_train_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_train_trans_cnt_6m_to_total_6m, 
    transaction_train_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_train_trans_sum_6m_to_total_6m, 
    transaction_train_trans_avg_sum_1m / NULLIF (transaction_train_trans_avg_sum_3m, 0) AS transaction_train_trans_avg_sum_1m_to_3m, 
    transaction_train_trans_avg_cnt_1m / NULLIF (transaction_train_trans_avg_cnt_3m, 0) AS transaction_train_trans_avg_cnt_1m_to_3m, 
    transaction_train_trans_avg_sum_3m / NULLIF (transaction_train_trans_avg_sum_6m, 0) AS transaction_train_trans_avg_sum_3m_to_6m, 
    transaction_train_trans_avg_cnt_3m / NULLIF (transaction_train_trans_avg_cnt_6m, 0) AS transaction_train_trans_avg_cnt_3m_to_6m, 
    transaction_train_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_train_trans_avg_sum_1m_to_total_1m,
    transaction_train_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_train_trans_avg_cnt_1m_to_total_1m,
    transaction_train_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_train_trans_avg_sum_3m_to_total_3m, 
    transaction_train_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_train_trans_avg_cnt_3m_to_total_3m, 
    transaction_train_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_train_trans_avg_sum_3m_to_total_6m, 
    transaction_train_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_train_trans_avg_cnt_3m_to_total_6m, 
    transaction_train_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_train_trans_avg_sum_6m_to_total_6m, 
    transaction_train_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_train_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_25 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_73 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_gambling_trans_cnt_1m / NULLIF (transaction_gambling_trans_cnt_3m, 0) AS transaction_gambling_trans_cnt_1m_to_3m,
    transaction_gambling_trans_sum_1m / NULLIF (transaction_gambling_trans_sum_3m, 0) AS transaction_gambling_trans_sum_1m_to_3m,
    transaction_gambling_trans_cnt_3m / NULLIF (transaction_gambling_trans_cnt_6m, 0) AS transaction_gambling_trans_cnt_3m_to_6m,
    transaction_gambling_trans_sum_3m / NULLIF (transaction_gambling_trans_sum_6m, 0) AS transaction_gambling_trans_sum_3m_to_6m,
    transaction_gambling_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_gambling_trans_cnt_1m_to_total_1m, 
    transaction_gambling_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_gambling_trans_sum_1m_to_total_1m, 
    transaction_gambling_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_gambling_trans_cnt_3m_to_total_3m, 
    transaction_gambling_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_gambling_trans_sum_3m_to_total_3m,
    transaction_gambling_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_gambling_trans_cnt_3m_to_total_6m, 
    transaction_gambling_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_gambling_trans_sum_3m_to_total_6m, 
    transaction_gambling_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_gambling_trans_cnt_6m_to_total_6m, 
    transaction_gambling_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_gambling_trans_sum_6m_to_total_6m, 
    transaction_gambling_trans_avg_sum_1m / NULLIF (transaction_gambling_trans_avg_sum_3m, 0) AS transaction_gambling_trans_avg_sum_1m_to_3m, 
    transaction_gambling_trans_avg_cnt_1m / NULLIF (transaction_gambling_trans_avg_cnt_3m, 0) AS transaction_gambling_trans_avg_cnt_1m_to_3m, 
    transaction_gambling_trans_avg_sum_3m / NULLIF (transaction_gambling_trans_avg_sum_6m, 0) AS transaction_gambling_trans_avg_sum_3m_to_6m, 
    transaction_gambling_trans_avg_cnt_3m / NULLIF (transaction_gambling_trans_avg_cnt_6m, 0) AS transaction_gambling_trans_avg_cnt_3m_to_6m, 
    transaction_gambling_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_gambling_trans_avg_sum_1m_to_total_1m,
    transaction_gambling_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_gambling_trans_avg_cnt_1m_to_total_1m,
    transaction_gambling_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_gambling_trans_avg_sum_3m_to_total_3m, 
    transaction_gambling_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_gambling_trans_avg_cnt_3m_to_total_3m, 
    transaction_gambling_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_gambling_trans_avg_sum_3m_to_total_6m, 
    transaction_gambling_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_gambling_trans_avg_cnt_3m_to_total_6m, 
    transaction_gambling_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_gambling_trans_avg_sum_6m_to_total_6m, 
    transaction_gambling_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_gambling_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_26 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_74 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_digital_goods_trans_cnt_1m / NULLIF (transaction_digital_goods_trans_cnt_3m, 0) AS transaction_digital_goods_trans_cnt_1m_to_3m,
    transaction_digital_goods_trans_sum_1m / NULLIF (transaction_digital_goods_trans_sum_3m, 0) AS transaction_digital_goods_trans_sum_1m_to_3m,
    transaction_digital_goods_trans_cnt_3m / NULLIF (transaction_digital_goods_trans_cnt_6m, 0) AS transaction_digital_goods_trans_cnt_3m_to_6m,
    transaction_digital_goods_trans_sum_3m / NULLIF (transaction_digital_goods_trans_sum_6m, 0) AS transaction_digital_goods_trans_sum_3m_to_6m,
    transaction_digital_goods_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_digital_goods_trans_cnt_1m_to_total_1m, 
    transaction_digital_goods_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_digital_goods_trans_sum_1m_to_total_1m, 
    transaction_digital_goods_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_digital_goods_trans_cnt_3m_to_total_3m, 
    transaction_digital_goods_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_digital_goods_trans_sum_3m_to_total_3m,
    transaction_digital_goods_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_digital_goods_trans_cnt_3m_to_total_6m, 
    transaction_digital_goods_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_digital_goods_trans_sum_3m_to_total_6m, 
    transaction_digital_goods_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_digital_goods_trans_cnt_6m_to_total_6m, 
    transaction_digital_goods_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_digital_goods_trans_sum_6m_to_total_6m, 
    transaction_digital_goods_trans_avg_sum_1m / NULLIF (transaction_digital_goods_trans_avg_sum_3m, 0) AS transaction_digital_goods_trans_avg_sum_1m_to_3m, 
    transaction_digital_goods_trans_avg_cnt_1m / NULLIF (transaction_digital_goods_trans_avg_cnt_3m, 0) AS transaction_digital_goods_trans_avg_cnt_1m_to_3m, 
    transaction_digital_goods_trans_avg_sum_3m / NULLIF (transaction_digital_goods_trans_avg_sum_6m, 0) AS transaction_digital_goods_trans_avg_sum_3m_to_6m, 
    transaction_digital_goods_trans_avg_cnt_3m / NULLIF (transaction_digital_goods_trans_avg_cnt_6m, 0) AS transaction_digital_goods_trans_avg_cnt_3m_to_6m, 
    transaction_digital_goods_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_digital_goods_trans_avg_sum_1m_to_total_1m,
    transaction_digital_goods_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_digital_goods_trans_avg_cnt_1m_to_total_1m,
    transaction_digital_goods_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_digital_goods_trans_avg_sum_3m_to_total_3m, 
    transaction_digital_goods_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_digital_goods_trans_avg_cnt_3m_to_total_3m, 
    transaction_digital_goods_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_digital_goods_trans_avg_sum_3m_to_total_6m, 
    transaction_digital_goods_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_digital_goods_trans_avg_cnt_3m_to_total_6m, 
    transaction_digital_goods_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_digital_goods_trans_avg_sum_6m_to_total_6m, 
    transaction_digital_goods_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_digital_goods_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_27 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_75 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_books_trans_cnt_1m / NULLIF (transaction_books_trans_cnt_3m, 0) AS transaction_books_trans_cnt_1m_to_3m,
    transaction_books_trans_sum_1m / NULLIF (transaction_books_trans_sum_3m, 0) AS transaction_books_trans_sum_1m_to_3m,
    transaction_books_trans_cnt_3m / NULLIF (transaction_books_trans_cnt_6m, 0) AS transaction_books_trans_cnt_3m_to_6m,
    transaction_books_trans_sum_3m / NULLIF (transaction_books_trans_sum_6m, 0) AS transaction_books_trans_sum_3m_to_6m,
    transaction_books_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_books_trans_cnt_1m_to_total_1m, 
    transaction_books_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_books_trans_sum_1m_to_total_1m, 
    transaction_books_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_books_trans_cnt_3m_to_total_3m, 
    transaction_books_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_books_trans_sum_3m_to_total_3m,
    transaction_books_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_books_trans_cnt_3m_to_total_6m, 
    transaction_books_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_books_trans_sum_3m_to_total_6m, 
    transaction_books_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_books_trans_cnt_6m_to_total_6m, 
    transaction_books_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_books_trans_sum_6m_to_total_6m, 
    transaction_books_trans_avg_sum_1m / NULLIF (transaction_books_trans_avg_sum_3m, 0) AS transaction_books_trans_avg_sum_1m_to_3m, 
    transaction_books_trans_avg_cnt_1m / NULLIF (transaction_books_trans_avg_cnt_3m, 0) AS transaction_books_trans_avg_cnt_1m_to_3m, 
    transaction_books_trans_avg_sum_3m / NULLIF (transaction_books_trans_avg_sum_6m, 0) AS transaction_books_trans_avg_sum_3m_to_6m, 
    transaction_books_trans_avg_cnt_3m / NULLIF (transaction_books_trans_avg_cnt_6m, 0) AS transaction_books_trans_avg_cnt_3m_to_6m, 
    transaction_books_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_books_trans_avg_sum_1m_to_total_1m,
    transaction_books_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_books_trans_avg_cnt_1m_to_total_1m,
    transaction_books_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_books_trans_avg_sum_3m_to_total_3m, 
    transaction_books_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_books_trans_avg_cnt_3m_to_total_3m, 
    transaction_books_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_books_trans_avg_sum_3m_to_total_6m, 
    transaction_books_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_books_trans_avg_cnt_3m_to_total_6m, 
    transaction_books_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_books_trans_avg_sum_6m_to_total_6m, 
    transaction_books_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_books_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_28 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_76 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_fuel_trans_cnt_1m / NULLIF (transaction_fuel_trans_cnt_3m, 0) AS transaction_fuel_trans_cnt_1m_to_3m,
    transaction_fuel_trans_sum_1m / NULLIF (transaction_fuel_trans_sum_3m, 0) AS transaction_fuel_trans_sum_1m_to_3m,
    transaction_fuel_trans_cnt_3m / NULLIF (transaction_fuel_trans_cnt_6m, 0) AS transaction_fuel_trans_cnt_3m_to_6m,
    transaction_fuel_trans_sum_3m / NULLIF (transaction_fuel_trans_sum_6m, 0) AS transaction_fuel_trans_sum_3m_to_6m,
    transaction_fuel_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_fuel_trans_cnt_1m_to_total_1m, 
    transaction_fuel_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_fuel_trans_sum_1m_to_total_1m, 
    transaction_fuel_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_fuel_trans_cnt_3m_to_total_3m, 
    transaction_fuel_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_fuel_trans_sum_3m_to_total_3m,
    transaction_fuel_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_fuel_trans_cnt_3m_to_total_6m, 
    transaction_fuel_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_fuel_trans_sum_3m_to_total_6m, 
    transaction_fuel_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_fuel_trans_cnt_6m_to_total_6m, 
    transaction_fuel_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_fuel_trans_sum_6m_to_total_6m, 
    transaction_fuel_trans_avg_sum_1m / NULLIF (transaction_fuel_trans_avg_sum_3m, 0) AS transaction_fuel_trans_avg_sum_1m_to_3m, 
    transaction_fuel_trans_avg_cnt_1m / NULLIF (transaction_fuel_trans_avg_cnt_3m, 0) AS transaction_fuel_trans_avg_cnt_1m_to_3m, 
    transaction_fuel_trans_avg_sum_3m / NULLIF (transaction_fuel_trans_avg_sum_6m, 0) AS transaction_fuel_trans_avg_sum_3m_to_6m, 
    transaction_fuel_trans_avg_cnt_3m / NULLIF (transaction_fuel_trans_avg_cnt_6m, 0) AS transaction_fuel_trans_avg_cnt_3m_to_6m, 
    transaction_fuel_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_fuel_trans_avg_sum_1m_to_total_1m,
    transaction_fuel_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_fuel_trans_avg_cnt_1m_to_total_1m,
    transaction_fuel_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_fuel_trans_avg_sum_3m_to_total_3m, 
    transaction_fuel_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_fuel_trans_avg_cnt_3m_to_total_3m, 
    transaction_fuel_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_fuel_trans_avg_sum_3m_to_total_6m, 
    transaction_fuel_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_fuel_trans_avg_cnt_3m_to_total_6m, 
    transaction_fuel_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_fuel_trans_avg_sum_6m_to_total_6m, 
    transaction_fuel_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_fuel_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_29 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_77 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_yandex_trans_cnt_1m / NULLIF (transaction_yandex_trans_cnt_3m, 0) AS transaction_yandex_trans_cnt_1m_to_3m,
    transaction_yandex_trans_sum_1m / NULLIF (transaction_yandex_trans_sum_3m, 0) AS transaction_yandex_trans_sum_1m_to_3m,
    transaction_yandex_trans_cnt_3m / NULLIF (transaction_yandex_trans_cnt_6m, 0) AS transaction_yandex_trans_cnt_3m_to_6m,
    transaction_yandex_trans_sum_3m / NULLIF (transaction_yandex_trans_sum_6m, 0) AS transaction_yandex_trans_sum_3m_to_6m,
    transaction_yandex_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_yandex_trans_cnt_1m_to_total_1m, 
    transaction_yandex_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_yandex_trans_sum_1m_to_total_1m, 
    transaction_yandex_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_yandex_trans_cnt_3m_to_total_3m, 
    transaction_yandex_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_yandex_trans_sum_3m_to_total_3m,
    transaction_yandex_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_yandex_trans_cnt_3m_to_total_6m, 
    transaction_yandex_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_yandex_trans_sum_3m_to_total_6m, 
    transaction_yandex_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_yandex_trans_cnt_6m_to_total_6m, 
    transaction_yandex_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_yandex_trans_sum_6m_to_total_6m, 
    transaction_yandex_trans_avg_sum_1m / NULLIF (transaction_yandex_trans_avg_sum_3m, 0) AS transaction_yandex_trans_avg_sum_1m_to_3m, 
    transaction_yandex_trans_avg_cnt_1m / NULLIF (transaction_yandex_trans_avg_cnt_3m, 0) AS transaction_yandex_trans_avg_cnt_1m_to_3m, 
    transaction_yandex_trans_avg_sum_3m / NULLIF (transaction_yandex_trans_avg_sum_6m, 0) AS transaction_yandex_trans_avg_sum_3m_to_6m, 
    transaction_yandex_trans_avg_cnt_3m / NULLIF (transaction_yandex_trans_avg_cnt_6m, 0) AS transaction_yandex_trans_avg_cnt_3m_to_6m, 
    transaction_yandex_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_yandex_trans_avg_sum_1m_to_total_1m,
    transaction_yandex_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_yandex_trans_avg_cnt_1m_to_total_1m,
    transaction_yandex_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_yandex_trans_avg_sum_3m_to_total_3m, 
    transaction_yandex_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_yandex_trans_avg_cnt_3m_to_total_3m, 
    transaction_yandex_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_yandex_trans_avg_sum_3m_to_total_6m, 
    transaction_yandex_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_yandex_trans_avg_cnt_3m_to_total_6m, 
    transaction_yandex_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_yandex_trans_avg_sum_6m_to_total_6m, 
    transaction_yandex_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_yandex_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_30 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_78 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_beauty_trans_cnt_1m / NULLIF (transaction_beauty_trans_cnt_3m, 0) AS transaction_beauty_trans_cnt_1m_to_3m,
    transaction_beauty_trans_sum_1m / NULLIF (transaction_beauty_trans_sum_3m, 0) AS transaction_beauty_trans_sum_1m_to_3m,
    transaction_beauty_trans_cnt_3m / NULLIF (transaction_beauty_trans_cnt_6m, 0) AS transaction_beauty_trans_cnt_3m_to_6m,
    transaction_beauty_trans_sum_3m / NULLIF (transaction_beauty_trans_sum_6m, 0) AS transaction_beauty_trans_sum_3m_to_6m,
    transaction_beauty_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_beauty_trans_cnt_1m_to_total_1m, 
    transaction_beauty_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_beauty_trans_sum_1m_to_total_1m, 
    transaction_beauty_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_beauty_trans_cnt_3m_to_total_3m, 
    transaction_beauty_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_beauty_trans_sum_3m_to_total_3m,
    transaction_beauty_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_beauty_trans_cnt_3m_to_total_6m, 
    transaction_beauty_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_beauty_trans_sum_3m_to_total_6m, 
    transaction_beauty_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_beauty_trans_cnt_6m_to_total_6m, 
    transaction_beauty_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_beauty_trans_sum_6m_to_total_6m, 
    transaction_beauty_trans_avg_sum_1m / NULLIF (transaction_beauty_trans_avg_sum_3m, 0) AS transaction_beauty_trans_avg_sum_1m_to_3m, 
    transaction_beauty_trans_avg_cnt_1m / NULLIF (transaction_beauty_trans_avg_cnt_3m, 0) AS transaction_beauty_trans_avg_cnt_1m_to_3m, 
    transaction_beauty_trans_avg_sum_3m / NULLIF (transaction_beauty_trans_avg_sum_6m, 0) AS transaction_beauty_trans_avg_sum_3m_to_6m, 
    transaction_beauty_trans_avg_cnt_3m / NULLIF (transaction_beauty_trans_avg_cnt_6m, 0) AS transaction_beauty_trans_avg_cnt_3m_to_6m, 
    transaction_beauty_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_beauty_trans_avg_sum_1m_to_total_1m,
    transaction_beauty_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_beauty_trans_avg_cnt_1m_to_total_1m,
    transaction_beauty_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_beauty_trans_avg_sum_3m_to_total_3m, 
    transaction_beauty_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_beauty_trans_avg_cnt_3m_to_total_3m, 
    transaction_beauty_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_beauty_trans_avg_sum_3m_to_total_6m, 
    transaction_beauty_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_beauty_trans_avg_cnt_3m_to_total_6m, 
    transaction_beauty_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_beauty_trans_avg_sum_6m_to_total_6m, 
    transaction_beauty_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_beauty_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_31 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_79 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_cinema_trans_cnt_1m / NULLIF (transaction_cinema_trans_cnt_3m, 0) AS transaction_cinema_trans_cnt_1m_to_3m,
    transaction_cinema_trans_sum_1m / NULLIF (transaction_cinema_trans_sum_3m, 0) AS transaction_cinema_trans_sum_1m_to_3m,
    transaction_cinema_trans_cnt_3m / NULLIF (transaction_cinema_trans_cnt_6m, 0) AS transaction_cinema_trans_cnt_3m_to_6m,
    transaction_cinema_trans_sum_3m / NULLIF (transaction_cinema_trans_sum_6m, 0) AS transaction_cinema_trans_sum_3m_to_6m,
    transaction_cinema_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_cinema_trans_cnt_1m_to_total_1m, 
    transaction_cinema_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_cinema_trans_sum_1m_to_total_1m, 
    transaction_cinema_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_cinema_trans_cnt_3m_to_total_3m, 
    transaction_cinema_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_cinema_trans_sum_3m_to_total_3m,
    transaction_cinema_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_cinema_trans_cnt_3m_to_total_6m, 
    transaction_cinema_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_cinema_trans_sum_3m_to_total_6m, 
    transaction_cinema_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_cinema_trans_cnt_6m_to_total_6m, 
    transaction_cinema_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_cinema_trans_sum_6m_to_total_6m, 
    transaction_cinema_trans_avg_sum_1m / NULLIF (transaction_cinema_trans_avg_sum_3m, 0) AS transaction_cinema_trans_avg_sum_1m_to_3m, 
    transaction_cinema_trans_avg_cnt_1m / NULLIF (transaction_cinema_trans_avg_cnt_3m, 0) AS transaction_cinema_trans_avg_cnt_1m_to_3m, 
    transaction_cinema_trans_avg_sum_3m / NULLIF (transaction_cinema_trans_avg_sum_6m, 0) AS transaction_cinema_trans_avg_sum_3m_to_6m, 
    transaction_cinema_trans_avg_cnt_3m / NULLIF (transaction_cinema_trans_avg_cnt_6m, 0) AS transaction_cinema_trans_avg_cnt_3m_to_6m, 
    transaction_cinema_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_cinema_trans_avg_sum_1m_to_total_1m,
    transaction_cinema_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_cinema_trans_avg_cnt_1m_to_total_1m,
    transaction_cinema_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_cinema_trans_avg_sum_3m_to_total_3m, 
    transaction_cinema_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_cinema_trans_avg_cnt_3m_to_total_3m, 
    transaction_cinema_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_cinema_trans_avg_sum_3m_to_total_6m, 
    transaction_cinema_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_cinema_trans_avg_cnt_3m_to_total_6m, 
    transaction_cinema_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_cinema_trans_avg_sum_6m_to_total_6m, 
    transaction_cinema_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_cinema_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_32 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_80 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_charity_trans_cnt_1m / NULLIF (transaction_charity_trans_cnt_3m, 0) AS transaction_charity_trans_cnt_1m_to_3m,
    transaction_charity_trans_sum_1m / NULLIF (transaction_charity_trans_sum_3m, 0) AS transaction_charity_trans_sum_1m_to_3m,
    transaction_charity_trans_cnt_3m / NULLIF (transaction_charity_trans_cnt_6m, 0) AS transaction_charity_trans_cnt_3m_to_6m,
    transaction_charity_trans_sum_3m / NULLIF (transaction_charity_trans_sum_6m, 0) AS transaction_charity_trans_sum_3m_to_6m,
    transaction_charity_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_charity_trans_cnt_1m_to_total_1m, 
    transaction_charity_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_charity_trans_sum_1m_to_total_1m, 
    transaction_charity_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_charity_trans_cnt_3m_to_total_3m, 
    transaction_charity_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_charity_trans_sum_3m_to_total_3m,
    transaction_charity_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_charity_trans_cnt_3m_to_total_6m, 
    transaction_charity_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_charity_trans_sum_3m_to_total_6m, 
    transaction_charity_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_charity_trans_cnt_6m_to_total_6m, 
    transaction_charity_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_charity_trans_sum_6m_to_total_6m, 
    transaction_charity_trans_avg_sum_1m / NULLIF (transaction_charity_trans_avg_sum_3m, 0) AS transaction_charity_trans_avg_sum_1m_to_3m, 
    transaction_charity_trans_avg_cnt_1m / NULLIF (transaction_charity_trans_avg_cnt_3m, 0) AS transaction_charity_trans_avg_cnt_1m_to_3m, 
    transaction_charity_trans_avg_sum_3m / NULLIF (transaction_charity_trans_avg_sum_6m, 0) AS transaction_charity_trans_avg_sum_3m_to_6m, 
    transaction_charity_trans_avg_cnt_3m / NULLIF (transaction_charity_trans_avg_cnt_6m, 0) AS transaction_charity_trans_avg_cnt_3m_to_6m, 
    transaction_charity_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_charity_trans_avg_sum_1m_to_total_1m,
    transaction_charity_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_charity_trans_avg_cnt_1m_to_total_1m,
    transaction_charity_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_charity_trans_avg_sum_3m_to_total_3m, 
    transaction_charity_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_charity_trans_avg_cnt_3m_to_total_3m, 
    transaction_charity_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_charity_trans_avg_sum_3m_to_total_6m, 
    transaction_charity_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_charity_trans_avg_cnt_3m_to_total_6m, 
    transaction_charity_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_charity_trans_avg_sum_6m_to_total_6m, 
    transaction_charity_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_charity_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_33 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_81 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_money_transfers_trans_cnt_1m / NULLIF (transaction_money_transfers_trans_cnt_3m, 0) AS transaction_money_transfers_trans_cnt_1m_to_3m,
    transaction_money_transfers_trans_sum_1m / NULLIF (transaction_money_transfers_trans_sum_3m, 0) AS transaction_money_transfers_trans_sum_1m_to_3m,
    transaction_money_transfers_trans_cnt_3m / NULLIF (transaction_money_transfers_trans_cnt_6m, 0) AS transaction_money_transfers_trans_cnt_3m_to_6m,
    transaction_money_transfers_trans_sum_3m / NULLIF (transaction_money_transfers_trans_sum_6m, 0) AS transaction_money_transfers_trans_sum_3m_to_6m,
    transaction_money_transfers_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_money_transfers_trans_cnt_1m_to_total_1m, 
    transaction_money_transfers_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_money_transfers_trans_sum_1m_to_total_1m, 
    transaction_money_transfers_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_money_transfers_trans_cnt_3m_to_total_3m, 
    transaction_money_transfers_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_money_transfers_trans_sum_3m_to_total_3m,
    transaction_money_transfers_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_money_transfers_trans_cnt_3m_to_total_6m, 
    transaction_money_transfers_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_money_transfers_trans_sum_3m_to_total_6m, 
    transaction_money_transfers_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_money_transfers_trans_cnt_6m_to_total_6m, 
    transaction_money_transfers_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_money_transfers_trans_sum_6m_to_total_6m, 
    transaction_money_transfers_trans_avg_sum_1m / NULLIF (transaction_money_transfers_trans_avg_sum_3m, 0) AS transaction_money_transfers_trans_avg_sum_1m_to_3m, 
    transaction_money_transfers_trans_avg_cnt_1m / NULLIF (transaction_money_transfers_trans_avg_cnt_3m, 0) AS transaction_money_transfers_trans_avg_cnt_1m_to_3m, 
    transaction_money_transfers_trans_avg_sum_3m / NULLIF (transaction_money_transfers_trans_avg_sum_6m, 0) AS transaction_money_transfers_trans_avg_sum_3m_to_6m, 
    transaction_money_transfers_trans_avg_cnt_3m / NULLIF (transaction_money_transfers_trans_avg_cnt_6m, 0) AS transaction_money_transfers_trans_avg_cnt_3m_to_6m, 
    transaction_money_transfers_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_money_transfers_trans_avg_sum_1m_to_total_1m,
    transaction_money_transfers_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_money_transfers_trans_avg_cnt_1m_to_total_1m,
    transaction_money_transfers_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_money_transfers_trans_avg_sum_3m_to_total_3m, 
    transaction_money_transfers_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_money_transfers_trans_avg_cnt_3m_to_total_3m, 
    transaction_money_transfers_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_money_transfers_trans_avg_sum_3m_to_total_6m, 
    transaction_money_transfers_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_money_transfers_trans_avg_cnt_3m_to_total_6m, 
    transaction_money_transfers_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_money_transfers_trans_avg_sum_6m_to_total_6m, 
    transaction_money_transfers_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_money_transfers_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_34 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_82 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_auto_services_trans_cnt_1m / NULLIF (transaction_auto_services_trans_cnt_3m, 0) AS transaction_auto_services_trans_cnt_1m_to_3m,
    transaction_auto_services_trans_sum_1m / NULLIF (transaction_auto_services_trans_sum_3m, 0) AS transaction_auto_services_trans_sum_1m_to_3m,
    transaction_auto_services_trans_cnt_3m / NULLIF (transaction_auto_services_trans_cnt_6m, 0) AS transaction_auto_services_trans_cnt_3m_to_6m,
    transaction_auto_services_trans_sum_3m / NULLIF (transaction_auto_services_trans_sum_6m, 0) AS transaction_auto_services_trans_sum_3m_to_6m,
    transaction_auto_services_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_auto_services_trans_cnt_1m_to_total_1m, 
    transaction_auto_services_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_auto_services_trans_sum_1m_to_total_1m, 
    transaction_auto_services_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_auto_services_trans_cnt_3m_to_total_3m, 
    transaction_auto_services_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_auto_services_trans_sum_3m_to_total_3m,
    transaction_auto_services_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_auto_services_trans_cnt_3m_to_total_6m, 
    transaction_auto_services_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_auto_services_trans_sum_3m_to_total_6m, 
    transaction_auto_services_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_auto_services_trans_cnt_6m_to_total_6m, 
    transaction_auto_services_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_auto_services_trans_sum_6m_to_total_6m, 
    transaction_auto_services_trans_avg_sum_1m / NULLIF (transaction_auto_services_trans_avg_sum_3m, 0) AS transaction_auto_services_trans_avg_sum_1m_to_3m, 
    transaction_auto_services_trans_avg_cnt_1m / NULLIF (transaction_auto_services_trans_avg_cnt_3m, 0) AS transaction_auto_services_trans_avg_cnt_1m_to_3m, 
    transaction_auto_services_trans_avg_sum_3m / NULLIF (transaction_auto_services_trans_avg_sum_6m, 0) AS transaction_auto_services_trans_avg_sum_3m_to_6m, 
    transaction_auto_services_trans_avg_cnt_3m / NULLIF (transaction_auto_services_trans_avg_cnt_6m, 0) AS transaction_auto_services_trans_avg_cnt_3m_to_6m, 
    transaction_auto_services_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_auto_services_trans_avg_sum_1m_to_total_1m,
    transaction_auto_services_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_auto_services_trans_avg_cnt_1m_to_total_1m,
    transaction_auto_services_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_auto_services_trans_avg_sum_3m_to_total_3m, 
    transaction_auto_services_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_auto_services_trans_avg_cnt_3m_to_total_3m, 
    transaction_auto_services_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_auto_services_trans_avg_sum_3m_to_total_6m, 
    transaction_auto_services_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_auto_services_trans_avg_cnt_3m_to_total_6m, 
    transaction_auto_services_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_auto_services_trans_avg_sum_6m_to_total_6m, 
    transaction_auto_services_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_auto_services_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_35 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_83 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_consulting_trans_cnt_1m / NULLIF (transaction_consulting_trans_cnt_3m, 0) AS transaction_consulting_trans_cnt_1m_to_3m,
    transaction_consulting_trans_sum_1m / NULLIF (transaction_consulting_trans_sum_3m, 0) AS transaction_consulting_trans_sum_1m_to_3m,
    transaction_consulting_trans_cnt_3m / NULLIF (transaction_consulting_trans_cnt_6m, 0) AS transaction_consulting_trans_cnt_3m_to_6m,
    transaction_consulting_trans_sum_3m / NULLIF (transaction_consulting_trans_sum_6m, 0) AS transaction_consulting_trans_sum_3m_to_6m,
    transaction_consulting_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_consulting_trans_cnt_1m_to_total_1m, 
    transaction_consulting_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_consulting_trans_sum_1m_to_total_1m, 
    transaction_consulting_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_consulting_trans_cnt_3m_to_total_3m, 
    transaction_consulting_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_consulting_trans_sum_3m_to_total_3m,
    transaction_consulting_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_consulting_trans_cnt_3m_to_total_6m, 
    transaction_consulting_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_consulting_trans_sum_3m_to_total_6m, 
    transaction_consulting_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_consulting_trans_cnt_6m_to_total_6m, 
    transaction_consulting_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_consulting_trans_sum_6m_to_total_6m, 
    transaction_consulting_trans_avg_sum_1m / NULLIF (transaction_consulting_trans_avg_sum_3m, 0) AS transaction_consulting_trans_avg_sum_1m_to_3m, 
    transaction_consulting_trans_avg_cnt_1m / NULLIF (transaction_consulting_trans_avg_cnt_3m, 0) AS transaction_consulting_trans_avg_cnt_1m_to_3m, 
    transaction_consulting_trans_avg_sum_3m / NULLIF (transaction_consulting_trans_avg_sum_6m, 0) AS transaction_consulting_trans_avg_sum_3m_to_6m, 
    transaction_consulting_trans_avg_cnt_3m / NULLIF (transaction_consulting_trans_avg_cnt_6m, 0) AS transaction_consulting_trans_avg_cnt_3m_to_6m, 
    transaction_consulting_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_consulting_trans_avg_sum_1m_to_total_1m,
    transaction_consulting_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_consulting_trans_avg_cnt_1m_to_total_1m,
    transaction_consulting_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_consulting_trans_avg_sum_3m_to_total_3m, 
    transaction_consulting_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_consulting_trans_avg_cnt_3m_to_total_3m, 
    transaction_consulting_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_consulting_trans_avg_sum_3m_to_total_6m, 
    transaction_consulting_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_consulting_trans_avg_cnt_3m_to_total_6m, 
    transaction_consulting_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_consulting_trans_avg_sum_6m_to_total_6m, 
    transaction_consulting_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_consulting_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_36 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_84 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_cash_trans_cnt_1m / NULLIF (transaction_cash_trans_cnt_3m, 0) AS transaction_cash_trans_cnt_1m_to_3m,
    transaction_cash_trans_sum_1m / NULLIF (transaction_cash_trans_sum_3m, 0) AS transaction_cash_trans_sum_1m_to_3m,
    transaction_cash_trans_cnt_3m / NULLIF (transaction_cash_trans_cnt_6m, 0) AS transaction_cash_trans_cnt_3m_to_6m,
    transaction_cash_trans_sum_3m / NULLIF (transaction_cash_trans_sum_6m, 0) AS transaction_cash_trans_sum_3m_to_6m,
    transaction_cash_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_cash_trans_cnt_1m_to_total_1m, 
    transaction_cash_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_cash_trans_sum_1m_to_total_1m, 
    transaction_cash_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_cash_trans_cnt_3m_to_total_3m, 
    transaction_cash_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_cash_trans_sum_3m_to_total_3m,
    transaction_cash_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_cash_trans_cnt_3m_to_total_6m, 
    transaction_cash_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_cash_trans_sum_3m_to_total_6m, 
    transaction_cash_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_cash_trans_cnt_6m_to_total_6m, 
    transaction_cash_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_cash_trans_sum_6m_to_total_6m, 
    transaction_cash_trans_avg_sum_1m / NULLIF (transaction_cash_trans_avg_sum_3m, 0) AS transaction_cash_trans_avg_sum_1m_to_3m, 
    transaction_cash_trans_avg_cnt_1m / NULLIF (transaction_cash_trans_avg_cnt_3m, 0) AS transaction_cash_trans_avg_cnt_1m_to_3m, 
    transaction_cash_trans_avg_sum_3m / NULLIF (transaction_cash_trans_avg_sum_6m, 0) AS transaction_cash_trans_avg_sum_3m_to_6m, 
    transaction_cash_trans_avg_cnt_3m / NULLIF (transaction_cash_trans_avg_cnt_6m, 0) AS transaction_cash_trans_avg_cnt_3m_to_6m, 
    transaction_cash_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_cash_trans_avg_sum_1m_to_total_1m,
    transaction_cash_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_cash_trans_avg_cnt_1m_to_total_1m,
    transaction_cash_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_cash_trans_avg_sum_3m_to_total_3m, 
    transaction_cash_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_cash_trans_avg_cnt_3m_to_total_3m, 
    transaction_cash_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_cash_trans_avg_sum_3m_to_total_6m, 
    transaction_cash_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_cash_trans_avg_cnt_3m_to_total_6m, 
    transaction_cash_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_cash_trans_avg_sum_6m_to_total_6m, 
    transaction_cash_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_cash_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_37 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_85 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_other_trans_cnt_1m / NULLIF (transaction_other_trans_cnt_3m, 0) AS transaction_other_trans_cnt_1m_to_3m,
    transaction_other_trans_sum_1m / NULLIF (transaction_other_trans_sum_3m, 0) AS transaction_other_trans_sum_1m_to_3m,
    transaction_other_trans_cnt_3m / NULLIF (transaction_other_trans_cnt_6m, 0) AS transaction_other_trans_cnt_3m_to_6m,
    transaction_other_trans_sum_3m / NULLIF (transaction_other_trans_sum_6m, 0) AS transaction_other_trans_sum_3m_to_6m,
    transaction_other_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_other_trans_cnt_1m_to_total_1m, 
    transaction_other_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_other_trans_sum_1m_to_total_1m, 
    transaction_other_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_other_trans_cnt_3m_to_total_3m, 
    transaction_other_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_other_trans_sum_3m_to_total_3m,
    transaction_other_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_other_trans_cnt_3m_to_total_6m, 
    transaction_other_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_other_trans_sum_3m_to_total_6m, 
    transaction_other_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_other_trans_cnt_6m_to_total_6m, 
    transaction_other_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_other_trans_sum_6m_to_total_6m, 
    transaction_other_trans_avg_sum_1m / NULLIF (transaction_other_trans_avg_sum_3m, 0) AS transaction_other_trans_avg_sum_1m_to_3m, 
    transaction_other_trans_avg_cnt_1m / NULLIF (transaction_other_trans_avg_cnt_3m, 0) AS transaction_other_trans_avg_cnt_1m_to_3m, 
    transaction_other_trans_avg_sum_3m / NULLIF (transaction_other_trans_avg_sum_6m, 0) AS transaction_other_trans_avg_sum_3m_to_6m, 
    transaction_other_trans_avg_cnt_3m / NULLIF (transaction_other_trans_avg_cnt_6m, 0) AS transaction_other_trans_avg_cnt_3m_to_6m, 
    transaction_other_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_other_trans_avg_sum_1m_to_total_1m,
    transaction_other_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_other_trans_avg_cnt_1m_to_total_1m,
    transaction_other_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_other_trans_avg_sum_3m_to_total_3m, 
    transaction_other_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_other_trans_avg_cnt_3m_to_total_3m, 
    transaction_other_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_other_trans_avg_sum_3m_to_total_6m, 
    transaction_other_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_other_trans_avg_cnt_3m_to_total_6m, 
    transaction_other_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_other_trans_avg_sum_6m_to_total_6m, 
    transaction_other_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_other_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_38 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_86 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_utilities_trans_cnt_1m / NULLIF (transaction_utilities_trans_cnt_3m, 0) AS transaction_utilities_trans_cnt_1m_to_3m,
    transaction_utilities_trans_sum_1m / NULLIF (transaction_utilities_trans_sum_3m, 0) AS transaction_utilities_trans_sum_1m_to_3m,
    transaction_utilities_trans_cnt_3m / NULLIF (transaction_utilities_trans_cnt_6m, 0) AS transaction_utilities_trans_cnt_3m_to_6m,
    transaction_utilities_trans_sum_3m / NULLIF (transaction_utilities_trans_sum_6m, 0) AS transaction_utilities_trans_sum_3m_to_6m,
    transaction_utilities_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_utilities_trans_cnt_1m_to_total_1m, 
    transaction_utilities_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_utilities_trans_sum_1m_to_total_1m, 
    transaction_utilities_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_utilities_trans_cnt_3m_to_total_3m, 
    transaction_utilities_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_utilities_trans_sum_3m_to_total_3m,
    transaction_utilities_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_utilities_trans_cnt_3m_to_total_6m, 
    transaction_utilities_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_utilities_trans_sum_3m_to_total_6m, 
    transaction_utilities_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_utilities_trans_cnt_6m_to_total_6m, 
    transaction_utilities_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_utilities_trans_sum_6m_to_total_6m, 
    transaction_utilities_trans_avg_sum_1m / NULLIF (transaction_utilities_trans_avg_sum_3m, 0) AS transaction_utilities_trans_avg_sum_1m_to_3m, 
    transaction_utilities_trans_avg_cnt_1m / NULLIF (transaction_utilities_trans_avg_cnt_3m, 0) AS transaction_utilities_trans_avg_cnt_1m_to_3m, 
    transaction_utilities_trans_avg_sum_3m / NULLIF (transaction_utilities_trans_avg_sum_6m, 0) AS transaction_utilities_trans_avg_sum_3m_to_6m, 
    transaction_utilities_trans_avg_cnt_3m / NULLIF (transaction_utilities_trans_avg_cnt_6m, 0) AS transaction_utilities_trans_avg_cnt_3m_to_6m, 
    transaction_utilities_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_utilities_trans_avg_sum_1m_to_total_1m,
    transaction_utilities_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_utilities_trans_avg_cnt_1m_to_total_1m,
    transaction_utilities_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_utilities_trans_avg_sum_3m_to_total_3m, 
    transaction_utilities_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_utilities_trans_avg_cnt_3m_to_total_3m, 
    transaction_utilities_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_utilities_trans_avg_sum_3m_to_total_6m, 
    transaction_utilities_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_utilities_trans_avg_cnt_3m_to_total_6m, 
    transaction_utilities_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_utilities_trans_avg_sum_6m_to_total_6m, 
    transaction_utilities_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_utilities_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_39 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_87 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_tech_trans_cnt_1m / NULLIF (transaction_tech_trans_cnt_3m, 0) AS transaction_tech_trans_cnt_1m_to_3m,
    transaction_tech_trans_sum_1m / NULLIF (transaction_tech_trans_sum_3m, 0) AS transaction_tech_trans_sum_1m_to_3m,
    transaction_tech_trans_cnt_3m / NULLIF (transaction_tech_trans_cnt_6m, 0) AS transaction_tech_trans_cnt_3m_to_6m,
    transaction_tech_trans_sum_3m / NULLIF (transaction_tech_trans_sum_6m, 0) AS transaction_tech_trans_sum_3m_to_6m,
    transaction_tech_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_tech_trans_cnt_1m_to_total_1m, 
    transaction_tech_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_tech_trans_sum_1m_to_total_1m, 
    transaction_tech_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_tech_trans_cnt_3m_to_total_3m, 
    transaction_tech_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_tech_trans_sum_3m_to_total_3m,
    transaction_tech_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_tech_trans_cnt_3m_to_total_6m, 
    transaction_tech_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_tech_trans_sum_3m_to_total_6m, 
    transaction_tech_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_tech_trans_cnt_6m_to_total_6m, 
    transaction_tech_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_tech_trans_sum_6m_to_total_6m, 
    transaction_tech_trans_avg_sum_1m / NULLIF (transaction_tech_trans_avg_sum_3m, 0) AS transaction_tech_trans_avg_sum_1m_to_3m, 
    transaction_tech_trans_avg_cnt_1m / NULLIF (transaction_tech_trans_avg_cnt_3m, 0) AS transaction_tech_trans_avg_cnt_1m_to_3m, 
    transaction_tech_trans_avg_sum_3m / NULLIF (transaction_tech_trans_avg_sum_6m, 0) AS transaction_tech_trans_avg_sum_3m_to_6m, 
    transaction_tech_trans_avg_cnt_3m / NULLIF (transaction_tech_trans_avg_cnt_6m, 0) AS transaction_tech_trans_avg_cnt_3m_to_6m, 
    transaction_tech_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_tech_trans_avg_sum_1m_to_total_1m,
    transaction_tech_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_tech_trans_avg_cnt_1m_to_total_1m,
    transaction_tech_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_tech_trans_avg_sum_3m_to_total_3m, 
    transaction_tech_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_tech_trans_avg_cnt_3m_to_total_3m, 
    transaction_tech_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_tech_trans_avg_sum_3m_to_total_6m, 
    transaction_tech_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_tech_trans_avg_cnt_3m_to_total_6m, 
    transaction_tech_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_tech_trans_avg_sum_6m_to_total_6m, 
    transaction_tech_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_tech_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_40 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_88 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_jewelry_trans_cnt_1m / NULLIF (transaction_jewelry_trans_cnt_3m, 0) AS transaction_jewelry_trans_cnt_1m_to_3m,
    transaction_jewelry_trans_sum_1m / NULLIF (transaction_jewelry_trans_sum_3m, 0) AS transaction_jewelry_trans_sum_1m_to_3m,
    transaction_jewelry_trans_cnt_3m / NULLIF (transaction_jewelry_trans_cnt_6m, 0) AS transaction_jewelry_trans_cnt_3m_to_6m,
    transaction_jewelry_trans_sum_3m / NULLIF (transaction_jewelry_trans_sum_6m, 0) AS transaction_jewelry_trans_sum_3m_to_6m,
    transaction_jewelry_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_jewelry_trans_cnt_1m_to_total_1m, 
    transaction_jewelry_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_jewelry_trans_sum_1m_to_total_1m, 
    transaction_jewelry_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_jewelry_trans_cnt_3m_to_total_3m, 
    transaction_jewelry_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_jewelry_trans_sum_3m_to_total_3m,
    transaction_jewelry_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_jewelry_trans_cnt_3m_to_total_6m, 
    transaction_jewelry_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_jewelry_trans_sum_3m_to_total_6m, 
    transaction_jewelry_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_jewelry_trans_cnt_6m_to_total_6m, 
    transaction_jewelry_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_jewelry_trans_sum_6m_to_total_6m, 
    transaction_jewelry_trans_avg_sum_1m / NULLIF (transaction_jewelry_trans_avg_sum_3m, 0) AS transaction_jewelry_trans_avg_sum_1m_to_3m, 
    transaction_jewelry_trans_avg_cnt_1m / NULLIF (transaction_jewelry_trans_avg_cnt_3m, 0) AS transaction_jewelry_trans_avg_cnt_1m_to_3m, 
    transaction_jewelry_trans_avg_sum_3m / NULLIF (transaction_jewelry_trans_avg_sum_6m, 0) AS transaction_jewelry_trans_avg_sum_3m_to_6m, 
    transaction_jewelry_trans_avg_cnt_3m / NULLIF (transaction_jewelry_trans_avg_cnt_6m, 0) AS transaction_jewelry_trans_avg_cnt_3m_to_6m, 
    transaction_jewelry_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_jewelry_trans_avg_sum_1m_to_total_1m,
    transaction_jewelry_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_jewelry_trans_avg_cnt_1m_to_total_1m,
    transaction_jewelry_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_jewelry_trans_avg_sum_3m_to_total_3m, 
    transaction_jewelry_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_jewelry_trans_avg_cnt_3m_to_total_3m, 
    transaction_jewelry_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_jewelry_trans_avg_sum_3m_to_total_6m, 
    transaction_jewelry_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_jewelry_trans_avg_cnt_3m_to_total_6m, 
    transaction_jewelry_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_jewelry_trans_avg_sum_6m_to_total_6m, 
    transaction_jewelry_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_jewelry_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_41 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_89 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_clothes_trans_cnt_1m / NULLIF (transaction_clothes_trans_cnt_3m, 0) AS transaction_clothes_trans_cnt_1m_to_3m,
    transaction_clothes_trans_sum_1m / NULLIF (transaction_clothes_trans_sum_3m, 0) AS transaction_clothes_trans_sum_1m_to_3m,
    transaction_clothes_trans_cnt_3m / NULLIF (transaction_clothes_trans_cnt_6m, 0) AS transaction_clothes_trans_cnt_3m_to_6m,
    transaction_clothes_trans_sum_3m / NULLIF (transaction_clothes_trans_sum_6m, 0) AS transaction_clothes_trans_sum_3m_to_6m,
    transaction_clothes_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_clothes_trans_cnt_1m_to_total_1m, 
    transaction_clothes_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_clothes_trans_sum_1m_to_total_1m, 
    transaction_clothes_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_clothes_trans_cnt_3m_to_total_3m, 
    transaction_clothes_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_clothes_trans_sum_3m_to_total_3m,
    transaction_clothes_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_clothes_trans_cnt_3m_to_total_6m, 
    transaction_clothes_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_clothes_trans_sum_3m_to_total_6m, 
    transaction_clothes_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_clothes_trans_cnt_6m_to_total_6m, 
    transaction_clothes_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_clothes_trans_sum_6m_to_total_6m, 
    transaction_clothes_trans_avg_sum_1m / NULLIF (transaction_clothes_trans_avg_sum_3m, 0) AS transaction_clothes_trans_avg_sum_1m_to_3m, 
    transaction_clothes_trans_avg_cnt_1m / NULLIF (transaction_clothes_trans_avg_cnt_3m, 0) AS transaction_clothes_trans_avg_cnt_1m_to_3m, 
    transaction_clothes_trans_avg_sum_3m / NULLIF (transaction_clothes_trans_avg_sum_6m, 0) AS transaction_clothes_trans_avg_sum_3m_to_6m, 
    transaction_clothes_trans_avg_cnt_3m / NULLIF (transaction_clothes_trans_avg_cnt_6m, 0) AS transaction_clothes_trans_avg_cnt_3m_to_6m, 
    transaction_clothes_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_clothes_trans_avg_sum_1m_to_total_1m,
    transaction_clothes_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_clothes_trans_avg_cnt_1m_to_total_1m,
    transaction_clothes_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_clothes_trans_avg_sum_3m_to_total_3m, 
    transaction_clothes_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_clothes_trans_avg_cnt_3m_to_total_3m, 
    transaction_clothes_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_clothes_trans_avg_sum_3m_to_total_6m, 
    transaction_clothes_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_clothes_trans_avg_cnt_3m_to_total_6m, 
    transaction_clothes_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_clothes_trans_avg_sum_6m_to_total_6m, 
    transaction_clothes_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_clothes_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_42 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_90 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_education_trans_cnt_1m / NULLIF (transaction_education_trans_cnt_3m, 0) AS transaction_education_trans_cnt_1m_to_3m,
    transaction_education_trans_sum_1m / NULLIF (transaction_education_trans_sum_3m, 0) AS transaction_education_trans_sum_1m_to_3m,
    transaction_education_trans_cnt_3m / NULLIF (transaction_education_trans_cnt_6m, 0) AS transaction_education_trans_cnt_3m_to_6m,
    transaction_education_trans_sum_3m / NULLIF (transaction_education_trans_sum_6m, 0) AS transaction_education_trans_sum_3m_to_6m,
    transaction_education_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_education_trans_cnt_1m_to_total_1m, 
    transaction_education_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_education_trans_sum_1m_to_total_1m, 
    transaction_education_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_education_trans_cnt_3m_to_total_3m, 
    transaction_education_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_education_trans_sum_3m_to_total_3m,
    transaction_education_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_education_trans_cnt_3m_to_total_6m, 
    transaction_education_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_education_trans_sum_3m_to_total_6m, 
    transaction_education_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_education_trans_cnt_6m_to_total_6m, 
    transaction_education_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_education_trans_sum_6m_to_total_6m, 
    transaction_education_trans_avg_sum_1m / NULLIF (transaction_education_trans_avg_sum_3m, 0) AS transaction_education_trans_avg_sum_1m_to_3m, 
    transaction_education_trans_avg_cnt_1m / NULLIF (transaction_education_trans_avg_cnt_3m, 0) AS transaction_education_trans_avg_cnt_1m_to_3m, 
    transaction_education_trans_avg_sum_3m / NULLIF (transaction_education_trans_avg_sum_6m, 0) AS transaction_education_trans_avg_sum_3m_to_6m, 
    transaction_education_trans_avg_cnt_3m / NULLIF (transaction_education_trans_avg_cnt_6m, 0) AS transaction_education_trans_avg_cnt_3m_to_6m, 
    transaction_education_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_education_trans_avg_sum_1m_to_total_1m,
    transaction_education_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_education_trans_avg_cnt_1m_to_total_1m,
    transaction_education_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_education_trans_avg_sum_3m_to_total_3m, 
    transaction_education_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_education_trans_avg_cnt_3m_to_total_3m, 
    transaction_education_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_education_trans_avg_sum_3m_to_total_6m, 
    transaction_education_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_education_trans_avg_cnt_3m_to_total_6m, 
    transaction_education_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_education_trans_avg_sum_6m_to_total_6m, 
    transaction_education_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_education_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_43 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;

execute immediate
create table EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_91 as 
select /*+parallel (8)*/ 
    p1.client_did, 
    p1.report_date,
    transaction_finance_trans_cnt_1m / NULLIF (transaction_finance_trans_cnt_3m, 0) AS transaction_finance_trans_cnt_1m_to_3m,
    transaction_finance_trans_sum_1m / NULLIF (transaction_finance_trans_sum_3m, 0) AS transaction_finance_trans_sum_1m_to_3m,
    transaction_finance_trans_cnt_3m / NULLIF (transaction_finance_trans_cnt_6m, 0) AS transaction_finance_trans_cnt_3m_to_6m,
    transaction_finance_trans_sum_3m / NULLIF (transaction_finance_trans_sum_6m, 0) AS transaction_finance_trans_sum_3m_to_6m,
    transaction_finance_trans_cnt_1m / NULLIF (transaction_total_trans_cnt_1m, 0) AS transaction_finance_trans_cnt_1m_to_total_1m, 
    transaction_finance_trans_sum_1m / NULLIF (transaction_total_trans_sum_1m, 0) AS transaction_finance_trans_sum_1m_to_total_1m, 
    transaction_finance_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_3m, 0) AS transaction_finance_trans_cnt_3m_to_total_3m, 
    transaction_finance_trans_sum_3m / NULLIF (transaction_total_trans_sum_3m, 0) AS transaction_finance_trans_sum_3m_to_total_3m,
    transaction_finance_trans_cnt_3m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_finance_trans_cnt_3m_to_total_6m, 
    transaction_finance_trans_sum_3m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_finance_trans_sum_3m_to_total_6m, 
    transaction_finance_trans_cnt_6m / NULLIF (transaction_total_trans_cnt_6m, 0) AS transaction_finance_trans_cnt_6m_to_total_6m, 
    transaction_finance_trans_sum_6m / NULLIF (transaction_total_trans_sum_6m, 0) AS transaction_finance_trans_sum_6m_to_total_6m, 
    transaction_finance_trans_avg_sum_1m / NULLIF (transaction_finance_trans_avg_sum_3m, 0) AS transaction_finance_trans_avg_sum_1m_to_3m, 
    transaction_finance_trans_avg_cnt_1m / NULLIF (transaction_finance_trans_avg_cnt_3m, 0) AS transaction_finance_trans_avg_cnt_1m_to_3m, 
    transaction_finance_trans_avg_sum_3m / NULLIF (transaction_finance_trans_avg_sum_6m, 0) AS transaction_finance_trans_avg_sum_3m_to_6m, 
    transaction_finance_trans_avg_cnt_3m / NULLIF (transaction_finance_trans_avg_cnt_6m, 0) AS transaction_finance_trans_avg_cnt_3m_to_6m, 
    transaction_finance_trans_avg_sum_1m / NULLIF (transaction_total_trans_avg_sum_1m, 0) AS transaction_finance_trans_avg_sum_1m_to_total_1m,
    transaction_finance_trans_avg_cnt_1m / NULLIF (transaction_total_trans_avg_cnt_1m, 0) AS transaction_finance_trans_avg_cnt_1m_to_total_1m,
    transaction_finance_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_3m, 0) AS transaction_finance_trans_avg_sum_3m_to_total_3m, 
    transaction_finance_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_3m, 0) AS transaction_finance_trans_avg_cnt_3m_to_total_3m, 
    transaction_finance_trans_avg_sum_3m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_finance_trans_avg_sum_3m_to_total_6m, 
    transaction_finance_trans_avg_cnt_3m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_finance_trans_avg_cnt_3m_to_total_6m, 
    transaction_finance_trans_avg_sum_6m / NULLIF (transaction_total_trans_avg_sum_6m, 0) AS transaction_finance_trans_avg_sum_6m_to_total_6m, 
    transaction_finance_trans_avg_cnt_6m / NULLIF (transaction_total_trans_avg_cnt_6m, 0) AS transaction_finance_trans_avg_cnt_6m_to_total_6m
FROM EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_44 p1 
left join EMA_COLLECT_FEAT_DM_MRK_TRANSACTION_TEMP_0 p2
    on p1.client_did = p2.client_did
    and p1.report_date = p2.report_date;
