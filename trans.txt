select /* + parallel(8) */
    a.client_did,
    a.report_date,

	auto_services_trans_max_12m,
    auto_services_trans_max_1m,
    transaction_auto_services_trans_max_3m as auto_services_trans_max_3m,
    transaction_auto_services_trans_max_6m as auto_services_trans_max_6m,
    transaction_avg_trans_prev_3m as avg_trans_prev_3m,
    transaction_cafe_trans_cnt_1m_to_total_1m as cafe_trans_count_1m_to_total_1m,
    transaction_cafe_trans_cnt_3m as cafe_trans_count_3m,
    transaction_cafe_trans_cnt_3m_to_total_3m as cafe_trans_count_3m_to_total_3m,
    transaction_cafe_trans_cnt_3m_to_total_6m as cafe_trans_count_3m_to_total_6m,
    transaction_cafe_trans_cnt_6m_to_total_6m as cafe_trans_count_6m_to_total_6m,
    transaction_cafe_trans_max_1m as cafe_trans_max_1m,
    transaction_cafe_trans_sum_12m as cafe_trans_sum_12m,
    transaction_cafe_trans_sum_1m_to_total_1m as cafe_trans_sum_1m_to_total_1m,
    transaction_cafe_trans_sum_3m_to_6m as cafe_trans_sum_3m_to_6m,
    transaction_cafe_trans_sum_6m_to_total_6m as cafe_trans_sum_6m_to_total_6m,
    transaction_courier_trans_min_6m as courier_trans_min_6m,
    transaction_days_since_first_trans as days_since_first_trans,
    transaction_days_since_last_trans as days_since_last_trans,
    transaction_flowers_trans_max_6m as flowers_trans_max_6m,
    transaction_fuel_trans_cnt_12m as fuel_trans_count_12m,
    transaction_fuel_trans_cnt_1m_to_3m as fuel_trans_count_1m_to_3m,
    transaction_fuel_trans_cnt_1m_to_total_1m as fuel_trans_count_1m_to_total_1m,
    transaction_fuel_trans_cnt_3m_to_total_6m as fuel_trans_count_3m_to_total_6m,
    transaction_fuel_trans_cnt_6m as fuel_trans_count_6m,
    transaction_fuel_trans_cnt_6m_to_total_6m as fuel_trans_count_6m_to_total_6m,
    transaction_fuel_trans_max_12m as fuel_trans_max_12m,
    transaction_fuel_trans_sum_12m as fuel_trans_sum_12m,
    transaction_fuel_trans_sum_1m_to_3m as fuel_trans_sum_1m_to_3m,
    transaction_fuel_trans_sum_1m_to_total_1m as fuel_trans_sum_1m_to_total_1m,
    transaction_fuel_trans_sum_3m_to_total_6m as fuel_trans_sum_3m_to_total_6m,
    transaction_fuel_trans_sum_6m as fuel_trans_sum_6m,
    transaction_fuel_trans_sum_6m_to_total_6m as fuel_trans_sum_6m_to_total_6m,
    transaction_hotels_trans_min_12m as hotels_trans_min_12m,
    CLIENT_SRVC_MODEL_SEGM_is_active_pack_premium_flg_1m_AVG as is_active_pack_premium_flg_1m_mean,
    transaction_medicine_trans_max_1m as medicine_trans_max_1m,
    transaction_pharmacies_trans_cnt_1m_to_total_1m as pharmacies_trans_count_1m_to_total_1m,
    transaction_pharmacies_trans_cnt_3m_to_6m as pharmacies_trans_count_3m_to_6m,
    transaction_pharmacies_trans_cnt_3m_to_total_6m as pharmacies_trans_count_3m_to_total_6m,
    transaction_pharmacies_trans_cnt_6m_to_total_6m as pharmacies_trans_count_6m_to_total_6m,
    transaction_pharmacies_trans_max_12m as pharmacies_trans_max_12m,
    transaction_pharmacies_trans_sum_1m_to_total_1m as pharmacies_trans_sum_1m_to_total_1m,
    transaction_pharmacies_trans_sum_3m as pharmacies_trans_sum_3m,
    transaction_pharmacies_trans_sum_3m_to_total_6m as pharmacies_trans_sum_3m_to_total_6m,
    transaction_pharmacies_trans_sum_6m_to_total_6m as pharmacies_trans_sum_6m_to_total_6m,
    CLIENT_SRVC_MODEL_SEGM_acc_passiv_rub_amt_1m_AVG as portf_acc_passiv_rub_amt_1m_mean,
    sal_avg_12 as sal_avg_12,
    sd_age as sd_age,
    sd_gender as sd_gender,
    transaction_sport_trans_min_12m as sport_trans_min_12m,
    transaction_supermarkets_trans_cnt_12m_to_total_12m as sup_cnt_s_365,
    transaction_supermarkets_trans_cnt_1m_to_total_1m as supermarkets_trans_count_1m_to_total_1m,
    transaction_supermarkets_trans_cnt_3m_to_total_3m as supermarkets_trans_count_3m_to_total_3m,
    transaction_supermarkets_trans_cnt_3m_to_total_6m as supermarkets_trans_count_3m_to_total_6m,
    transaction_supermarkets_trans_cnt_6m_to_total_6m as supermarkets_trans_count_6m_to_total_6m,
    transaction_supermarkets_trans_max_1m as supermarkets_trans_max_1m,
    transaction_supermarkets_trans_max_3m as supermarkets_trans_max_3m,
    transaction_supermarkets_trans_min_12m as supermarkets_trans_min_12m,
    transaction_supermarkets_trans_min_1m as supermarkets_trans_min_1m,
    transaction_supermarkets_trans_sum_1m as supermarkets_trans_sum_1m,
    transaction_supermarkets_trans_sum_6m_to_total_6m as supermarkets_trans_sum_6m_to_total_6m,
    tr_atm_sum_trans_180,
    tr_cnt_trans_1,
    tr_cnt_trans_14,
    tr_cnt_trans_180,
    tr_cnt_trans_240,
    tr_cnt_trans_30,
    tr_cnt_trans_300,
    tr_cnt_trans_365,
    tr_cnt_trans_60,
    tr_cnt_trans_7,
    tr_cnt_trans_730,
    tr_cnt_trans_90,
    tr_pos_cnt_trans_1,
    tr_pos_cnt_trans_14,
    tr_pos_cnt_trans_180,
    tr_pos_cnt_trans_240,
    tr_pos_cnt_trans_30,
    tr_pos_cnt_trans_60,
    tr_pos_cnt_trans_7,
    tr_pos_cnt_trans_90,
    tr_pos_sum_trans_1,
    tr_pos_sum_trans_180,
    tr_pos_sum_trans_240,
    tr_pos_sum_trans_30,
    tr_pos_sum_trans_60,
    tr_pos_sum_trans_7,
    tr_pos_sum_trans_90,
    tr_sum_trans_1,
    tr_sum_trans_14,
    tr_sum_trans_180,
    tr_sum_trans_30,
    tr_sum_trans_60,
    tr_sum_trans_7,
    tr_sum_trans_90,
    transaction_transport_trans_cnt_12m as transport_trans_count_12m,
    transaction_transport_trans_cnt_1m as transport_trans_count_1m,
    transaction_transport_trans_cnt_1m_to_3m as transport_trans_count_1m_to_3m,
    transaction_transport_trans_cnt_1m_to_total_1m as transport_trans_count_1m_to_total_1m,
    transaction_transport_trans_cnt_3m as transport_trans_count_3m,
    transaction_transport_trans_cnt_3m_to_total_3m as transport_trans_count_3m_to_total_3m,
    transaction_transport_trans_cnt_3m_to_total_6m as transport_trans_count_3m_to_total_6m,
    transaction_transport_trans_cnt_6m_to_total_6m as transport_trans_count_6m_to_total_6m,
    transaction_transport_trans_max_1m as transport_trans_max_1m,
    transaction_transport_trans_max_3m as transport_trans_max_3m,
    transaction_transport_trans_sum_12m as transport_trans_sum_12m,
    transaction_transport_trans_sum_1m as transport_trans_sum_1m,
    transaction_transport_trans_sum_1m_to_total_1m as transport_trans_sum_1m_to_total_1m,
    transaction_transport_trans_sum_3m as transport_trans_sum_3m,
    transaction_transport_trans_sum_3m_to_6m as transport_trans_sum_3m_to_6m,
    transaction_transport_trans_sum_3m_to_total_3m as transport_trans_sum_3m_to_total_3m,
    transaction_transport_trans_sum_3m_to_total_6m as transport_trans_sum_3m_to_total_6m,
    transaction_transport_trans_sum_6m as transport_trans_sum_6m,
    transaction_transport_trans_sum_6m_to_total_6m as transport_trans_sum_6m_to_total_6m,
    uralsib_age,
	
	transaction_dom_rem_trans_cnt_1m_to_total_1m as dom_rem_trans_count_1m_to_total_1m,
	transaction_dom_rem_trans_cnt_3m as dom_rem_trans_count_3m,
	transaction_dom_rem_trans_cnt_3m_to_total_3m as dom_rem_trans_count_3m_to_total_3m,
	transaction_dom_rem_trans_cnt_6m_to_total_6m as dom_rem_trans_count_6m_to_total_6m,
	transaction_dom_rem_trans_max_12m as dom_rem_trans_max_12m,
	transaction_dom_rem_trans_max_1m as dom_rem_trans_max_1m,
	transaction_dom_rem_trans_min_12m as dom_rem_trans_min_12m,
	transaction_dom_rem_trans_sum_12m as dom_rem_trans_sum_12m,
	transaction_dom_rem_trans_sum_1m_to_3m as dom_rem_trans_sum_1m_to_3m,
	transaction_dom_rem_trans_sum_1m_to_total_1m as dom_rem_trans_sum_1m_to_total_1m,
	transaction_dom_rem_trans_sum_3m_to_6m as dom_rem_trans_sum_3m_to_6m,
	transaction_fuel_trans_max_1m as fuel_trans_max_1m,

	transaction_supermarkets_trans_cnt_3m	as	supermarkets_flg_3m,
	transaction_transport_trans_cnt_3m	as	transport_flg_3m,
	transaction_cafe_trans_cnt_3m	as	cafe_flg_3m,
	transaction_fuel_trans_cnt_3m	as	fuel_flg_3m,
	transaction_pharmacies_trans_cnt_3m	as	pharmacies_flg_3m

from DAILY_SCORING a --EMA_MCC_MODEL_TEST_1807 a 
left join DAILY_SCORING_OUT_client_srvc_model_segm p4
	on a.client_did = p4.client_did 
    -- and a.report_date = p4.report_date
left join DAILY_SCORING_OUT_mcc_model p5
    on a.client_did = p5.client_did 
    -- and a.report_date = p5.report_date
where transaction_total_trans_cnt_3m > 0




