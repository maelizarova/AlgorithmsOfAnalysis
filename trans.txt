%%time
PRESELECTION_TOP_N = 200  # Количество предварительно отобранных фичей

target = TARGETS[0]

selected, imp, _ = select_by_importance(train[features + [target]], target, 
                                            eval_data=test[features + [target]], max_features=PRESELECTION_TOP_N)
report_n, best_n, selected, model = metric_vs_n_features(train[selected + [target]], target, 
                                                         eval_data=test[selected + [target]], imp=imp, step=10)
evaluate_model(model, train_df, test_df, oot_df, target_col, type_="cnt", avg_3m_col=None)
