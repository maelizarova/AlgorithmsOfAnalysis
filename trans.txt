from openpyxl import load_workbook

wb = load_workbook('your_file.xlsx')
ws = wb.active

current_value = None
start_row = 2

for row in range(2, ws.max_row + 1):
    if ws[f'A{row}'].value != current_value:
        if start_row != row - 1:
            ws.merge_cells(f'A{start_row}:A{row-1}')
        current_value = ws[f'A{row}'].value
        start_row = row

wb.save('merged_cells.xlsx')
