def load_embedding_results(output_dir="embedding_results"):
    all_vectors = []
    all_meta = []
    if not os.path.exists(output_dir):
        logging.warning(f"Директория {output_dir} не найдена")
        return all_vectors, all_meta

    for filename in sorted(os.listdir(output_dir)):
        if not filename.endswith('.json'):
            continue
        file_path = os.path.join(output_dir, filename)
        with open(file_path, 'r', encoding='utf-8') as f:
            payload = json.load(f)

        for row in payload.get('results', []):
            embedding = row.get('embedding')
            if embedding:
                all_vectors.append(embedding)
                all_meta.append({
                    "id": row.get('id'),
                    "original_text": row.get('original_text'),
                    "cleaned_text": row.get('cleaned_text'),
                    "embedding_dimension": row.get('embedding_dimension'),
                    "processed_at": row.get('processed_at'),
                    "source_file": filename
                })

    return all_vectors, all_meta
