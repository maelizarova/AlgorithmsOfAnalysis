import polars as pl

merged_df = pl.scan_parquet(PATH_TO_SAMPLE)

feats = [pl.scan_parquet(f) for f in feature_paths]

for feat_df in tqdm.tqdm(feats):
    # Приводим тип в правом DataFrame к типу левого
    feat_df_casted = feat_df.with_columns([
        pl.col("client_did").cast(merged_df.schema["client_did"])
    ])
    merged_df = merged_df.join(feat_df_casted, on=PRIMARY_KEY, how='left')

merged_df
