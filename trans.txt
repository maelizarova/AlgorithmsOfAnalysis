join_expressions = []

for key, config in your_dict.items():
    # Находим совпадающие строки
    matches = df[(df['proc'] == config['procedure'])]
    
    for _, row in matches.iterrows():
        suffix = config['suffix']
        part = row['online_table']
        
        if pd.notna(part):
            table_name = f"{out_table}_{suffix}_{part}"
            alias = f"{suffix}_{part}"
        else:
            table_name = f"{out_table}_{suffix}"
            alias = f"{suffix}"
        
        join_expressions.append(f"LEFT JOIN {table_name} as {alias}")

final_join_string = '\n'.join(join_expressions)
