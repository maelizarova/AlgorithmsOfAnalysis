# Проверяем, есть ли дубликаты по PRIMARY_KEY
has_duplicates = merged_df.select(
    pl.col(PRIMARY_KEY).is_duplicated().any()
).item()

if has_duplicates:
    print("Есть дубликаты по PRIMARY_KEY")
    
    # Находим колонки с различающимися значениями у дубликатов
    diff_cols = (
        merged_df
        .group_by(PRIMARY_KEY)
        .agg(pl.all().n_unique())
        .select(
            pl.exclude(PRIMARY_KEY).gt(1).any()
        )
    )
    
    res = [
        col for col, has_diff in diff_cols.row(0)
        if has_diff
    ]
    print("Колонки с различающимися значениями:", res)
else:
    print("Дубликатов нет")
