# Query: 
# ContextLines: 1

SELECT *,
    -- Отношение 1 месяц к 2 месяцам
    dom_rem_trans_count_1m / NULLIF(dom_rem_trans_count_2m, 0) AS dom_rem_trans_count_1m_to_2m,
    dom_rem_trans_sum_1m / NULLIF(dom_rem_trans_sum_2m, 0) AS dom_rem_trans_sum_1m_to_2m,
    cafe_trans_count_1m / NULLIF(cafe_trans_count_2m, 0) AS cafe_trans_count_1m_to_2m,
    cafe_trans_sum_1m / NULLIF(cafe_trans_sum_2m, 0) AS cafe_trans_sum_1m_to_2m,
    rent_auto_trans_count_1m / NULLIF(rent_auto_trans_count_2m, 0) AS rent_auto_trans_count_1m_to_2m,
    rent_auto_trans_sum_1m / NULLIF(rent_auto_trans_sum_2m, 0) AS rent_auto_trans_sum_1m_to_2m,
    transport_trans_count_1m / NULLIF(transport_trans_count_2m, 0) AS transport_trans_count_1m_to_2m,
    transport_trans_sum_1m / NULLIF(transport_trans_sum_2m, 0) AS transport_trans_sum_1m_to_2m,
    travel_trans_count_1m / NULLIF(travel_trans_count_2m, 0) AS travel_trans_count_1m_to_2m,
    travel_trans_sum_1m / NULLIF(travel_trans_sum_2m, 0) AS travel_trans_sum_1m_to_2m,
    medicine_trans_count_1m / NULLIF(medicine_trans_count_2m, 0) AS medicine_trans_count_1m_to_2m,
    medicine_trans_sum_1m / NULLIF(medicine_trans_sum_2m, 0) AS medicine_trans_sum_1m_to_2m,
    online_shops_trans_count_1m / NULLIF(online_shops_trans_count_2m, 0) AS online_shops_trans_count_1m_to_2m,
    online_shops_trans_sum_1m / NULLIF(online_shops_trans_sum_2m, 0) AS online_shops_trans_sum_1m_to_2m,
    music_trans_count_1m / NULLIF(music_trans_count_2m, 0) AS music_trans_count_1m_to_2m,
    music_trans_sum_1m / NULLIF(music_trans_sum_2m, 0) AS music_trans_sum_1m_to_2m,
    lombards_trans_count_1m / NULLIF(lombards_trans_count_2m, 0) AS lombards_trans_count_1m_to_2m,
    lombards_trans_sum_1m / NULLIF(lombards_trans_sum_2m, 0) AS lombards_trans_sum_1m_to_2m,
    zoo_trans_count_1m / NULLIF(zoo_trans_count_2m, 0) AS zoo_trans_count_1m_to_2m,
    zoo_trans_sum_1m / NULLIF(zoo_trans_sum_2m, 0) AS zoo_trans_sum_1m_to_2m,
    air_tickets_trans_count_1m / NULLIF(air_tickets_trans_count_2m, 0) AS air_tickets_trans_count_1m_to_2m,
    air_tickets_trans_sum_1m / NULLIF(air_tickets_trans_sum_2m, 0) AS air_tickets_trans_sum_1m_to_2m,
    hotels_trans_count_1m / NULLIF(hotels_trans_count_2m, 0) AS hotels_trans_count_1m_to_2m,
    hotels_trans_sum_1m / NULLIF(hotels_trans_sum_2m, 0) AS hotels_trans_sum_1m_to_2m,
    courier_trans_count_1m / NULLIF(courier_trans_count_2m, 0) AS courier_trans_count_1m_to_2m,
    courier_trans_sum_1m / NULLIF(courier_trans_sum_2m, 0) AS courier_trans_sum_1m_to_2m,
    souvenirs_trans_count_1m / NULLIF(souvenirs_trans_count_2m, 0) AS souvenirs_trans_count_1m_to_2m,
    souvenirs_trans_sum_1m / NULLIF(souvenirs_trans_sum_2m, 0) AS souvenirs_trans_sum_1m_to_2m,
    card_transfer_trans_count_1m / NULLIF(card_transfer_trans_count_2m, 0) AS card_transfer_trans_count_1m_to_2m,
    card_transfer_trans_sum_1m / NULLIF(card_transfer_trans_sum_2m, 0) AS card_transfer_trans_sum_1m_to_2m,
    entertainment_trans_count_1m / NULLIF(entertainment_trans_count_2m, 0) AS entertainment_trans_count_1m_to_2m,
    entertainment_trans_sum_1m / NULLIF(entertainment_trans_sum_2m, 0) AS entertainment_trans_sum_1m_to_2m,
    taxes_fines_trans_count_1m / NULLIF(taxes_fines_trans_count_2m, 0) AS taxes_fines_trans_count_1m_to_2m,
    taxes_fines_trans_sum_1m / NULLIF(taxes_fines_trans_sum_2m, 0) AS taxes_fines_trans_sum_1m_to_2m,
    supermarkets_trans_count_1m / NULLIF(supermarkets_trans_count_2m, 0) AS supermarkets_trans_count_1m_to_2m,
    supermarkets_trans_sum_1m / NULLIF(supermarkets_trans_sum_2m, 0) AS supermarkets_trans_sum_1m_to_2m,
    sport_goods_trans_count_1m / NULLIF(sport_goods_trans_count_2m, 0) AS sport_goods_trans_count_1m_to_2m,
    sport_goods_trans_sum_1m / NULLIF(sport_goods_trans_sum_2m, 0) AS sport_goods_trans_sum_1m_to_2m,
    sber_services_trans_count_1m / NULLIF(sber_services_trans_count_2m, 0) AS sber_services_trans_count_1m_to_2m,
    sber_services_trans_sum_1m / NULLIF(sber_services_trans_sum_2m, 0) AS sber_services_trans_sum_1m_to_2m,
    gov_services_trans_count_1m / NULLIF(gov_services_trans_count_2m, 0) AS gov_services_trans_count_1m_to_2m,
    gov_services_trans_sum_1m / NULLIF(gov_services_trans_sum_2m, 0) AS gov_services_trans_sum_1m_to_2m,
    art_trans_count_1m / NULLIF(art_trans_count_2m, 0) AS art_trans_count_1m_to_2m,
    art_trans_sum_1m / NULLIF(art_trans_sum_2m, 0) AS art_trans_sum_1m_to_2m,
    pharmacies_trans_count_1m / NULLIF(pharmacies_trans_count_2m, 0) AS pharmacies_trans_count_1m_to_2m,
    pharmacies_trans_sum_1m / NULLIF(pharmacies_trans_sum_2m, 0) AS pharmacies_trans_sum_1m_to_2m,
    flowers_trans_count_1m / NULLIF(flowers_trans_count_2m, 0) AS flowers_trans_count_1m_to_2m,
    flowers_trans_sum_1m / NULLIF(flowers_trans_sum_2m, 0) AS flowers_trans_sum_1m_to_2m,
    train_tickets_trans_count_1m / NULLIF(train_tickets_trans_count_2m, 0) AS train_tickets_trans_count_1m_to_2m,
    train_tickets_trans_sum_1m / NULLIF(train_tickets_trans_sum_2m, 0) AS train_tickets_trans_sum_1m_to_2m,
    gambling_trans_count_1m / NULLIF(gambling_trans_count_2m, 0) AS gambling_trans_count_1m_to_2m,
    gambling_trans_sum_1m / NULLIF(gambling_trans_sum_2m, 0) AS gambling_trans_sum_1m_to_2m,
    digital_goods_trans_count_1m / NULLIF(digital_goods_trans_count_2m, 0) AS digital_goods_trans_count_1m_to_2m,
    digital_goods_trans_sum_1m / NULLIF(digital_goods_trans_sum_2m, 0) AS digital_goods_trans_sum_1m_to_2m,
    books_trans_count_1m / NULLIF(books_trans_count_2m, 0) AS books_trans_count_1m_to_2m,
    books_trans_sum_1m / NULLIF(books_trans_sum_2m, 0) AS books_trans_sum_1m_to_2m,
    fuel_trans_count_1m / NULLIF(fuel_trans_count_2m, 0) AS fuel_trans_count_1m_to_2m,
    fuel_trans_sum_1m / NULLIF(fuel_trans_sum_2m, 0) AS fuel_trans_sum_1m_to_2m,
    yandex_services_trans_count_1m / NULLIF(yandex_services_trans_count_2m, 0) AS yandex_services_trans_count_1m_to_2m,
    yandex_services_trans_sum_1m / NULLIF(yandex_services_trans_sum_2m, 0) AS yandex_services_trans_sum_1m_to_2m,
    beauty_trans_count_1m / NULLIF(beauty_trans_count_2m, 0) AS beauty_trans_count_1m_to_2m,
    beauty_trans_sum_1m / NULLIF(beauty_trans_sum_2m, 0) AS beauty_trans_sum_1m_to_2m,
    cinema_trans_count_1m / NULLIF(cinema_trans_count_2m, 0) AS cinema_trans_count_1m_to_2m,
    cinema_trans_sum_1m / NULLIF(cinema_trans_sum_2m, 0) AS cinema_trans_sum_1m_to_2m,
    charity_trans_count_1m / NULLIF(charity_trans_count_2m, 0) AS charity_trans_count_1m_to_2m,
    charity_trans_sum_1m / NULLIF(charity_trans_sum_2m, 0) AS charity_trans_sum_1m_to_2m,
    money_transfers_trans_count_1m / NULLIF(money_transfers_trans_count_2m, 0) AS money_transfers_trans_count_1m_to_2m,
    money_transfers_trans_sum_1m / NULLIF(money_transfers_trans_sum_2m, 0) AS money_transfers_trans_sum_1m_to_2m,
    auto_services_trans_count_1m / NULLIF(auto_services_trans_count_2m, 0) AS auto_services_trans_count_1m_to_2m,
    auto_services_trans_sum_1m / NULLIF(auto_services_trans_sum_2m, 0) AS auto_services_trans_sum_1m_to_2m,
    services_consulting_trans_count_1m / NULLIF(services_consulting_trans_count_2m, 0) AS services_consulting_trans_count_1m_to_2m,
    services_consulting_trans_sum_1m / NULLIF(services_consulting_trans_sum_2m, 0) AS services_consulting_trans_sum_1m_to_2m,
    cash_withdrawal_trans_count_1m / NULLIF(cash_withdrawal_trans_count_2m, 0) AS cash_withdrawal_trans_count_1m_to_2m,
    cash_withdrawal_trans_sum_1m / NULLIF(cash_withdrawal_trans_sum_2m, 0) AS cash_withdrawal_trans_sum_1m_to_2m,
    other_expenses_trans_count_1m / NULLIF(other_expenses_trans_count_2m, 0) AS other_expenses_trans_count_1m_to_2m,
    other_expenses_trans_sum_1m / NULLIF(other_expenses_trans_sum_2m, 0) AS other_expenses_trans_sum_1m_to_2m,
    utilities_communication_trans_count_1m / NULLIF(utilities_communication_trans_count_2m, 0) AS utilities_communication_trans_count_1m_to_2m,
    utilities_communication_trans_sum_1m / NULLIF(utilities_communication_trans_sum_2m, 0) AS utilities_communication_trans_sum_1m_to_2m,
    electronics_trans_count_1m / NULLIF(electronics_trans_count_2m, 0) AS electronics_trans_count_1m_to_2m,
    electronics_trans_sum_1m / NULLIF(electronics_trans_sum_2m, 0) AS electronics_trans_sum_1m_to_2m,
    jewelry_trans_count_1m / NULLIF(jewelry_trans_count_2m, 0) AS jewelry_trans_count_1m_to_2m,
    jewelry_trans_sum_1m / NULLIF(jewelry_trans_sum_2m, 0) AS jewelry_trans_sum_1m_to_2m,
    clothing_shoes_trans_count_1m / NULLIF(clothing_shoes_trans_count_2m, 0) AS clothing_shoes_trans_count_1m_to_2m,
    clothing_shoes_trans_sum_1m / NULLIF(clothing_shoes_trans_sum_2m, 0) AS clothing_shoes_trans_sum_1m_to_2m,
    education_trans_count_1m / NULLIF(education_trans_count_2m, 0) AS education_trans_count_1m_to_2m,
    education_trans_sum_1m / NULLIF(education_trans_sum_2m, 0) AS education_trans_sum_1m_to_2m,
    finance_trans_count_1m / NULLIF(finance_trans_count_2m, 0) AS finance_trans_count_1m_to_2m,
    finance_trans_sum_1m / NULLIF(finance_trans_sum_2m, 0) AS finance_trans_sum_1m_to_2m,

    -- Отношение 2 месяца к 4 месяцам
    dom_rem_trans_count_2m / NULLIF(dom_rem_trans_count_4m, 0) AS dom_rem_trans_count_2m_to_4m,
    dom_rem_trans_sum_2m / NULLIF(dom_rem_trans_sum_4m, 0) AS dom_rem_trans_sum_2m_to_4m,
    cafe_trans_count_2m / NULLIF(cafe_trans_count_4m, 0) AS cafe_trans_count_2m_to_4m,
    cafe_trans_sum_2m / NULLIF(cafe_trans_sum_4m, 0) AS cafe_trans_sum_2m_to_4m,
    rent_auto_trans_count_2m / NULLIF(rent_auto_trans_count_4m, 0) AS rent_auto_trans_count_2m_to_4m,
    rent_auto_trans_sum_2m / NULLIF(rent_auto_trans_sum_4m, 0) AS rent_auto_trans_sum_2m_to_4m,
    transport_trans_count_2m / NULLIF(transport_trans_count_4m, 0) AS transport_trans_count_2m_to_4m,
    transport_trans_sum_2m / NULLIF(transport_trans_sum_4m, 0) AS transport_trans_sum_2m_to_4m,
    travel_trans_count_2m / NULLIF(travel_trans_count_4m, 0) AS travel_trans_count_2m_to_4m,
    travel_trans_sum_2m / NULLIF(travel_trans_sum_4m, 0) AS travel_trans_sum_2m_to_4m,
    medicine_trans_count_2m / NULLIF(medicine_trans_count_4m, 0) AS medicine_trans_count_2m_to_4m,
    medicine_trans_sum_2m / NULLIF(medicine_trans_sum_4m, 0) AS medicine_trans_sum_2m_to_4m,
    online_shops_trans_count_2m / NULLIF(online_shops_trans_count_4m, 0) AS online_shops_trans_count_2m_to_4m,
    online_shops_trans_sum_2m / NULLIF(online_shops_trans_sum_4m, 0) AS online_shops_trans_sum_2m_to_4m,
    music_trans_count_2m / NULLIF(music_trans_count_4m, 0) AS music_trans_count_2m_to_4m,
    music_trans_sum_2m / NULLIF(music_trans_sum_4m, 0) AS music_trans_sum_2m_to_4m,
    lombards_trans_count_2m / NULLIF(lombards_trans_count_4m, 0) AS lombards_trans_count_2m_to_4m,
    lombards_trans_sum_2m / NULLIF(lombards_trans_sum_4m, 0) AS lombards_trans_sum_2m_to_4m,
    zoo_trans_count_2m / NULLIF(zoo_trans_count_4m, 0) AS zoo_trans_count_2m_to_4m,
    zoo_trans_sum_2m / NULLIF(zoo_trans_sum_4m, 0) AS zoo_trans_sum_2m_to_4m,
    air_tickets_trans_count_2m / NULLIF(air_tickets_trans_count_4m, 0) AS air_tickets_trans_count_2m_to_4m,
    air_tickets_trans_sum_2m / NULLIF(air_tickets_trans_sum_4m, 0) AS air_tickets_trans_sum_2m_to_4m,
    hotels_trans_count_2m / NULLIF(hotels_trans_count_4m, 0) AS hotels_trans_count_2m_to_4m,
    hotels_trans_sum_2m / NULLIF(hotels_trans_sum_4m, 0) AS hotels_trans_sum_2m_to_4m,
    courier_trans_count_2m / NULLIF(courier_trans_count_4m, 0) AS courier_trans_count_2m_to_4m,
    courier_trans_sum_2m / NULLIF(courier_trans_sum_4m, 0) AS courier_trans_sum_2m_to_4m,
    souvenirs_trans_count_2m / NULLIF(souvenirs_trans_count_4m, 0) AS souvenirs_trans_count_2m_to_4m,
    souvenirs_trans_sum_2m / NULLIF(souvenirs_trans_sum_4m, 0) AS souvenirs_trans_sum_2m_to_4m,
    card_transfer_trans_count_2m / NULLIF(card_transfer_trans_count_4m, 0) AS card_transfer_trans_count_2m_to_4m,
    card_transfer_trans_sum_2m / NULLIF(card_transfer_trans_sum_4m, 0) AS card_transfer_trans_sum_2m_to_4m,
    entertainment_trans_count_2m / NULLIF(entertainment_trans_count_4m, 0) AS entertainment_trans_count_2m_to_4m,
    entertainment_trans_sum_2m / NULLIF(entertainment_trans_sum_4m, 0) AS entertainment_trans_sum_2m_to_4m,
    taxes_fines_trans_count_2m / NULLIF(taxes_fines_trans_count_4m, 0) AS taxes_fines_trans_count_2m_to_4m,
    taxes_fines_trans_sum_2m / NULLIF(taxes_fines_trans_sum_4m, 0) AS taxes_fines_trans_sum_2m_to_4m,
    supermarkets_trans_count_2m / NULLIF(supermarkets_trans_count_4m, 0) AS supermarkets_trans_count_2m_to_4m,
    supermarkets_trans_sum_2m / NULLIF(supermarkets_trans_sum_4m, 0) AS supermarkets_trans_sum_2m_to_4m,
    sport_goods_trans_count_2m / NULLIF(sport_goods_trans_count_4m, 0) AS sport_goods_trans_count_2m_to_4m,
    sport_goods_trans_sum_2m / NULLIF(sport_goods_trans_sum_4m, 0) AS sport_goods_trans_sum_2m_to_4m,
    sber_services_trans_count_2m / NULLIF(sber_services_trans_count_4m, 0) AS sber_services_trans_count_2m_to_4m,
    sber_services_trans_sum_2m / NULLIF(sber_services_trans_sum_4m, 0) AS sber_services_trans_sum_2m_to_4m,
    gov_services_trans_count_2m / NULLIF(gov_services_trans_count_4m, 0) AS gov_services_trans_count_2m_to_4m,
    gov_services_trans_sum_2m / NULLIF(gov_services_trans_sum_4m, 0) AS gov_services_trans_sum_2m_to_4m,
    art_trans_count_2m / NULLIF(art_trans_count_4m, 0) AS art_trans_count_2m_to_4m,
    art_trans_sum_2m / NULLIF(art_trans_sum_4m, 0) AS art_trans_sum_2m_to_4m,
    pharmacies_trans_count_2m / NULLIF(pharmacies_trans_count_4m, 0) AS pharmacies_trans_count_2m_to_4m,
    pharmacies_trans_sum_2m / NULLIF(pharmacies_trans_sum_4m, 0) AS pharmacies_trans_sum_2m_to_4m,
    flowers_trans_count_2m / NULLIF(flowers_trans_count_4m, 0) AS flowers_trans_count_2m_to_4m,
    flowers_trans_sum_2m / NULLIF(flowers_trans_sum_4m, 0) AS flowers_trans_sum_2m_to_4m,
    train_tickets_trans_count_2m / NULLIF(train_tickets_trans_count_4m, 0) AS train_tickets_trans_count_2m_to_4m,
    train_tickets_trans_sum_2m / NULLIF(train_tickets_trans_sum_4m, 0) AS train_tickets_trans_sum_2m_to_4m,
    gambling_trans_count_2m / NULLIF(gambling_trans_count_4m, 0) AS gambling_trans_count_2m_to_4m,
    gambling_trans_sum_2m / NULLIF(gambling_trans_sum_4m, 0) AS gambling_trans_sum_2m_to_4m,
    digital_goods_trans_count_2m / NULLIF(digital_goods_trans_count_4m, 0) AS digital_goods_trans_count_2m_to_4m,
    digital_goods_trans_sum_2m / NULLIF(digital_goods_trans_sum_4m, 0) AS digital_goods_trans_sum_2m_to_4m,
    books_trans_count_2m / NULLIF(books_trans_count_4m, 0) AS books_trans_count_2m_to_4m,
    books_trans_sum_2m / NULLIF(books_trans_sum_4m, 0) AS books_trans_sum_2m_to_4m,
    fuel_trans_count_2m / NULLIF(fuel_trans_count_4m, 0) AS fuel_trans_count_2m_to_4m,
    fuel_trans_sum_2m / NULLIF(fuel_trans_sum_4m, 0) AS fuel_trans_sum_2m_to_4m,
    yandex_services_trans_count_2m / NULLIF(yandex_services_trans_count_4m, 0) AS yandex_services_trans_count_2m_to_4m,
    yandex_services_trans_sum_2m / NULLIF(yandex_services_trans_sum_4m, 0) AS yandex_services_trans_sum_2m_to_4m,
    beauty_trans_count_2m / NULLIF(beauty_trans_count_4m, 0) AS beauty_trans_count_2m_to_4m,
    beauty_trans_sum_2m / NULLIF(beauty_trans_sum_4m, 0) AS beauty_trans_sum_2m_to_4m,
    cinema_trans_count_2m / NULLIF(cinema_trans_count_4m, 0) AS cinema_trans_count_2m_to_4m,
    cinema_trans_sum_2m / NULLIF(cinema_trans_sum_4m, 0) AS cinema_trans_sum_2m_to_4m,
    charity_trans_count_2m / NULLIF(charity_trans_count_4m, 0) AS charity_trans_count_2m_to_4m,
    charity_trans_sum_2m / NULLIF(charity_trans_sum_4m, 0) AS charity_trans_sum_2m_to_4m,
    money_transfers_trans_count_2m / NULLIF(money_transfers_trans_count_4m, 0) AS money_transfers_trans_count_2m_to_4m,
    money_transfers_trans_sum_2m / NULLIF(money_transfers_trans_sum_4m, 0) AS money_transfers_trans_sum_2m_to_4m,
    auto_services_trans_count_2m / NULLIF(auto_services_trans_count_4m, 0) AS auto_services_trans_count_2m_to_4m,
    auto_services_trans_sum_2m / NULLIF(auto_services_trans_sum_4m, 0) AS auto_services_trans_sum_2m_to_4m,
    services_consulting_trans_count_2m / NULLIF(services_consulting_trans_count_4m, 0) AS services_consulting_trans_count_2m_to_4m,
    services_consulting_trans_sum_2m / NULLIF(services_consulting_trans_sum_4m, 0) AS services_consulting_trans_sum_2m_to_4m,
    cash_withdrawal_trans_count_2m / NULLIF(cash_withdrawal_trans_count_4m, 0) AS cash_withdrawal_trans_count_2m_to_4m,
    cash_withdrawal_trans_sum_2m / NULLIF(cash_withdrawal_trans_sum_4m, 0) AS cash_withdrawal_trans_sum_2m_to_4m,
    other_expenses_trans_count_2m / NULLIF(other_expenses_trans_count_4m, 0) AS other_expenses_trans_count_2m_to_4m,
    other_expenses_trans_sum_2m / NULLIF(other_expenses_trans_sum_4m, 0) AS other_expenses_trans_sum_2m_to_4m,
    utilities_communication_trans_count_2m / NULLIF(utilities_communication_trans_count_4m, 0) AS utilities_communication_trans_count_2m_to_4m,
    utilities_communication_trans_sum_2m / NULLIF(utilities_communication_trans_sum_4m, 0) AS utilities_communication_trans_sum_2m_to_4m,
    electronics_trans_count_2m / NULLIF(electronics_trans_count_4m, 0) AS electronics_trans_count_2m_to_4m,
    electronics_trans_sum_2m / NULLIF(electronics_trans_sum_4m, 0) AS electronics_trans_sum_2m_to_4m,
    jewelry_trans_count_2m / NULLIF(jewelry_trans_count_4m, 0) AS jewelry_trans_count_2m_to_4m,
    jewelry_trans_sum_2m / NULLIF(jewelry_trans_sum_4m, 0) AS jewelry_trans_sum_2m_to_4m,
    clothing_shoes_trans_count_2m / NULLIF(clothing_shoes_trans_count_4m, 0) AS clothing_shoes_trans_count_2m_to_4m,
    clothing_shoes_trans_sum_2m / NULLIF(clothing_shoes_trans_sum_4m, 0) AS clothing_shoes_trans_sum_2m_to_4m,
    education_trans_count_2m / NULLIF(education_trans_count_4m, 0) AS education_trans_count_2m_to_4m,
    education_trans_sum_2m / NULLIF(education_trans_sum_4m, 0) AS education_trans_sum_2m_to_4m,
    finance_trans_count_2m / NULLIF(finance_trans_count_4m, 0) AS finance_trans_count_2m_to_4m,
    finance_trans_sum_2m / NULLIF(finance_trans_sum_4m, 0) AS finance_trans_sum_2m_to_4m,

    -- Отношение 2 месяца к 6 месяцам
    dom_rem_trans_count_2m / NULLIF(dom_rem_trans_count_6m, 0) AS dom_rem_trans_count_2m_to_6m,
    dom_rem_trans_sum_2m / NULLIF(dom_rem_trans_sum_6m, 0) AS dom_rem_trans_sum_2m_to_6m,
    cafe_trans_count_2m / NULLIF(cafe_trans_count_6m, 0) AS cafe_trans_count_2m_to_6m,
    cafe_trans_sum_2m / NULLIF(cafe_trans_sum_6m, 0) AS cafe_trans_sum_2m_to_6m,
    rent_auto_trans_count_2m / NULLIF(rent_auto_trans_count_6m, 0) AS rent_auto_trans_count_2m_to_6m,
    rent_auto_trans_sum_2m / NULLIF(rent_auto_trans_sum_6m, 0) AS rent_auto_trans_sum_2m_to_6m,
    transport_trans_count_2m / NULLIF(transport_trans_count_6m, 0) AS transport_trans_count_2m_to_6m,
    transport_trans_sum_2m / NULLIF(transport_trans_sum_6m, 0) AS transport_trans_sum_2m_to_6m,
    travel_trans_count_2m / NULLIF(travel_trans_count_6m, 0) AS travel_trans_count_2m_to_6m,
    travel_trans_sum_2m / NULLIF(travel_trans_sum_6m, 0) AS travel_trans_sum_2m_to_6m,
    medicine_trans_count_2m / NULLIF(medicine_trans_count_6m, 0) AS medicine_trans_count_2m_to_6m,
    medicine_trans_sum_2m / NULLIF(medicine_trans_sum_6m, 0) AS medicine_trans_sum_2m_to_6m,
    online_shops_trans_count_2m / NULLIF(online_shops_trans_count_6m, 0) AS online_shops_trans_count_2m_to_6m,
    online_shops_trans_sum_2m / NULLIF(online_shops_trans_sum_6m, 0) AS online_shops_trans_sum_2m_to_6m,
    music_trans_count_2m / NULLIF(music_trans_count_6m, 0) AS music_trans_count_2m_to_6m,
    music_trans_sum_2m / NULLIF(music_trans_sum_6m, 0) AS music_trans_sum_2m_to_6m,
    lombards_trans_count_2m / NULLIF(lombards_trans_count_6m, 0) AS lombards_trans_count_2m_to_6m,
    lombards_trans_sum_2m / NULLIF(lombards_trans_sum_6m, 0) AS lombards_trans_sum_2m_to_6m,
    zoo_trans_count_2m / NULLIF(zoo_trans_count_6m, 0) AS zoo_trans_count_2m_to_6m,
    zoo_trans_sum_2m / NULLIF(zoo_trans_sum_6m, 0) AS zoo_trans_sum_2m_to_6m,
    air_tickets_trans_count_2m / NULLIF(air_tickets_trans_count_6m, 0) AS air_tickets_trans_count_2m_to_6m,
    air_tickets_trans_sum_2m / NULLIF(air_tickets_trans_sum_6m, 0) AS air_tickets_trans_sum_2m_to_6m,
    hotels_trans_count_2m / NULLIF(hotels_trans_count_6m, 0) AS hotels_trans_count_2m_to_6m,
    hotels_trans_sum_2m / NULLIF(hotels_trans_sum_6m, 0) AS hotels_trans_sum_2m_to_6m,
    courier_trans_count_2m / NULLIF(courier_trans_count_6m, 0) AS courier_trans_count_2m_to_6m,
    courier_trans_sum_2m / NULLIF(courier_trans_sum_6m, 0) AS courier_trans_sum_2m_to_6m,
    souvenirs_trans_count_2m / NULLIF(souvenirs_trans_count_6m, 0) AS souvenirs_trans_count_2m_to_6m,
    souvenirs_trans_sum_2m / NULLIF(souvenirs_trans_sum_6m, 0) AS souvenirs_trans_sum_2m_to_6m,
    card_transfer_trans_count_2m / NULLIF(card_transfer_trans_count_6m, 0) AS card_transfer_trans_count_2m_to_6m,
    card_transfer_trans_sum_2m / NULLIF(card_transfer_trans_sum_6m, 0) AS card_transfer_trans_sum_2m_to_6m,
    entertainment_trans_count_2m / NULLIF(entertainment_trans_count_6m, 0) AS entertainment_trans_count_2m_to_6m,
    entertainment_trans_sum_2m / NULLIF(entertainment_trans_sum_6m, 0) AS entertainment_trans_sum_2m_to_6m,
    taxes_fines_trans_count_2m / NULLIF(taxes_fines_trans_count_6m, 0) AS taxes_fines_trans_count_2m_to_6m,
    taxes_fines_trans_sum_2m / NULLIF(taxes_fines_trans_sum_6m, 0) AS taxes_fines_trans_sum_2m_to_6m,
    supermarkets_trans_count_2m / NULLIF(supermarkets_trans_count_6m, 0) AS supermarkets_trans_count_2m_to_6m,
    supermarkets_trans_sum_2m / NULLIF(supermarkets_trans_sum_6m, 0) AS supermarkets_trans_sum_2m_to_6m,
    sport_goods_trans_count_2m / NULLIF(sport_goods_trans_count_6m, 0) AS sport_goods_trans_count_2m_to_6m,
    sport_goods_trans_sum_2m / NULLIF(sport_goods_trans_sum_6m, 0) AS sport_goods_trans_sum_2m_to_6m,
    sber_services_trans_count_2m / NULLIF(sber_services_trans_count_6m, 0) AS sber_services_trans_count_2m_to_6m,
    sber_services_trans_sum_2m / NULLIF(sber_services_trans_sum_6m, 0) AS sber_services_trans_sum_2m_to_6m,
    gov_services_trans_count_2m / NULLIF(gov_services_trans_count_6m, 0) AS gov_services_trans_count_2m_to_6m,
    gov_services_trans_sum_2m / NULLIF(gov_services_trans_sum_6m, 0) AS gov_services_trans_sum_2m_to_6m,
    art_trans_count_2m / NULLIF(art_trans_count_6m, 0) AS art_trans_count_2m_to_6m,
    art_trans_sum_2m / NULLIF(art_trans_sum_6m, 0) AS art_trans_sum_2m_to_6m,
    pharmacies_trans_count_2m / NULLIF(pharmacies_trans_count_6m, 0) AS pharmacies_trans_count_2m_to_6m,
    pharmacies_trans_sum_2m / NULLIF(pharmacies_trans_sum_6m, 0) AS pharmacies_trans_sum_2m_to_6m,
    flowers_trans_count_2m / NULLIF(flowers_trans_count_6m, 0) AS flowers_trans_count_2m_to_6m,
    flowers_trans_sum_2m / NULLIF(flowers_trans_sum_6m, 0) AS flowers_trans_sum_2m_to_6m,
    train_tickets_trans_count_2m / NULLIF(train_tickets_trans_count_6m, 0) AS train_tickets_trans_count_2m_to_6m,
    train_tickets_trans_sum_2m / NULLIF(train_tickets_trans_sum_6m, 0) AS train_tickets_trans_sum_2m_to_6m,
    gambling_trans_count_2m / NULLIF(gambling_trans_count_6m, 0) AS gambling_trans_count_2m_to_6m,
    gambling_trans_sum_2m / NULLIF(gambling_trans_sum_6m, 0) AS gambling_trans_sum_2m_to_6m,
    digital_goods_trans_count_2m / NULLIF(digital_goods_trans_count_6m, 0) AS digital_goods_trans_count_2m_to_6m,
    digital_goods_trans_sum_2m / NULLIF(digital_goods_trans_sum_6m, 0) AS digital_goods_trans_sum_2m_to_6m,
    books_trans_count_2m / NULLIF(books_trans_count_6m, 0) AS books_trans_count_2m_to_6m,
    books_trans_sum_2m / NULLIF(books_trans_sum_6m, 0) AS books_trans_sum_2m_to_6m,
    fuel_trans_count_2m / NULLIF(fuel_trans_count_6m, 0) AS fuel_trans_count_2m_to_6m,
    fuel_trans_sum_2m / NULLIF(fuel_trans_sum_6m, 0) AS fuel_trans_sum_2m_to_6m,
    yandex_services_trans_count_2m / NULLIF(yandex_services_trans_count_6m, 0) AS yandex_services_trans_count_2m_to_6m,
    yandex_services_trans_sum_2m / NULLIF(yandex_services_trans_sum_6m, 0) AS yandex_services_trans_sum_2m_to_6m,
    beauty_trans_count_2m / NULLIF(beauty_trans_count_6m, 0) AS beauty_trans_count_2m_to_6m,
    beauty_trans_sum_2m / NULLIF(beauty_trans_sum_6m, 0) AS beauty_trans_sum_2m_to_6m,
    cinema_trans_count_2m / NULLIF(cinema_trans_count_6m, 0) AS cinema_trans_count_2m_to_6m,
    cinema_trans_sum_2m / NULLIF(cinema_trans_sum_6m, 0) AS cinema_trans_sum_2m_to_6m,
    charity_trans_count_2m / NULLIF(charity_trans_count_6m, 0) AS charity_trans_count_2m_to_6m,
    charity_trans_sum_2m / NULLIF(charity_trans_sum_6m, 0) AS charity_trans_sum_2m_to_6m,
    money_transfers_trans_count_2m / NULLIF(money_transfers_trans_count_6m, 0) AS money_transfers_trans_count_2m_to_6m,
    money_transfers_trans_sum_2m / NULLIF(money_transfers_trans_sum_6m, 0) AS money_transfers_trans_sum_2m_to_6m,
    auto_services_trans_count_2m / NULLIF(auto_services_trans_count_6m, 0) AS auto_services_trans_count_2m_to_6m,
    auto_services_trans_sum_2m / NULLIF(auto_services_trans_sum_6m, 0) AS auto_services_trans_sum_2m_to_6m,
    services_consulting_trans_count_2m / NULLIF(services_consulting_trans_count_6m, 0) AS services_consulting_trans_count_2m_to_6m,
    services_consulting_trans_sum_2m / NULLIF(services_consulting_trans_sum_6m, 0) AS services_consulting_trans_sum_2m_to_6m,
    cash_withdrawal_trans_count_2m / NULLIF(cash_withdrawal_trans_count_6m, 0) AS cash_withdrawal_trans_count_2m_to_6m,
    cash_withdrawal_trans_sum_2m / NULLIF(cash_withdrawal_trans_sum_6m, 0) AS cash_withdrawal_trans_sum_2m_to_6m,
    other_expenses_trans_count_2m / NULLIF(other_expenses_trans_count_6m, 0) AS other_expenses_trans_count_2m_to_6m,
    other_expenses_trans_sum_2m / NULLIF(other_expenses_trans_sum_6m, 0) AS other_expenses_trans_sum_2m_to_6m,
    utilities_communication_trans_count_2m / NULLIF(utilities_communication_trans_count_6m, 0) AS utilities_communication_trans_count_2m_to_6m,
    utilities_communication_trans_sum_2m / NULLIF(utilities_communication_trans_sum_6m, 0) AS utilities_communication_trans_sum_2m_to_6m,
    electronics_trans_count_2m / NULLIF(electronics_trans_count_6m, 0) AS electronics_trans_count_2m_to_6m,
    electronics_trans_sum_2m / NULLIF(electronics_trans_sum_6m, 0) AS electronics_trans_sum_2m_to_6m,
    jewelry_trans_count_2m / NULLIF(jewelry_trans_count_6m, 0) AS jewelry_trans_count_2m_to_6m,
    jewelry_trans_sum_2m / NULLIF(jewelry_trans_sum_6m, 0) AS jewelry_trans_sum_2m_to_6m,
    clothing_shoes_trans_count_2m / NULLIF(clothing_shoes_trans_count_6m, 0) AS clothing_shoes_trans_count_2m_to_6m,
    clothing_shoes_trans_sum_2m / NULLIF(clothing_shoes_trans_sum_6m, 0) AS clothing_shoes_trans_sum_2m_to_6m,
    education_trans_count_2m / NULLIF(education_trans_count_6m, 0) AS education_trans_count_2m_to_6m,
    education_trans_sum_2m / NULLIF(education_trans_sum_6m, 0) AS education_trans_sum_2m_to_6m,
    finance_trans_count_2m / NULLIF(finance_trans_count_6m, 0) AS finance_trans_count_2m_to_6m,
    finance_trans_sum_2m / NULLIF(finance_trans_sum_6m, 0) AS finance_trans_sum_2m_to_6m,

    -- Отношение 3 месяца к 12 месяцам
    dom_rem_trans_count_3m / NULLIF(dom_rem_trans_count_12m, 0) AS dom_rem_trans_count_3m_to_12m,
    dom_rem_trans_sum_3m / NULLIF(dom_rem_trans_sum_12m, 0) AS dom_rem_trans_sum_3m_to_12m,
    cafe_trans_count_3m / NULLIF(cafe_trans_count_12m, 0) AS cafe_trans_count_3m_to_12m,
    cafe_trans_sum_3m / NULLIF(cafe_trans_sum_12m, 0) AS cafe_trans_sum_3m_to_12m,
    rent_auto_trans_count_3m / NULLIF(rent_auto_trans_count_12m, 0) AS rent_auto_trans_count_3m_to_12m,
    rent_auto_trans_sum_3m / NULLIF(rent_auto_trans_sum_12m, 0) AS rent_auto_trans_sum_3m_to_12m,
    transport_trans_count_3m / NULLIF(transport_trans_count_12m, 0) AS transport_trans_count_3m_to_12m,
    transport_trans_sum_3m / NULLIF(transport_trans_sum_12m, 0) AS transport_trans_sum_3m_to_12m,
    travel_trans_count_3m / NULLIF(travel_trans_count_12m, 0) AS travel_trans_count_3m_to_12m,
    travel_trans_sum_3m / NULLIF(travel_trans_sum_12m, 0) AS travel_trans_sum_3m_to_12m,
    medicine_trans_count_3m / NULLIF(medicine_trans_count_12m, 0) AS medicine_trans_count_3m_to_12m,
    medicine_trans_sum_3m / NULLIF(medicine_trans_sum_12m, 0) AS medicine_trans_sum_3m_to_12m,
    online_shops_trans_count_3m / NULLIF(online_shops_trans_count_12m, 0) AS online_shops_trans_count_3m_to_12m,
    online_shops_trans_sum_3m / NULLIF(online_shops_trans_sum_12m, 0) AS online_shops_trans_sum_3m_to_12m,
    music_trans_count_3m / NULLIF(music_trans_count_12m, 0) AS music_trans_count_3m_to_12m,
    music_trans_sum_3m / NULLIF(music_trans_sum_12m, 0) AS music_trans_sum_3m_to_12m,
    lombards_trans_count_3m / NULLIF(lombards_trans_count_12m, 0) AS lombards_trans_count_3m_to_12m,
    lombards_trans_sum_3m / NULLIF(lombards_trans_sum_12m, 0) AS lombards_trans_sum_3m_to_12m,
    zoo_trans_count_3m / NULLIF(zoo_trans_count_12m, 0) AS zoo_trans_count_3m_to_12m,
    zoo_trans_sum_3m / NULLIF(zoo_trans_sum_12m, 0) AS zoo_trans_sum_3m_to_12m,
    air_tickets_trans_count_3m / NULLIF(air_tickets_trans_count_12m, 0) AS air_tickets_trans_count_3m_to_12m,
    air_tickets_trans_sum_3m / NULLIF(air_tickets_trans_sum_12m, 0) AS air_tickets_trans_sum_3m_to_12m,
    hotels_trans_count_3m / NULLIF(hotels_trans_count_12m, 0) AS hotels_trans_count_3m_to_12m,
    hotels_trans_sum_3m / NULLIF(hotels_trans_sum_12m, 0) AS hotels_trans_sum_3m_to_12m,
    courier_trans_count_3m / NULLIF(courier_trans_count_12m, 0) AS courier_trans_count_3m_to_12m,
    courier_trans_sum_3m / NULLIF(courier_trans_sum_12m, 0) AS courier_trans_sum_3m_to_12m,
    souvenirs_trans_count_3m / NULLIF(souvenirs_trans_count_12m, 0) AS souvenirs_trans_count_3m_to_12m,
    souvenirs_trans_sum_3m / NULLIF(souvenirs_trans_sum_12m, 0) AS souvenirs_trans_sum_3m_to_12m,
    card_transfer_trans_count_3m / NULLIF(card_transfer_trans_count_12m, 0) AS card_transfer_trans_count_3m_to_12m,
    card_transfer_trans_sum_3m / NULLIF(card_transfer_trans_sum_12m, 0) AS card_transfer_trans_sum_3m_to_12m,
    entertainment_trans_count_3m / NULLIF(entertainment_trans_count_12m, 0) AS entertainment_trans_count_3m_to_12m,
    entertainment_trans_sum_3m / NULLIF(entertainment_trans_sum_12m, 0) AS entertainment_trans_sum_3m_to_12m,
    taxes_fines_trans_count_3m / NULLIF(taxes_fines_trans_count_12m, 0) AS taxes_fines_trans_count_3m_to_12m,
    taxes_fines_trans_sum_3m / NULLIF(taxes_fines_trans_sum_12m, 0) AS taxes_fines_trans_sum_3m_to_12m,
    supermarkets_trans_count_3m / NULLIF(supermarkets_trans_count_12m, 0) AS supermarkets_trans_count_3m_to_12m,
    supermarkets_trans_sum_3m / NULLIF(supermarkets_trans_sum_12m, 0) AS supermarkets_trans_sum_3m_to_12m,
    sport_goods_trans_count_3m / NULLIF(sport_goods_trans_count_12m, 0) AS sport_goods_trans_count_3m_to_12m,
    sport_goods_trans_sum_3m / NULLIF(sport_goods_trans_sum_12m, 0) AS sport_goods_trans_sum_3m_to_12m,
    sber_services_trans_count_3m / NULLIF(sber_services_trans_count_12m, 0) AS sber_services_trans_count_3m_to_12m,
    sber_services_trans_sum_3m / NULLIF(sber_services_trans_sum_12m, 0) AS sber_services_trans_sum_3m_to_12m,
    gov_services_trans_count_3m / NULLIF(gov_services_trans_count_12m, 0) AS gov_services_trans_count_3m_to_12m,
    gov_services_trans_sum_3m / NULLIF(gov_services_trans_sum_12m, 0) AS gov_services_trans_sum_3m_to_12m,
    art_trans_count_3m / NULLIF(art_trans_count_12m, 0) AS art_trans_count_3m_to_12m,
    art_trans_sum_3m / NULLIF(art_trans_sum_12m, 0) AS art_trans_sum_3m_to_12m,
    pharmacies_trans_count_3m / NULLIF(pharmacies_trans_count_12m, 0) AS pharmacies_trans_count_3m_to_12m,
    pharmacies_trans_sum_3m / NULLIF(pharmacies_trans_sum_12m, 0) AS pharmacies_trans_sum_3m_to_12m,
    flowers_trans_count_3m / NULLIF(flowers_trans_count_12m, 0) AS flowers_trans_count_3m_to_12m,
    flowers_trans_sum_3m / NULLIF(flowers_trans_sum_12m, 0) AS flowers_trans_sum_3m_to_12m,
    train_tickets_trans_count_3m / NULLIF(train_tickets_trans_count_12m, 0) AS train_tickets_trans_count_3m_to_12m,
    train_tickets_trans_sum_3m / NULLIF(train_tickets_trans_sum_12m, 0) AS train_tickets_trans_sum_3m_to_12m,
    gambling_trans_count_3m / NULLIF(gambling_trans_count_12m, 0) AS gambling_trans_count_3m_to_12m,
    gambling_trans_sum_3m / NULLIF(gambling_trans_sum_12m, 0) AS gambling_trans_sum_3m_to_12m,
    digital_goods_trans_count_3m / NULLIF(digital_goods_trans_count_12m, 0) AS digital_goods_trans_count_3m_to_12m,
    digital_goods_trans_sum_3m / NULLIF(digital_goods_trans_sum_12m, 0) AS digital_goods_trans_sum_3m_to_12m,
    books_trans_count_3m / NULLIF(books_trans_count_12m, 0) AS books_trans_count_3m_to_12m,
    books_trans_sum_3m / NULLIF(books_trans_sum_12m, 0) AS books_trans_sum_3m_to_12m,
    fuel_trans_count_3m / NULLIF(fuel_trans_count_12m, 0) AS fuel_trans_count_3m_to_12m,
    fuel_trans_sum_3m / NULLIF(fuel_trans_sum_12m, 0) AS fuel_trans_sum_3m_to_12m,
    yandex_services_trans_count_3m / NULLIF(yandex_services_trans_count_12m, 0) AS yandex_services_trans_count_3m_to_12m,
    yandex_services_trans_sum_3m / NULLIF(yandex_services_trans_sum_12m, 0) AS yandex_services_trans_sum_3m_to_12m,
    beauty_trans_count_3m / NULLIF(beauty_trans_count_12m, 0) AS beauty_trans_count_3m_to_12m,
    beauty_trans_sum_3m / NULLIF(beauty_trans_sum_12m, 0) AS beauty_trans_sum_3m_to_12m,
    cinema_trans_count_3m / NULLIF(cinema_trans_count_12m, 0) AS cinema_trans_count_3m_to_12m,
    cinema_trans_sum_3m / NULLIF(cinema_trans_sum_12m, 0) AS cinema_trans_sum_3m_to_12m,
    charity_trans_count_3m / NULLIF(charity_trans_count_12m, 0) AS charity_trans_count_3m_to_12m,
    charity_trans_sum_3m / NULLIF(charity_trans_sum_12m, 0) AS charity_trans_sum_3m_to_12m,
    money_transfers_trans_count_3m / NULLIF(money_transfers_trans_count_12m, 0) AS money_transfers_trans_count_3m_to_12m,
    money_transfers_trans_sum_3m / NULLIF(money_transfers_trans_sum_12m, 0) AS money_transfers_trans_sum_3m_to_12m,
    auto_services_trans_count_3m / NULLIF(auto_services_trans_count_12m, 0) AS auto_services_trans_count_3m_to_12m,
    auto_services_trans_sum_3m / NULLIF(auto_services_trans_sum_12m, 0) AS auto_services_trans_sum_3m_to_12m,
    services_consulting_trans_count_3m / NULLIF(services_consulting_trans_count_12m, 0) AS services_consulting_trans_count_3m_to_12m,
    services_consulting_trans_sum_3m / NULLIF(services_consulting_trans_sum_12m, 0) AS services_consulting_trans_sum_3m_to_12m,
    cash_withdrawal_trans_count_3m / NULLIF(cash_withdrawal_trans_count_12m, 0) AS cash_withdrawal_trans_count_3m_to_12m,
    cash_withdrawal_trans_sum_3m / NULLIF(cash_withdrawal_trans_sum_12m, 0) AS cash_withdrawal_trans_sum_3m_to_12m,
    other_expenses_trans_count_3m / NULLIF(other_expenses_trans_count_12m, 0) AS other_expenses_trans_count_3m_to_12m,
    other_expenses_trans_sum_3m / NULLIF(other_expenses_trans_sum_12m, 0) AS other_expenses_trans_sum_3m_to_12m,
    utilities_communication_trans_count_3m / NULLIF(utilities_communication_trans_count_12m, 0) AS utilities_communication_trans_count_3m_to_12m,
    utilities_communication_trans_sum_3m / NULLIF(utilities_communication_trans_sum_12m, 0) AS utilities_communication_trans_sum_3m_to_12m,
    electronics_trans_count_3m / NULLIF(electronics_trans_count_12m, 0) AS electronics_trans_count_3m_to_12m,
    electronics_trans_sum_3m / NULLIF(electronics_trans_sum_12m, 0) AS electronics_trans_sum_3m_to_12m,
    jewelry_trans_count_3m / NULLIF(jewelry_trans_count_12m, 0) AS jewelry_trans_count_3m_to_12m,
    jewelry_trans_sum_3m / NULLIF(jewelry_trans_sum_12m, 0) AS jewelry_trans_sum_3m_to_12m,
    clothing_shoes_trans_count_3m / NULLIF(clothing_shoes_trans_count_12m, 0) AS clothing_shoes_trans_count_3m_to_12m,
    clothing_shoes_trans_sum_3m / NULLIF(clothing_shoes_trans_sum_12m, 0) AS clothing_shoes_trans_sum_3m_to_12m,
    education_trans_count_3m / NULLIF(education_trans_count_12m, 0) AS education_trans_count_3m_to_12m,
    education_trans_sum_3m / NULLIF(education_trans_sum_12m, 0) AS education_trans_sum_3m_to_12m,
    finance_trans_count_3m / NULLIF(finance_trans_count_12m, 0) AS finance_trans_count_3m_to_12m,
    finance_trans_sum_3m / NULLIF(finance_trans_sum_12m, 0) AS finance_trans_sum_3m_to_12m,

    -- Отношение 3 месяца к 6 месяцам
    dom_rem_trans_count_3m / NULLIF(dom_rem_trans_count_6m, 0) AS dom_rem_trans_count_3m_to_6m,
    dom_rem_trans_sum_3m / NULLIF(dom_rem_trans_sum_6m, 0) AS dom_rem_trans_sum_3m_to_6m,
    cafe_trans_count_3m / NULLIF(cafe_trans_count_6m, 0) AS cafe_trans_count_3m_to_6m,
    cafe_trans_sum_3m / NULLIF(cafe_trans_sum_6m, 0) AS cafe_trans_sum_3m_to_6m,
    rent_auto_trans_count_3m / NULLIF(rent_auto_trans_count_6m, 0) AS rent_auto_trans_count_3m_to_6m,
    rent_auto_trans_sum_3m / NULLIF(rent_auto_trans_sum_6m, 0) AS rent_auto_trans_sum_3m_to_6m,
    transport_trans_count_3m / NULLIF(transport_trans_count_6m, 0) AS transport_trans_count_3m_to_6m,
    transport_trans_sum_3m / NULLIF(transport_trans_sum_6m, 0) AS transport_trans_sum_3m_to_6m,
    travel_trans_count_3m / NULLIF(travel_trans_count_6m, 0) AS travel_trans_count_3m_to_6m,
    travel_trans_sum_3m / NULLIF(travel_trans_sum_6m, 0) AS travel_trans_sum_3m_to_6m,
    medicine_trans_count_3m / NULLIF(medicine_trans_count_6m, 0) AS medicine_trans_count_3m_to_6m,
    medicine_trans_sum_3m / NULLIF(medicine_trans_sum_6m, 0) AS medicine_trans_sum_3m_to_6m,
    online_shops_trans_count_3m / NULLIF(online_shops_trans_count_6m, 0) AS online_shops_trans_count_3m_to_6m,
    online_shops_trans_sum_3m / NULLIF(online_shops_trans_sum_6m, 0) AS online_shops_trans_sum_3m_to_6m,
    music_trans_count_3m / NULLIF(music_trans_count_6m, 0) AS music_trans_count_3m_to_6m,
    music_trans_sum_3m / NULLIF(music_trans_sum_6m, 0) AS music_trans_sum_3m_to_6m,
    lombards_trans_count_3m / NULLIF(lombards_trans_count_6m, 0) AS lombards_trans_count_3m_to_6m,
    lombards_trans_sum_3m / NULLIF(lombards_trans_sum_6m, 0) AS lombards_trans_sum_3m_to_6m,
    zoo_trans_count_3m / NULLIF(zoo_trans_count_6m, 0) AS zoo_trans_count_3m_to_6m,
    zoo_trans_sum_3m / NULLIF(zoo_trans_sum_6m, 0) AS zoo_trans_sum_3m_to_6m,
    air_tickets_trans_count_3m / NULLIF(air_tickets_trans_count_6m, 0) AS air_tickets_trans_count_3m_to_6m,
    air_tickets_trans_sum_3m / NULLIF(air_tickets_trans_sum_6m, 0) AS air_tickets_trans_sum_3m_to_6m,
    hotels_trans_count_3m / NULLIF(hotels_trans_count_6m, 0) AS hotels_trans_count_3m_to_6m,
    hotels_trans_sum_3m / NULLIF(hotels_trans_sum_6m, 0) AS hotels_trans_sum_3m_to_6m,
    courier_trans_count_3m / NULLIF(courier_trans_count_6m, 0) AS courier_trans_count_3m_to_6m,
    courier_trans_sum_3m / NULLIF(courier_trans_sum_6m, 0) AS courier_trans_sum_3m_to_6m,
    souvenirs_trans_count_3m / NULLIF(souvenirs_trans_count_6m, 0) AS souvenirs_trans_count_3m_to_6m,
    souvenirs_trans_sum_3m / NULLIF(souvenirs_trans_sum_6m, 0) AS souvenirs_trans_sum_3m_to_6m,
    card_transfer_trans_count_3m / NULLIF(card_transfer_trans_count_6m, 0) AS card_transfer_trans_count_3m_to_6m,
    card_transfer_trans_sum_3m / NULLIF(card_transfer_trans_sum_6m, 0) AS card_transfer_trans_sum_3m_to_6m,
    entertainment_trans_count_3m / NULLIF(entertainment_trans_count_6m, 0) AS entertainment_trans_count_3m_to_6m,
    entertainment_trans_sum_3m / NULLIF(entertainment_trans_sum_6m, 0) AS entertainment_trans_sum_3m_to_6m,
    taxes_fines_trans_count_3m / NULLIF(taxes_fines_trans_count_6m, 0) AS taxes_fines_trans_count_3m_to_6m,
    taxes_fines_trans_sum_3m / NULLIF(taxes_fines_trans_sum_6m, 0) AS taxes_fines_trans_sum_3m_to_6m,
    supermarkets_trans_count_3m / NULLIF(supermarkets_trans_count_6m, 0) AS supermarkets_trans_count_3m_to_6m,
    supermarkets_trans_sum_3m / NULLIF(supermarkets_trans_sum_6m, 0) AS supermarkets_trans_sum_3m_to_6m,
    sport_goods_trans_count_3m / NULLIF(sport_goods_trans_count_6m, 0) AS sport_goods_trans_count_3m_to_6m,
    sport_goods_trans_sum_3m / NULLIF(sport_goods_trans_sum_6m, 0) AS sport_goods_trans_sum_3m_to_6m,
    sber_services_trans_count_3m / NULLIF(sber_services_trans_count_6m, 0) AS sber_services_trans_count_3m_to_6m,
    sber_services_trans_sum_3m / NULLIF(sber_services_trans_sum_6m, 0) AS sber_services_trans_sum_3m_to_6m,
    gov_services_trans_count_3m / NULLIF(gov_services_trans_count_6m, 0) AS gov_services_trans_count_3m_to_6m,
    gov_services_trans_sum_3m / NULLIF(gov_services_trans_sum_6m, 0) AS gov_services_trans_sum_3m_to_6m,
    art_trans_count_3m / NULLIF(art_trans_count_6m, 0) AS art_trans_count_3m_to_6m,
    art_trans_sum_3m / NULLIF(art_trans_sum_6m, 0) AS art_trans_sum_3m_to_6m,
    pharmacies_trans_count_3m / NULLIF(pharmacies_trans_count_6m, 0) AS pharmacies_trans_count_3m_to_6m,
    pharmacies_trans_sum_3m / NULLIF(pharmacies_trans_sum_6m, 0) AS pharmacies_trans_sum_3m_to_6m,
    flowers_trans_count_3m / NULLIF(flowers_trans_count_6m, 0) AS flowers_trans_count_3m_to_6m,
    flowers_trans_sum_3m / NULLIF(flowers_trans_sum_6m, 0) AS flowers_trans_sum_3m_to_6m,
    train_tickets_trans_count_3m / NULLIF(train_tickets_trans_count_6m, 0) AS train_tickets_trans_count_3m_to_6m,
    train_tickets_trans_sum_3m / NULLIF(train_tickets_trans_sum_6m, 0) AS train_tickets_trans_sum_3m_to_6m,
    gambling_trans_count_3m / NULLIF(gambling_trans_count_6m, 0) AS gambling_trans_count_3m_to_6m,
    gambling_trans_sum_3m / NULLIF(gambling_trans_sum_6m, 0) AS gambling_trans_sum_3m_to_6m,
    digital_goods_trans_count_3m / NULLIF(digital_goods_trans_count_6m, 0) AS digital_goods_trans_count_3m_to_6m,
    digital_goods_trans_sum_3m / NULLIF(digital_goods_trans_sum_6m, 0) AS digital_goods_trans_sum_3m_to_6m,
    books_trans_count_3m / NULLIF(books_trans_count_6m, 0) AS books_trans_count_3m_to_6m,
    books_trans_sum_3m / NULLIF(books_trans_sum_6m, 0) AS books_trans_sum_3m_to_6m,
    fuel_trans_count_3m / NULLIF(fuel_trans_count_6m, 0) AS fuel_trans_count_3m_to_6m,
    fuel_trans_sum_3m / NULLIF(fuel_trans_sum_6m, 0) AS fuel_trans_sum_3m_to_6m,
    yandex_services_trans_count_3m / NULLIF(yandex_services_trans_count_6m, 0) AS yandex_services_trans_count_3m_to_6m,
    yandex_services_trans_sum_3m / NULLIF(yandex_services_trans_sum_6m, 0) AS yandex_services_trans_sum_3m_to_6m,
    beauty_trans_count_3m / NULLIF(beauty_trans_count_6m, 0) AS beauty_trans_count_3m_to_6m,
    beauty_trans_sum_3m / NULLIF(beauty_trans_sum_6m, 0) AS beauty_trans_sum_3m_to_6m,
    cinema_trans_count_3m / NULLIF(cinema_trans_count_6m, 0) AS cinema_trans_count_3m_to_6m,
    cinema_trans_sum_3m / NULLIF(cinema_trans_sum_6m, 0) AS cinema_trans_sum_3m_to_6m,
    charity_trans_count_3m / NULLIF(charity_trans_count_6m, 0) AS charity_trans_count_3m_to_6m,
    charity_trans_sum_3m / NULLIF(charity_trans_sum_6m, 0) AS charity_trans_sum_3m_to_6m,
    money_transfers_trans_count_3m / NULLIF(money_transfers_trans_count_6m, 0) AS money_transfers_trans_count_3m_to_6m,
    money_transfers_trans_sum_3m / NULLIF(money_transfers_trans_sum_6m, 0) AS money_transfers_trans_sum_3m_to_6m,
    auto_services_trans_count_3m / NULLIF(auto_services_trans_count_6m, 0) AS auto_services_trans_count_3m_to_6m,
    auto_services_trans_sum_3m / NULLIF(auto_services_trans_sum_6m, 0) AS auto_services_trans_sum_3m_to_6m,
    services_consulting_trans_count_3m / NULLIF(services_consulting_trans_count_6m, 0) AS services_consulting_trans_count_3m_to_6m,
    services_consulting_trans_sum_3m / NULLIF(services_consulting_trans_sum_6m, 0) AS services_consulting_trans_sum_3m_to_6m,
    cash_withdrawal_trans_count_3m / NULLIF(cash_withdrawal_trans_count_6m, 0) AS cash_withdrawal_trans_count_3m_to_6m,
    cash_withdrawal_trans_sum_3m / NULLIF(cash_withdrawal_trans_sum_6m, 0) AS cash_withdrawal_trans_sum_3m_to_6m,
    other_expenses_trans_count_3m / NULLIF(other_expenses_trans_count_6m, 0) AS other_expenses_trans_count_3m_to_6m,
    other_expenses_trans_sum_3m / NULLIF(other_expenses_trans_sum_6m, 0) AS other_expenses_trans_sum_3m_to_6m,
    utilities_communication_trans_count_3m / NULLIF(utilities_communication_trans_count_6m, 0) AS utilities_communication_trans_count_3m_to_6m,
    utilities_communication_trans_sum_3m / NULLIF(utilities_communication_trans_sum_6m, 0) AS utilities_communication_trans_sum_3m_to_6m,
    electronics_trans_count_3m / NULLIF(electronics_trans_count_6m, 0) AS electronics_trans_count_3m_to_6m,
    electronics_trans_sum_3m / NULLIF(electronics_trans_sum_6m, 0) AS electronics_trans_sum_3m_to_6m,
    jewelry_trans_count_3m / NULLIF(jewelry_trans_count_6m, 0) AS jewelry_trans_count_3m_to_6m,
    jewelry_trans_sum_3m / NULLIF(jewelry_trans_sum_6m, 0) AS jewelry_trans_sum_3m_to_6m,
    clothing_shoes_trans_count_3m / NULLIF(clothing_shoes_trans_count_6m, 0) AS clothing_shoes_trans_count_3m_to_6m,
    clothing_shoes_trans_sum_3m / NULLIF(clothing_shoes_trans_sum_6m, 0) AS clothing_shoes_trans_sum_3m_to_6m,
    education_trans_count_3m / NULLIF(education_trans_count_6m, 0) AS education_trans_count_3m_to_6m,
    education_trans_sum_3m / NULLIF(education_trans_sum_6m, 0) AS education_trans_sum_3m_to_6m,
    finance_trans_count_3m / NULLIF(finance_trans_count_6m, 0) AS finance_trans_count_3m_to_6m,
    finance_trans_sum_3m / NULLIF(finance_trans_sum_6m, 0) AS finance_trans_sum_3m_to_6m,

    -- Отношение 6 месяцев к 12 месяцам
    dom_rem_trans_count_6m / NULLIF(dom_rem_trans_count_12m, 0) AS dom_rem_trans_count_6m_to_12m,
    dom_rem_trans_sum_6m / NULLIF(dom_rem_trans_sum_12m, 0) AS dom_rem_trans_sum_6m_to_12m,
    cafe_trans_count_6m / NULLIF(cafe_trans_count_12m, 0) AS cafe_trans_count_6m_to_12m,
    cafe_trans_sum_6m / NULLIF(cafe_trans_sum_12m, 0) AS cafe_trans_sum_6m_to_12m,
    rent_auto_trans_count_6m / NULLIF(rent_auto_trans_count_12m, 0) AS rent_auto_trans_count_6m_to_12m,
    rent_auto_trans_sum_6m / NULLIF(rent_auto_trans_sum_12m, 0) AS rent_auto_trans_sum_6m_to_12m,
    transport_trans_count_6m / NULLIF(transport_trans_count_12m, 0) AS transport_trans_count_6m_to_12m,
    transport_trans_sum_6m / NULLIF(transport_trans_sum_12m, 0) AS transport_trans_sum_6m_to_12m,
    travel_trans_count_6m / NULLIF(travel_trans_count_12m, 0) AS travel_trans_count_6m_to_12m,
    travel_trans_sum_6m / NULLIF(travel_trans_sum_12m, 0) AS travel_trans_sum_6m_to_12m,
    medicine_trans_count_6m / NULLIF(medicine_trans_count_12m, 0) AS medicine_trans_count_6m_to_12m,
    medicine_trans_sum_6m / NULLIF(medicine_trans_sum_12m, 0) AS medicine_trans_sum_6m_to_12m,
    online_shops_trans_count_6m / NULLIF(online_shops_trans_count_12m, 0) AS online_shops_trans_count_6m_to_12m,
    online_shops_trans_sum_6m / NULLIF(online_shops_trans_sum_12m, 0) AS online_shops_trans_sum_6m_to_12m,
    music_trans_count_6m / NULLIF(music_trans_count_12m, 0) AS music_trans_count_6m_to_12m,
    music_trans_sum_6m / NULLIF(music_trans_sum_12m, 0) AS music_trans_sum_6m_to_12m,
    lombards_trans_count_6m / NULLIF(lombards_trans_count_12m, 0) AS lombards_trans_count_6m_to_12m,
    lombards_trans_sum_6m / NULLIF(lombards_trans_sum_12m, 0) AS lombards_trans_sum_6m_to_12m,
    zoo_trans_count_6m / NULLIF(zoo_trans_count_12m, 0) AS zoo_trans_count_6m_to_12m,
    zoo_trans_sum_6m / NULLIF(zoo_trans_sum_12m, 0) AS zoo_trans_sum_6m_to_12m,
    air_tickets_trans_count_6m / NULLIF(air_tickets_trans_count_12m, 0) AS air_tickets_trans_count_6m_to_12m,
    air_tickets_trans_sum_6m / NULLIF(air_tickets_trans_sum_12m, 0) AS air_tickets_trans_sum_6m_to_12m,
    hotels_trans_count_6m / NULLIF(hotels_trans_count_12m, 0) AS hotels_trans_count_6m_to_12m,
    hotels_trans_sum_6m / NULLIF(hotels_trans_sum_12m, 0) AS hotels_trans_sum_6m_to_12m,
    courier_trans_count_6m / NULLIF(courier_trans_count_12m, 0) AS courier_trans_count_6m_to_12m,
    courier_trans_sum_6m / NULLIF(courier_trans_sum_12m, 0) AS courier_trans_sum_6m_to_12m,
    souvenirs_trans_count_6m / NULLIF(souvenirs_trans_count_12m, 0) AS souvenirs_trans_count_6m_to_12m,
    souvenirs_trans_sum_6m / NULLIF(souvenirs_trans_sum_12m, 0) AS souvenirs_trans_sum_6m_to_12m,
    card_transfer_trans_count_6m / NULLIF(card_transfer_trans_count_12m, 0) AS card_transfer_trans_count_6m_to_12m,
    card_transfer_trans_sum_6m / NULLIF(card_transfer_trans_sum_12m, 0) AS card_transfer_trans_sum_6m_to_12m,
    entertainment_trans_count_6m / NULLIF(entertainment_trans_count_12m, 0) AS entertainment_trans_count_6m_to_12m,
    entertainment_trans_sum_6m / NULLIF(entertainment_trans_sum_12m, 0) AS entertainment_trans_sum_6m_to_12m,
    taxes_fines_trans_count_6m / NULLIF(taxes_fines_trans_count_12m, 0) AS taxes_fines_trans_count_6m_to_12m,
    taxes_fines_trans_sum_6m / NULLIF(taxes_fines_trans_sum_12m, 0) AS taxes_fines_trans_sum_6m_to_12m,
    supermarkets_trans_count_6m / NULLIF(supermarkets_trans_count_12m, 0) AS supermarkets_trans_count_6m_to_12m,
    supermarkets_trans_sum_6m / NULLIF(supermarkets_trans_sum_12m, 0) AS supermarkets_trans_sum_6m_to_12m,
    sport_goods_trans_count_6m / NULLIF(sport_goods_trans_count_12m, 0) AS sport_goods_trans_count_6m_to_12m,
    sport_goods_trans_sum_6m / NULLIF(sport_goods_trans_sum_12m, 0) AS sport_goods_trans_sum_6m_to_12m,
    sber_services_trans_count_6m / NULLIF(sber_services_trans_count_12m, 0) AS sber_services_trans_count_6m_to_12m,
    sber_services_trans_sum_6m / NULLIF(sber_services_trans_sum_12m, 0) AS sber_services_trans_sum_6m_to_12m,
    gov_services_trans_count_6m / NULLIF(gov_services_trans_count_12m, 0) AS gov_services_trans_count_6m_to_12m,
    gov_services_trans_sum_6m / NULLIF(gov_services_trans_sum_12m, 0) AS gov_services_trans_sum_6m_to_12m,
    art_trans_count_6m / NULLIF(art_trans_count_12m, 0) AS art_trans_count_6m_to_12m,
    art_trans_sum_6m / NULLIF(art_trans_sum_12m, 0) AS art_trans_sum_6m_to_12m,
    pharmacies_trans_count_6m / NULLIF(pharmacies_trans_count_12m, 0) AS pharmacies_trans_count_6m_to_12m,
    pharmacies_trans_sum_6m / NULLIF(pharmacies_trans_sum_12m, 0) AS pharmacies_trans_sum_6m_to_12m,
    flowers_trans_count_6m / NULLIF(flowers_trans_count_12m, 0) AS flowers_trans_count_6m_to_12m,
    flowers_trans_sum_6m / NULLIF(flowers_trans_sum_12m, 0) AS flowers_trans_sum_6m_to_12m,
    train_tickets_trans_count_6m / NULLIF(train_tickets_trans_count_12m, 0) AS train_tickets_trans_count_6m_to_12m,
    train_tickets_trans_sum_6m / NULLIF(train_tickets_trans_sum_12m, 0) AS train_tickets_trans_sum_6m_to_12m,
    gambling_trans_count_6m / NULLIF(gambling_trans_count_12m, 0) AS gambling_trans_count_6m_to_12m,
    gambling_trans_sum_6m / NULLIF(gambling_trans_sum_12m, 0) AS gambling_trans_sum_6m_to_12m,
    digital_goods_trans_count_6m / NULLIF(digital_goods_trans_count_12m, 0) AS digital_goods_trans_count_6m_to_12m,
    digital_goods_trans_sum_6m / NULLIF(digital_goods_trans_sum_12m, 0) AS digital_goods_trans_sum_6m_to_12m,
    books_trans_count_6m / NULLIF(books_trans_count_12m, 0) AS books_trans_count_6m_to_12m,
    books_trans_sum_6m / NULLIF(books_trans_sum_12m, 0) AS books_trans_sum_6m_to_12m,
    fuel_trans_count_6m / NULLIF(fuel_trans_count_12m, 0) AS fuel_trans_count_6m_to_12m,
    fuel_trans_sum_6m / NULLIF(fuel_trans_sum_12m, 0) AS fuel_trans_sum_6m_to_12m,
    yandex_services_trans_count_6m / NULLIF(yandex_services_trans_count_12m, 0) AS yandex_services_trans_count_6m_to_12m,
    yandex_services_trans_sum_6m / NULLIF(yandex_services_trans_sum_12m, 0) AS yandex_services_trans_sum_6m_to_12m,
    beauty_trans_count_6m / NULLIF(beauty_trans_count_12m, 0) AS beauty_trans_count_6m_to_12m,
    beauty_trans_sum_6m / NULLIF(beauty_trans_sum_12m, 0) AS beauty_trans_sum_6m_to_12m,
    cinema_trans_count_6m / NULLIF(cinema_trans_count_12m, 0) AS cinema_trans_count_6m_to_12m,
    cinema_trans_sum_6m / NULLIF(cinema_trans_sum_12m, 0) AS cinema_trans_sum_6m_to_12m,
    charity_trans_count_6m / NULLIF(charity_trans_count_12m, 0) AS charity_trans_count_6m_to_12m,
    charity_trans_sum_6m / NULLIF(charity_trans_sum_12m, 0) AS charity_trans_sum_6m_to_12m,
    money_transfers_trans_count_6m / NULLIF(money_transfers_trans_count_12m, 0) AS money_transfers_trans_count_6m_to_12m,
    money_transfers_trans_sum_6m / NULLIF(money_transfers_trans_sum_12m, 0) AS money_transfers_trans_sum_6m_to_12m,
    auto_services_trans_count_6m / NULLIF(auto_services_trans_count_12m, 0) AS auto_services_trans_count_6m_to_12m,
    auto_services_trans_sum_6m / NULLIF(auto_services_trans_sum_12m, 0) AS auto_services_trans_sum_6m_to_12m,
    services_consulting_trans_count_6m / NULLIF(services_consulting_trans_count_12m, 0) AS services_consulting_trans_count_6m_to_12m,
    services_consulting_trans_sum_6m / NULLIF(services_consulting_trans_sum_12m, 0) AS services_consulting_trans_sum_6m_to_12m,
    cash_withdrawal_trans_count_6m / NULLIF(cash_withdrawal_trans_count_12m, 0) AS cash_withdrawal_trans_count_6m_to_12m,
    cash_withdrawal_trans_sum_6m / NULLIF(cash_withdrawal_trans_sum_12m, 0) AS cash_withdrawal_trans_sum_6m_to_12m,
    other_expenses_trans_count_6m / NULLIF(other_expenses_trans_count_12m, 0) AS other_expenses_trans_count_6m_to_12m,
    other_expenses_trans_sum_6m / NULLIF(other_expenses_trans_sum_12m, 0) AS other_expenses_trans_sum_6m_to_12m,
    utilities_communication_trans_count_6m / NULLIF(utilities_communication_trans_count_12m, 0) AS utilities_communication_trans_count_6m_to_12m,
    utilities_communication_trans_sum_6m / NULLIF(utilities_communication_trans_sum_12m, 0) AS utilities_communication_trans_sum_6m_to_12m,
    electronics_trans_count_6m / NULLIF(electronics_trans_count_12m, 0) AS electronics_trans_count_6m_to_12m,
    electronics_trans_sum_6m / NULLIF(electronics_trans_sum_12m, 0) AS electronics_trans_sum_6m_to_12m,
    jewelry_trans_count_6m / NULLIF(jewelry_trans_count_12m, 0) AS jewelry_trans_count_6m_to_12m,
    jewelry_trans_sum_6m / NULLIF(jewelry_trans_sum_12m, 0) AS jewelry_trans_sum_6m_to_12m,
    clothing_shoes_trans_count_6m / NULLIF(clothing_shoes_trans_count_12m, 0) AS clothing_shoes_trans_count_6m_to_12m,
    clothing_shoes_trans_sum_6m / NULLIF(clothing_shoes_trans_sum_12m, 0) AS clothing_shoes_trans_sum_6m_to_12m,
    education_trans_count_6m / NULLIF(education_trans_count_12m, 0) AS education_trans_count_6m_to_12m,
    education_trans_sum_6m / NULLIF(education_trans_sum_12m, 0) AS education_trans_sum_6m_to_12m,
    finance_trans_count_6m / NULLIF(finance_trans_count_12m, 0) AS finance_trans_count_6m_to_12m,
    finance_trans_sum_6m / NULLIF(finance_trans_sum_12m, 0) AS finance_trans_sum_6m_to_12m,

-- Отношение ко всем тратам за 1 месяц
    dom_rem_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS dom_rem_trans_count_1m_to_total_1m,
    dom_rem_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS dom_rem_trans_sum_1m_to_total_1m,
    cafe_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS cafe_trans_count_1m_to_total_1m,
    cafe_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS cafe_trans_sum_1m_to_total_1m,
    rent_auto_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS rent_auto_trans_count_1m_to_total_1m,
    rent_auto_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS rent_auto_trans_sum_1m_to_total_1m,
    transport_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS transport_trans_count_1m_to_total_1m,
    transport_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS transport_trans_sum_1m_to_total_1m,
    travel_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS travel_trans_count_1m_to_total_1m,
    travel_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS travel_trans_sum_1m_to_total_1m,
    medicine_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS medicine_trans_count_1m_to_total_1m,
    medicine_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS medicine_trans_sum_1m_to_total_1m,
    online_shops_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS online_shops_trans_count_1m_to_total_1m,
    online_shops_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS online_shops_trans_sum_1m_to_total_1m,
    music_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS music_trans_count_1m_to_total_1m,
    music_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS music_trans_sum_1m_to_total_1m,
    lombards_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS lombards_trans_count_1m_to_total_1m,
    lombards_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS lombards_trans_sum_1m_to_total_1m,
    zoo_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS zoo_trans_count_1m_to_total_1m,
    zoo_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS zoo_trans_sum_1m_to_total_1m,
    air_tickets_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS air_tickets_trans_count_1m_to_total_1m,
    air_tickets_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS air_tickets_trans_sum_1m_to_total_1m,
    hotels_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS hotels_trans_count_1m_to_total_1m,
    hotels_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS hotels_trans_sum_1m_to_total_1m,
    courier_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS courier_trans_count_1m_to_total_1m,
    courier_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS courier_trans_sum_1m_to_total_1m,
    souvenirs_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS souvenirs_trans_count_1m_to_total_1m,
    souvenirs_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS souvenirs_trans_sum_1m_to_total_1m,
    card_transfer_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS card_transfer_trans_count_1m_to_total_1m,
    card_transfer_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS card_transfer_trans_sum_1m_to_total_1m,
    entertainment_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS entertainment_trans_count_1m_to_total_1m,
    entertainment_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS entertainment_trans_sum_1m_to_total_1m,
    taxes_fines_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS taxes_fines_trans_count_1m_to_total_1m,
    taxes_fines_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS taxes_fines_trans_sum_1m_to_total_1m,
    supermarkets_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS supermarkets_trans_count_1m_to_total_1m,
    supermarkets_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS supermarkets_trans_sum_1m_to_total_1m,
    sport_goods_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS sport_goods_trans_count_1m_to_total_1m,
    sport_goods_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS sport_goods_trans_sum_1m_to_total_1m,
    sber_services_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS sber_services_trans_count_1m_to_total_1m,
    sber_services_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS sber_services_trans_sum_1m_to_total_1m,
    gov_services_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS gov_services_trans_count_1m_to_total_1m,
    gov_services_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS gov_services_trans_sum_1m_to_total_1m,
    art_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS art_trans_count_1m_to_total_1m,
    art_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS art_trans_sum_1m_to_total_1m,
    pharmacies_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS pharmacies_trans_count_1m_to_total_1m,
    pharmacies_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS pharmacies_trans_sum_1m_to_total_1m,
    flowers_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS flowers_trans_count_1m_to_total_1m,
    flowers_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS flowers_trans_sum_1m_to_total_1m,
    train_tickets_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS train_tickets_trans_count_1m_to_total_1m,
    train_tickets_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS train_tickets_trans_sum_1m_to_total_1m,
    gambling_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS gambling_trans_count_1m_to_total_1m,
    gambling_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS gambling_trans_sum_1m_to_total_1m,
    digital_goods_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS digital_goods_trans_count_1m_to_total_1m,
    digital_goods_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS digital_goods_trans_sum_1m_to_total_1m,
    books_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS books_trans_count_1m_to_total_1m,
    books_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS books_trans_sum_1m_to_total_1m,
    fuel_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS fuel_trans_count_1m_to_total_1m,
    fuel_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS fuel_trans_sum_1m_to_total_1m,
    yandex_services_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS yandex_services_trans_count_1m_to_total_1m,
    yandex_services_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS yandex_services_trans_sum_1m_to_total_1m,
    beauty_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS beauty_trans_count_1m_to_total_1m,
    beauty_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS beauty_trans_sum_1m_to_total_1m,
    cinema_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS cinema_trans_count_1m_to_total_1m,
    cinema_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS cinema_trans_sum_1m_to_total_1m,
    charity_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS charity_trans_count_1m_to_total_1m,
    charity_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS charity_trans_sum_1m_to_total_1m,
    money_transfers_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS money_transfers_trans_count_1m_to_total_1m,
    money_transfers_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS money_transfers_trans_sum_1m_to_total_1m,
    auto_services_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS auto_services_trans_count_1m_to_total_1m,
    auto_services_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS auto_services_trans_sum_1m_to_total_1m,
    services_consulting_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS services_consulting_trans_count_1m_to_total_1m,
    services_consulting_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS services_consulting_trans_sum_1m_to_total_1m,
    cash_withdrawal_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS cash_withdrawal_trans_count_1m_to_total_1m,
    cash_withdrawal_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS cash_withdrawal_trans_sum_1m_to_total_1m,
    other_expenses_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS other_expenses_trans_count_1m_to_total_1m,
    other_expenses_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS other_expenses_trans_sum_1m_to_total_1m,
    utilities_communication_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS utilities_communication_trans_count_1m_to_total_1m,
    utilities_communication_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS utilities_communication_trans_sum_1m_to_total_1m,
    electronics_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS electronics_trans_count_1m_to_total_1m,
    electronics_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS electronics_trans_sum_1m_to_total_1m,
    jewelry_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS jewelry_trans_count_1m_to_total_1m,
    jewelry_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS jewelry_trans_sum_1m_to_total_1m,
    clothing_shoes_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS clothing_shoes_trans_count_1m_to_total_1m,
    clothing_shoes_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS clothing_shoes_trans_sum_1m_to_total_1m,
    education_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS education_trans_count_1m_to_total_1m,
    education_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS education_trans_sum_1m_to_total_1m,
    finance_trans_count_1m / NULLIF(total_trans_count_1m, 0) AS finance_trans_count_1m_to_total_1m,
    finance_trans_sum_1m / NULLIF(total_trans_sum_1m, 0) AS finance_trans_sum_1m_to_total_1m,

-- Отношение 1 месяца по категориям к 2 месяцам всех трат
    dom_rem_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS dom_rem_trans_count_1m_to_total_2m,
    dom_rem_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS dom_rem_trans_sum_1m_to_total_2m,
    cafe_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS cafe_trans_count_1m_to_total_2m,
    cafe_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS cafe_trans_sum_1m_to_total_2m,
    rent_auto_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS rent_auto_trans_count_1m_to_total_2m,
    rent_auto_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS rent_auto_trans_sum_1m_to_total_2m,
    transport_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS transport_trans_count_1m_to_total_2m,
    transport_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS transport_trans_sum_1m_to_total_2m,
    travel_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS travel_trans_count_1m_to_total_2m,
    travel_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS travel_trans_sum_1m_to_total_2m,
    medicine_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS medicine_trans_count_1m_to_total_2m,
    medicine_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS medicine_trans_sum_1m_to_total_2m,
    online_shops_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS online_shops_trans_count_1m_to_total_2m,
    online_shops_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS online_shops_trans_sum_1m_to_total_2m,
    music_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS music_trans_count_1m_to_total_2m,
    music_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS music_trans_sum_1m_to_total_2m,
    lombards_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS lombards_trans_count_1m_to_total_2m,
    lombards_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS lombards_trans_sum_1m_to_total_2m,
    zoo_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS zoo_trans_count_1m_to_total_2m,
    zoo_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS zoo_trans_sum_1m_to_total_2m,
    air_tickets_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS air_tickets_trans_count_1m_to_total_2m,
    air_tickets_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS air_tickets_trans_sum_1m_to_total_2m,
    hotels_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS hotels_trans_count_1m_to_total_2m,
    hotels_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS hotels_trans_sum_1m_to_total_2m,
    courier_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS courier_trans_count_1m_to_total_2m,
    courier_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS courier_trans_sum_1m_to_total_2m,
    souvenirs_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS souvenirs_trans_count_1m_to_total_2m,
    souvenirs_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS souvenirs_trans_sum_1m_to_total_2m,
    card_transfer_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS card_transfer_trans_count_1m_to_total_2m,
    card_transfer_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS card_transfer_trans_sum_1m_to_total_2m,
    entertainment_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS entertainment_trans_count_1m_to_total_2m,
    entertainment_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS entertainment_trans_sum_1m_to_total_2m,
    taxes_fines_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS taxes_fines_trans_count_1m_to_total_2m,
    taxes_fines_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS taxes_fines_trans_sum_1m_to_total_2m,
    supermarkets_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS supermarkets_trans_count_1m_to_total_2m,
    supermarkets_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS supermarkets_trans_sum_1m_to_total_2m,
    sport_goods_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS sport_goods_trans_count_1m_to_total_2m,
    sport_goods_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS sport_goods_trans_sum_1m_to_total_2m,
    sber_services_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS sber_services_trans_count_1m_to_total_2m,
    sber_services_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS sber_services_trans_sum_1m_to_total_2m,
    gov_services_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS gov_services_trans_count_1m_to_total_2m,
    gov_services_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS gov_services_trans_sum_1m_to_total_2m,
    art_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS art_trans_count_1m_to_total_2m,
    art_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS art_trans_sum_1m_to_total_2m,
    pharmacies_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS pharmacies_trans_count_1m_to_total_2m,
    pharmacies_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS pharmacies_trans_sum_1m_to_total_2m,
    flowers_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS flowers_trans_count_1m_to_total_2m,
    flowers_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS flowers_trans_sum_1m_to_total_2m,
    train_tickets_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS train_tickets_trans_count_1m_to_total_2m,
    train_tickets_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS train_tickets_trans_sum_1m_to_total_2m,
    gambling_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS gambling_trans_count_1m_to_total_2m,
    gambling_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS gambling_trans_sum_1m_to_total_2m,
    digital_goods_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS digital_goods_trans_count_1m_to_total_2m,
    digital_goods_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS digital_goods_trans_sum_1m_to_total_2m,
    books_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS books_trans_count_1m_to_total_2m,
    books_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS books_trans_sum_1m_to_total_2m,
    fuel_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS fuel_trans_count_1m_to_total_2m,
    fuel_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS fuel_trans_sum_1m_to_total_2m,
    yandex_services_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS yandex_services_trans_count_1m_to_total_2m,
    yandex_services_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS yandex_services_trans_sum_1m_to_total_2m,
    beauty_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS beauty_trans_count_1m_to_total_2m,
    beauty_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS beauty_trans_sum_1m_to_total_2m,
    cinema_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS cinema_trans_count_1m_to_total_2m,
    cinema_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS cinema_trans_sum_1m_to_total_2m,
    charity_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS charity_trans_count_1m_to_total_2m,
    charity_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS charity_trans_sum_1m_to_total_2m,
    money_transfers_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS money_transfers_trans_count_1m_to_total_2m,
    money_transfers_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS money_transfers_trans_sum_1m_to_total_2m,
    auto_services_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS auto_services_trans_count_1m_to_total_2m,
    auto_services_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS auto_services_trans_sum_1m_to_total_2m,
    services_consulting_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS services_consulting_trans_count_1m_to_total_2m,
    services_consulting_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS services_consulting_trans_sum_1m_to_total_2m,
    cash_withdrawal_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS cash_withdrawal_trans_count_1m_to_total_2m,
    cash_withdrawal_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS cash_withdrawal_trans_sum_1m_to_total_2m,
    other_expenses_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS other_expenses_trans_count_1m_to_total_2m,
    other_expenses_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS other_expenses_trans_sum_1m_to_total_2m,
    utilities_communication_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS utilities_communication_trans_count_1m_to_total_2m,
    utilities_communication_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS utilities_communication_trans_sum_1m_to_total_2m,
    electronics_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS electronics_trans_count_1m_to_total_2m,
    electronics_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS electronics_trans_sum_1m_to_total_2m,
    jewelry_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS jewelry_trans_count_1m_to_total_2m,
    jewelry_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS jewelry_trans_sum_1m_to_total_2m,
    clothing_shoes_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS clothing_shoes_trans_count_1m_to_total_2m,
    clothing_shoes_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS clothing_shoes_trans_sum_1m_to_total_2m,
    education_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS education_trans_count_1m_to_total_2m,
    education_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS education_trans_sum_1m_to_total_2m,
    finance_trans_count_1m / NULLIF(total_trans_count_2m, 0) AS finance_trans_count_1m_to_total_2m,
    finance_trans_sum_1m / NULLIF(total_trans_sum_2m, 0) AS finance_trans_sum_1m_to_total_2m,

    -- Отношение 2 месяца по категориям к 2 месяцам всех транзакций
    dom_rem_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS dom_rem_trans_count_2m_to_total_2m,
    dom_rem_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS dom_rem_trans_sum_2m_to_total_2m,
    cafe_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS cafe_trans_count_2m_to_total_2m,
    cafe_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS cafe_trans_sum_2m_to_total_2m,
    rent_auto_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS rent_auto_trans_count_2m_to_total_2m,
    rent_auto_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS rent_auto_trans_sum_2m_to_total_2m,
    transport_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS transport_trans_count_2m_to_total_2m,
    transport_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS transport_trans_sum_2m_to_total_2m,
    travel_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS travel_trans_count_2m_to_total_2m,
    travel_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS travel_trans_sum_2m_to_total_2m,
    medicine_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS medicine_trans_count_2m_to_total_2m,
    medicine_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS medicine_trans_sum_2m_to_total_2m,
    online_shops_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS online_shops_trans_count_2m_to_total_2m,
    online_shops_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS online_shops_trans_sum_2m_to_total_2m,
    music_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS music_trans_count_2m_to_total_2m,
    music_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS music_trans_sum_2m_to_total_2m,
    lombards_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS lombards_trans_count_2m_to_total_2m,
    lombards_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS lombards_trans_sum_2m_to_total_2m,
    zoo_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS zoo_trans_count_2m_to_total_2m,
    zoo_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS zoo_trans_sum_2m_to_total_2m,
    air_tickets_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS air_tickets_trans_count_2m_to_total_2m,
    air_tickets_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS air_tickets_trans_sum_2m_to_total_2m,
    hotels_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS hotels_trans_count_2m_to_total_2m,
    hotels_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS hotels_trans_sum_2m_to_total_2m,
    courier_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS courier_trans_count_2m_to_total_2m,
    courier_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS courier_trans_sum_2m_to_total_2m,
    souvenirs_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS souvenirs_trans_count_2m_to_total_2m,
    souvenirs_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS souvenirs_trans_sum_2m_to_total_2m,
    card_transfer_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS card_transfer_trans_count_2m_to_total_2m,
    card_transfer_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS card_transfer_trans_sum_2m_to_total_2m,
    entertainment_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS entertainment_trans_count_2m_to_total_2m,
    entertainment_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS entertainment_trans_sum_2m_to_total_2m,
    taxes_fines_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS taxes_fines_trans_count_2m_to_total_2m,
    taxes_fines_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS taxes_fines_trans_sum_2m_to_total_2m,
    supermarkets_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS supermarkets_trans_count_2m_to_total_2m,
    supermarkets_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS supermarkets_trans_sum_2m_to_total_2m,
    sport_goods_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS sport_goods_trans_count_2m_to_total_2m,
    sport_goods_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS sport_goods_trans_sum_2m_to_total_2m,
    sber_services_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS sber_services_trans_count_2m_to_total_2m,
    sber_services_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS sber_services_trans_sum_2m_to_total_2m,
    gov_services_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS gov_services_trans_count_2m_to_total_2m,
    gov_services_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS gov_services_trans_sum_2m_to_total_2m,
    art_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS art_trans_count_2m_to_total_2m,
    art_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS art_trans_sum_2m_to_total_2m,
    pharmacies_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS pharmacies_trans_count_2m_to_total_2m,
    pharmacies_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS pharmacies_trans_sum_2m_to_total_2m,
    flowers_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS flowers_trans_count_2m_to_total_2m,
    flowers_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS flowers_trans_sum_2m_to_total_2m,
    train_tickets_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS train_tickets_trans_count_2m_to_total_2m,
    train_tickets_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS train_tickets_trans_sum_2m_to_total_2m,
    gambling_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS gambling_trans_count_2m_to_total_2m,
    gambling_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS gambling_trans_sum_2m_to_total_2m,
    digital_goods_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS digital_goods_trans_count_2m_to_total_2m,
    digital_goods_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS digital_goods_trans_sum_2m_to_total_2m,
    books_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS books_trans_count_2m_to_total_2m,
    books_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS books_trans_sum_2m_to_total_2m,
    fuel_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS fuel_trans_count_2m_to_total_2m,
    fuel_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS fuel_trans_sum_2m_to_total_2m,
    yandex_services_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS yandex_services_trans_count_2m_to_total_2m,
    yandex_services_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS yandex_services_trans_sum_2m_to_total_2m,
    beauty_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS beauty_trans_count_2m_to_total_2m,
    beauty_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS beauty_trans_sum_2m_to_total_2m,
    cinema_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS cinema_trans_count_2m_to_total_2m,
    cinema_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS cinema_trans_sum_2m_to_total_2m,
    charity_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS charity_trans_count_2m_to_total_2m,
    charity_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS charity_trans_sum_2m_to_total_2m,
    money_transfers_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS money_transfers_trans_count_2m_to_total_2m,
    money_transfers_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS money_transfers_trans_sum_2m_to_total_2m,
    auto_services_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS auto_services_trans_count_2m_to_total_2m,
    auto_services_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS auto_services_trans_sum_2m_to_total_2m,
    services_consulting_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS services_consulting_trans_count_2m_to_total_2m,
    services_consulting_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS services_consulting_trans_sum_2m_to_total_2m,
    cash_withdrawal_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS cash_withdrawal_trans_count_2m_to_total_2m,
    cash_withdrawal_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS cash_withdrawal_trans_sum_2m_to_total_2m,
    other_expenses_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS other_expenses_trans_count_2m_to_total_2m,
    other_expenses_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS other_expenses_trans_sum_2m_to_total_2m,
    utilities_communication_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS utilities_communication_trans_count_2m_to_total_2m,
    utilities_communication_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS utilities_communication_trans_sum_2m_to_total_2m,
    electronics_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS electronics_trans_count_2m_to_total_2m,
    electronics_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS electronics_trans_sum_2m_to_total_2m,
    jewelry_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS jewelry_trans_count_2m_to_total_2m,
    jewelry_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS jewelry_trans_sum_2m_to_total_2m,
    clothing_shoes_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS clothing_shoes_trans_count_2m_to_total_2m,
    clothing_shoes_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS clothing_shoes_trans_sum_2m_to_total_2m,
    education_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS education_trans_count_2m_to_total_2m,
    education_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS education_trans_sum_2m_to_total_2m,
    finance_trans_count_2m / NULLIF(total_trans_count_2m, 0) AS finance_trans_count_2m_to_total_2m,
    finance_trans_sum_2m / NULLIF(total_trans_sum_2m, 0) AS finance_trans_sum_2m_to_total_2m,

    -- Отношение 2 месяца по категориям к 4 месяцам всех трат
    dom_rem_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS dom_rem_trans_count_2m_to_total_4m,
    dom_rem_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS dom_rem_trans_sum_2m_to_total_4m,
    cafe_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS cafe_trans_count_2m_to_total_4m,
    cafe_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS cafe_trans_sum_2m_to_total_4m,
    rent_auto_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS rent_auto_trans_count_2m_to_total_4m,
    rent_auto_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS rent_auto_trans_sum_2m_to_total_4m,
    transport_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS transport_trans_count_2m_to_total_4m,
    transport_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS transport_trans_sum_2m_to_total_4m,
    travel_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS travel_trans_count_2m_to_total_4m,
    travel_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS travel_trans_sum_2m_to_total_4m,
    medicine_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS medicine_trans_count_2m_to_total_4m,
    medicine_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS medicine_trans_sum_2m_to_total_4m,
    online_shops_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS online_shops_trans_count_2m_to_total_4m,
    online_shops_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS online_shops_trans_sum_2m_to_total_4m,
    music_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS music_trans_count_2m_to_total_4m,
    music_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS music_trans_sum_2m_to_total_4m,
    lombards_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS lombards_trans_count_2m_to_total_4m,
    lombards_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS lombards_trans_sum_2m_to_total_4m,
    zoo_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS zoo_trans_count_2m_to_total_4m,
    zoo_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS zoo_trans_sum_2m_to_total_4m,
    air_tickets_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS air_tickets_trans_count_2m_to_total_4m,
    air_tickets_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS air_tickets_trans_sum_2m_to_total_4m,
    hotels_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS hotels_trans_count_2m_to_total_4m,
    hotels_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS hotels_trans_sum_2m_to_total_4m,
    courier_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS courier_trans_count_2m_to_total_4m,
    courier_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS courier_trans_sum_2m_to_total_4m,
    souvenirs_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS souvenirs_trans_count_2m_to_total_4m,
    souvenirs_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS souvenirs_trans_sum_2m_to_total_4m,
    card_transfer_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS card_transfer_trans_count_2m_to_total_4m,
    card_transfer_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS card_transfer_trans_sum_2m_to_total_4m,
    entertainment_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS entertainment_trans_count_2m_to_total_4m,
    entertainment_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS entertainment_trans_sum_2m_to_total_4m,
    taxes_fines_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS taxes_fines_trans_count_2m_to_total_4m,
    taxes_fines_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS taxes_fines_trans_sum_2m_to_total_4m,
    supermarkets_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS supermarkets_trans_count_2m_to_total_4m,
    supermarkets_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS supermarkets_trans_sum_2m_to_total_4m,
    sport_goods_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS sport_goods_trans_count_2m_to_total_4m,
    sport_goods_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS sport_goods_trans_sum_2m_to_total_4m,
    sber_services_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS sber_services_trans_count_2m_to_total_4m,
    sber_services_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS sber_services_trans_sum_2m_to_total_4m,
    gov_services_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS gov_services_trans_count_2m_to_total_4m,
    gov_services_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS gov_services_trans_sum_2m_to_total_4m,
    art_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS art_trans_count_2m_to_total_4m,
    art_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS art_trans_sum_2m_to_total_4m,
    pharmacies_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS pharmacies_trans_count_2m_to_total_4m,
    pharmacies_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS pharmacies_trans_sum_2m_to_total_4m,
    flowers_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS flowers_trans_count_2m_to_total_4m,
    flowers_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS flowers_trans_sum_2m_to_total_4m,
    train_tickets_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS train_tickets_trans_count_2m_to_total_4m,
    train_tickets_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS train_tickets_trans_sum_2m_to_total_4m,
    gambling_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS gambling_trans_count_2m_to_total_4m,
    gambling_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS gambling_trans_sum_2m_to_total_4m,
    digital_goods_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS digital_goods_trans_count_2m_to_total_4m,
    digital_goods_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS digital_goods_trans_sum_2m_to_total_4m,
    books_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS books_trans_count_2m_to_total_4m,
    books_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS books_trans_sum_2m_to_total_4m,
    fuel_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS fuel_trans_count_2m_to_total_4m,
    fuel_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS fuel_trans_sum_2m_to_total_4m,
    yandex_services_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS yandex_services_trans_count_2m_to_total_4m,
    yandex_services_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS yandex_services_trans_sum_2m_to_total_4m,
    beauty_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS beauty_trans_count_2m_to_total_4m,
    beauty_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS beauty_trans_sum_2m_to_total_4m,
    cinema_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS cinema_trans_count_2m_to_total_4m,
    cinema_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS cinema_trans_sum_2m_to_total_4m,
    charity_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS charity_trans_count_2m_to_total_4m,
    charity_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS charity_trans_sum_2m_to_total_4m,
    money_transfers_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS money_transfers_trans_count_2m_to_total_4m,
    money_transfers_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS money_transfers_trans_sum_2m_to_total_4m,
    auto_services_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS auto_services_trans_count_2m_to_total_4m,
    auto_services_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS auto_services_trans_sum_2m_to_total_4m,
    services_consulting_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS services_consulting_trans_count_2m_to_total_4m,
    services_consulting_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS services_consulting_trans_sum_2m_to_total_4m,
    cash_withdrawal_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS cash_withdrawal_trans_count_2m_to_total_4m,
    cash_withdrawal_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS cash_withdrawal_trans_sum_2m_to_total_4m,
    other_expenses_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS other_expenses_trans_count_2m_to_total_4m,
    other_expenses_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS other_expenses_trans_sum_2m_to_total_4m,
    utilities_communication_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS utilities_communication_trans_count_2m_to_total_4m,
    utilities_communication_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS utilities_communication_trans_sum_2m_to_total_4m,
    electronics_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS electronics_trans_count_2m_to_total_4m,
    electronics_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS electronics_trans_sum_2m_to_total_4m,
    jewelry_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS jewelry_trans_count_2m_to_total_4m,
    jewelry_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS jewelry_trans_sum_2m_to_total_4m,
    clothing_shoes_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS clothing_shoes_trans_count_2m_to_total_4m,
    clothing_shoes_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS clothing_shoes_trans_sum_2m_to_total_4m,
    education_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS education_trans_count_2m_to_total_4m,
    education_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS education_trans_sum_2m_to_total_4m,
    finance_trans_count_2m / NULLIF(total_trans_count_4m, 0) AS finance_trans_count_2m_to_total_4m,
    finance_trans_sum_2m / NULLIF(total_trans_sum_4m, 0) AS finance_trans_sum_2m_to_total_4m,

    -- Отношение 2 месяца по категориям к 6 месяцам всех трат
    dom_rem_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS dom_rem_trans_count_2m_to_total_6m,
    dom_rem_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS dom_rem_trans_sum_2m_to_total_6m,
    cafe_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS cafe_trans_count_2m_to_total_6m,
    cafe_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS cafe_trans_sum_2m_to_total_6m,
    rent_auto_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS rent_auto_trans_count_2m_to_total_6m,
    rent_auto_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS rent_auto_trans_sum_2m_to_total_6m,
    transport_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS transport_trans_count_2m_to_total_6m,
    transport_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS transport_trans_sum_2m_to_total_6m,
    travel_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS travel_trans_count_2m_to_total_6m,
    travel_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS travel_trans_sum_2m_to_total_6m,
    medicine_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS medicine_trans_count_2m_to_total_6m,
    medicine_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS medicine_trans_sum_2m_to_total_6m,
    online_shops_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS online_shops_trans_count_2m_to_total_6m,
    online_shops_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS online_shops_trans_sum_2m_to_total_6m,
    music_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS music_trans_count_2m_to_total_6m,
    music_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS music_trans_sum_2m_to_total_6m,
    lombards_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS lombards_trans_count_2m_to_total_6m,
    lombards_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS lombards_trans_sum_2m_to_total_6m,
    zoo_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS zoo_trans_count_2m_to_total_6m,
    zoo_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS zoo_trans_sum_2m_to_total_6m,
    air_tickets_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS air_tickets_trans_count_2m_to_total_6m,
    air_tickets_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS air_tickets_trans_sum_2m_to_total_6m,
    hotels_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS hotels_trans_count_2m_to_total_6m,
    hotels_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS hotels_trans_sum_2m_to_total_6m,
    courier_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS courier_trans_count_2m_to_total_6m,
    courier_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS courier_trans_sum_2m_to_total_6m,
    souvenirs_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS souvenirs_trans_count_2m_to_total_6m,
    souvenirs_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS souvenirs_trans_sum_2m_to_total_6m,
    card_transfer_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS card_transfer_trans_count_2m_to_total_6m,
    card_transfer_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS card_transfer_trans_sum_2m_to_total_6m,
    entertainment_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS entertainment_trans_count_2m_to_total_6m,
    entertainment_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS entertainment_trans_sum_2m_to_total_6m,
    taxes_fines_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS taxes_fines_trans_count_2m_to_total_6m,
    taxes_fines_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS taxes_fines_trans_sum_2m_to_total_6m,
    supermarkets_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS supermarkets_trans_count_2m_to_total_6m,
    supermarkets_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS supermarkets_trans_sum_2m_to_total_6m,
    sport_goods_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS sport_goods_trans_count_2m_to_total_6m,
    sport_goods_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS sport_goods_trans_sum_2m_to_total_6m,
    sber_services_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS sber_services_trans_count_2m_to_total_6m,
    sber_services_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS sber_services_trans_sum_2m_to_total_6m,
    gov_services_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS gov_services_trans_count_2m_to_total_6m,
    gov_services_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS gov_services_trans_sum_2m_to_total_6m,
    art_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS art_trans_count_2m_to_total_6m,
    art_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS art_trans_sum_2m_to_total_6m,
    pharmacies_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS pharmacies_trans_count_2m_to_total_6m,
    pharmacies_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS pharmacies_trans_sum_2m_to_total_6m,
    flowers_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS flowers_trans_count_2m_to_total_6m,
    flowers_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS flowers_trans_sum_2m_to_total_6m,
    train_tickets_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS train_tickets_trans_count_2m_to_total_6m,
    train_tickets_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS train_tickets_trans_sum_2m_to_total_6m,
    gambling_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS gambling_trans_count_2m_to_total_6m,
    gambling_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS gambling_trans_sum_2m_to_total_6m,
    digital_goods_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS digital_goods_trans_count_2m_to_total_6m,
    digital_goods_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS digital_goods_trans_sum_2m_to_total_6m,
    books_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS books_trans_count_2m_to_total_6m,
    books_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS books_trans_sum_2m_to_total_6m,
    fuel_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS fuel_trans_count_2m_to_total_6m,
    fuel_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS fuel_trans_sum_2m_to_total_6m,
    yandex_services_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS yandex_services_trans_count_2m_to_total_6m,
    yandex_services_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS yandex_services_trans_sum_2m_to_total_6m,
    beauty_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS beauty_trans_count_2m_to_total_6m,
    beauty_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS beauty_trans_sum_2m_to_total_6m,
    cinema_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS cinema_trans_count_2m_to_total_6m,
    cinema_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS cinema_trans_sum_2m_to_total_6m,
    charity_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS charity_trans_count_2m_to_total_6m,
    charity_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS charity_trans_sum_2m_to_total_6m,
    money_transfers_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS money_transfers_trans_count_2m_to_total_6m,
    money_transfers_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS money_transfers_trans_sum_2m_to_total_6m,
    auto_services_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS auto_services_trans_count_2m_to_total_6m,
    auto_services_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS auto_services_trans_sum_2m_to_total_6m,
    services_consulting_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS services_consulting_trans_count_2m_to_total_6m,
    services_consulting_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS services_consulting_trans_sum_2m_to_total_6m,
    cash_withdrawal_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS cash_withdrawal_trans_count_2m_to_total_6m,
    cash_withdrawal_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS cash_withdrawal_trans_sum_2m_to_total_6m,
    other_expenses_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS other_expenses_trans_count_2m_to_total_6m,
    other_expenses_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS other_expenses_trans_sum_2m_to_total_6m,
    utilities_communication_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS utilities_communication_trans_count_2m_to_total_6m,
    utilities_communication_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS utilities_communication_trans_sum_2m_to_total_6m,
    electronics_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS electronics_trans_count_2m_to_total_6m,
    electronics_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS electronics_trans_sum_2m_to_total_6m,
    jewelry_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS jewelry_trans_count_2m_to_total_6m,
    jewelry_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS jewelry_trans_sum_2m_to_total_6m,
    clothing_shoes_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS clothing_shoes_trans_count_2m_to_total_6m,
    clothing_shoes_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS clothing_shoes_trans_sum_2m_to_total_6m,
    education_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS education_trans_count_2m_to_total_6m,
    education_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS education_trans_sum_2m_to_total_6m,
    finance_trans_count_2m / NULLIF(total_trans_count_6m, 0) AS finance_trans_count_2m_to_total_6m,
    finance_trans_sum_2m / NULLIF(total_trans_sum_6m, 0) AS finance_trans_sum_2m_to_total_6m,

    -- Отношение 3 месяца по категориям к 3 месяцам всех трат
    dom_rem_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS dom_rem_trans_count_3m_to_total_3m,
    dom_rem_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS dom_rem_trans_sum_3m_to_total_3m,
    cafe_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS cafe_trans_count_3m_to_total_3m,
    cafe_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS cafe_trans_sum_3m_to_total_3m,
    rent_auto_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS rent_auto_trans_count_3m_to_total_3m,
    rent_auto_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS rent_auto_trans_sum_3m_to_total_3m,
    transport_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS transport_trans_count_3m_to_total_3m,
    transport_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS transport_trans_sum_3m_to_total_3m,
    travel_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS travel_trans_count_3m_to_total_3m,
    travel_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS travel_trans_sum_3m_to_total_3m,
    medicine_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS medicine_trans_count_3m_to_total_3m,
    medicine_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS medicine_trans_sum_3m_to_total_3m,
    online_shops_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS online_shops_trans_count_3m_to_total_3m,
    online_shops_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS online_shops_trans_sum_3m_to_total_3m,
    music_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS music_trans_count_3m_to_total_3m,
    music_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS music_trans_sum_3m_to_total_3m,
    lombards_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS lombards_trans_count_3m_to_total_3m,
    lombards_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS lombards_trans_sum_3m_to_total_3m,
    zoo_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS zoo_trans_count_3m_to_total_3m,
    zoo_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS zoo_trans_sum_3m_to_total_3m,
    air_tickets_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS air_tickets_trans_count_3m_to_total_3m,
    air_tickets_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS air_tickets_trans_sum_3m_to_total_3m,
    hotels_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS hotels_trans_count_3m_to_total_3m,
    hotels_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS hotels_trans_sum_3m_to_total_3m,
    courier_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS courier_trans_count_3m_to_total_3m,
    courier_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS courier_trans_sum_3m_to_total_3m,
    souvenirs_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS souvenirs_trans_count_3m_to_total_3m,
    souvenirs_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS souvenirs_trans_sum_3m_to_total_3m,
    card_transfer_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS card_transfer_trans_count_3m_to_total_3m,
    card_transfer_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS card_transfer_trans_sum_3m_to_total_3m,
    entertainment_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS entertainment_trans_count_3m_to_total_3m,
    entertainment_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS entertainment_trans_sum_3m_to_total_3m,
    taxes_fines_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS taxes_fines_trans_count_3m_to_total_3m,
    taxes_fines_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS taxes_fines_trans_sum_3m_to_total_3m,
    supermarkets_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS supermarkets_trans_count_3m_to_total_3m,
    supermarkets_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS supermarkets_trans_sum_3m_to_total_3m,
    sport_goods_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS sport_goods_trans_count_3m_to_total_3m,
    sport_goods_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS sport_goods_trans_sum_3m_to_total_3m,
    sber_services_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS sber_services_trans_count_3m_to_total_3m,
    sber_services_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS sber_services_trans_sum_3m_to_total_3m,
    gov_services_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS gov_services_trans_count_3m_to_total_3m,
    gov_services_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS gov_services_trans_sum_3m_to_total_3m,
    art_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS art_trans_count_3m_to_total_3m,
    art_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS art_trans_sum_3m_to_total_3m,
    pharmacies_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS pharmacies_trans_count_3m_to_total_3m,
    pharmacies_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS pharmacies_trans_sum_3m_to_total_3m,
    flowers_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS flowers_trans_count_3m_to_total_3m,
    flowers_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS flowers_trans_sum_3m_to_total_3m,
    train_tickets_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS train_tickets_trans_count_3m_to_total_3m,
    train_tickets_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS train_tickets_trans_sum_3m_to_total_3m,
    gambling_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS gambling_trans_count_3m_to_total_3m,
    gambling_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS gambling_trans_sum_3m_to_total_3m,
    digital_goods_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS digital_goods_trans_count_3m_to_total_3m,
    digital_goods_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS digital_goods_trans_sum_3m_to_total_3m,
    books_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS books_trans_count_3m_to_total_3m,
    books_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS books_trans_sum_3m_to_total_3m,
    fuel_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS fuel_trans_count_3m_to_total_3m,
    fuel_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS fuel_trans_sum_3m_to_total_3m,
    yandex_services_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS yandex_services_trans_count_3m_to_total_3m,
    yandex_services_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS yandex_services_trans_sum_3m_to_total_3m,
    beauty_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS beauty_trans_count_3m_to_total_3m,
    beauty_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS beauty_trans_sum_3m_to_total_3m,
    cinema_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS cinema_trans_count_3m_to_total_3m,
    cinema_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS cinema_trans_sum_3m_to_total_3m,
    charity_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS charity_trans_count_3m_to_total_3m,
    charity_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS charity_trans_sum_3m_to_total_3m,
    money_transfers_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS money_transfers_trans_count_3m_to_total_3m,
    money_transfers_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS money_transfers_trans_sum_3m_to_total_3m,
    auto_services_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS auto_services_trans_count_3m_to_total_3m,
    auto_services_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS auto_services_trans_sum_3m_to_total_3m,
    services_consulting_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS services_consulting_trans_count_3m_to_total_3m,
    services_consulting_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS services_consulting_trans_sum_3m_to_total_3m,
    cash_withdrawal_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS cash_withdrawal_trans_count_3m_to_total_3m,
    cash_withdrawal_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS cash_withdrawal_trans_sum_3m_to_total_3m,
    other_expenses_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS other_expenses_trans_count_3m_to_total_3m,
    other_expenses_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS other_expenses_trans_sum_3m_to_total_3m,
    utilities_communication_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS utilities_communication_trans_count_3m_to_total_3m,
    utilities_communication_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS utilities_communication_trans_sum_3m_to_total_3m,
    electronics_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS electronics_trans_count_3m_to_total_3m,
    electronics_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS electronics_trans_sum_3m_to_total_3m,
    jewelry_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS jewelry_trans_count_3m_to_total_3m,
    jewelry_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS jewelry_trans_sum_3m_to_total_3m,
    clothing_shoes_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS clothing_shoes_trans_count_3m_to_total_3m,
    clothing_shoes_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS clothing_shoes_trans_sum_3m_to_total_3m,
    education_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS education_trans_count_3m_to_total_3m,
    education_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS education_trans_sum_3m_to_total_3m,
    finance_trans_count_3m / NULLIF(total_trans_count_3m, 0) AS finance_trans_count_3m_to_total_3m,
    finance_trans_sum_3m / NULLIF(total_trans_sum_3m, 0) AS finance_trans_sum_3m_to_total_3m,

    -- Отношение 3 месяца по категориям к 6 месяцам всех трат
    dom_rem_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS dom_rem_trans_count_3m_to_total_6m,
    dom_rem_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS dom_rem_trans_sum_3m_to_total_6m,
    cafe_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS cafe_trans_count_3m_to_total_6m,
    cafe_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS cafe_trans_sum_3m_to_total_6m,
    rent_auto_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS rent_auto_trans_count_3m_to_total_6m,
    rent_auto_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS rent_auto_trans_sum_3m_to_total_6m,
    transport_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS transport_trans_count_3m_to_total_6m,
    transport_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS transport_trans_sum_3m_to_total_6m,
    travel_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS travel_trans_count_3m_to_total_6m,
    travel_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS travel_trans_sum_3m_to_total_6m,
    medicine_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS medicine_trans_count_3m_to_total_6m,
    medicine_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS medicine_trans_sum_3m_to_total_6m,
    online_shops_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS online_shops_trans_count_3m_to_total_6m,
    online_shops_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS online_shops_trans_sum_3m_to_total_6m,
    music_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS music_trans_count_3m_to_total_6m,
    music_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS music_trans_sum_3m_to_total_6m,
    lombards_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS lombards_trans_count_3m_to_total_6m,
    lombards_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS lombards_trans_sum_3m_to_total_6m,
    zoo_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS zoo_trans_count_3m_to_total_6m,
    zoo_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS zoo_trans_sum_3m_to_total_6m,
    air_tickets_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS air_tickets_trans_count_3m_to_total_6m,
    air_tickets_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS air_tickets_trans_sum_3m_to_total_6m,
    hotels_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS hotels_trans_count_3m_to_total_6m,
    hotels_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS hotels_trans_sum_3m_to_total_6m,
    courier_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS courier_trans_count_3m_to_total_6m,
    courier_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS courier_trans_sum_3m_to_total_6m,
    souvenirs_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS souvenirs_trans_count_3m_to_total_6m,
    souvenirs_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS souvenirs_trans_sum_3m_to_total_6m,
    card_transfer_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS card_transfer_trans_count_3m_to_total_6m,
    card_transfer_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS card_transfer_trans_sum_3m_to_total_6m,
    entertainment_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS entertainment_trans_count_3m_to_total_6m,
    entertainment_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS entertainment_trans_sum_3m_to_total_6m,
    taxes_fines_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS taxes_fines_trans_count_3m_to_total_6m,
    taxes_fines_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS taxes_fines_trans_sum_3m_to_total_6m,
    supermarkets_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS supermarkets_trans_count_3m_to_total_6m,
    supermarkets_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS supermarkets_trans_sum_3m_to_total_6m,
    sport_goods_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS sport_goods_trans_count_3m_to_total_6m,
    sport_goods_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS sport_goods_trans_sum_3m_to_total_6m,
    sber_services_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS sber_services_trans_count_3m_to_total_6m,
    sber_services_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS sber_services_trans_sum_3m_to_total_6m,
    gov_services_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS gov_services_trans_count_3m_to_total_6m,
    gov_services_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS gov_services_trans_sum_3m_to_total_6m,
    art_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS art_trans_count_3m_to_total_6m,
    art_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS art_trans_sum_3m_to_total_6m,
    pharmacies_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS pharmacies_trans_count_3m_to_total_6m,
    pharmacies_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS pharmacies_trans_sum_3m_to_total_6m,
    flowers_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS flowers_trans_count_3m_to_total_6m,
    flowers_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS flowers_trans_sum_3m_to_total_6m,
    train_tickets_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS train_tickets_trans_count_3m_to_total_6m,
    train_tickets_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS train_tickets_trans_sum_3m_to_total_6m,
    gambling_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS gambling_trans_count_3m_to_total_6m,
    gambling_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS gambling_trans_sum_3m_to_total_6m,
    digital_goods_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS digital_goods_trans_count_3m_to_total_6m,
    digital_goods_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS digital_goods_trans_sum_3m_to_total_6m,
    books_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS books_trans_count_3m_to_total_6m,
    books_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS books_trans_sum_3m_to_total_6m,
    fuel_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS fuel_trans_count_3m_to_total_6m,
    fuel_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS fuel_trans_sum_3m_to_total_6m,
    yandex_services_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS yandex_services_trans_count_3m_to_total_6m,
    yandex_services_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS yandex_services_trans_sum_3m_to_total_6m,
    beauty_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS beauty_trans_count_3m_to_total_6m,
    beauty_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS beauty_trans_sum_3m_to_total_6m,
    cinema_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS cinema_trans_count_3m_to_total_6m,
    cinema_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS cinema_trans_sum_3m_to_total_6m,
    charity_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS charity_trans_count_3m_to_total_6m,
    charity_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS charity_trans_sum_3m_to_total_6m,
    money_transfers_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS money_transfers_trans_count_3m_to_total_6m,
    money_transfers_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS money_transfers_trans_sum_3m_to_total_6m,
    auto_services_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS auto_services_trans_count_3m_to_total_6m,
    auto_services_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS auto_services_trans_sum_3m_to_total_6m,
    services_consulting_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS services_consulting_trans_count_3m_to_total_6m,
    services_consulting_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS services_consulting_trans_sum_3m_to_total_6m,
    cash_withdrawal_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS cash_withdrawal_trans_count_3m_to_total_6m,
    cash_withdrawal_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS cash_withdrawal_trans_sum_3m_to_total_6m,
    other_expenses_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS other_expenses_trans_count_3m_to_total_6m,
    other_expenses_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS other_expenses_trans_sum_3m_to_total_6m,
    utilities_communication_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS utilities_communication_trans_count_3m_to_total_6m,
    utilities_communication_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS utilities_communication_trans_sum_3m_to_total_6m,
    electronics_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS electronics_trans_count_3m_to_total_6m,
    electronics_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS electronics_trans_sum_3m_to_total_6m,
    jewelry_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS jewelry_trans_count_3m_to_total_6m,
    jewelry_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS jewelry_trans_sum_3m_to_total_6m,
    clothing_shoes_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS clothing_shoes_trans_count_3m_to_total_6m,
    clothing_shoes_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS clothing_shoes_trans_sum_3m_to_total_6m,
    education_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS education_trans_count_3m_to_total_6m,
    education_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS education_trans_sum_3m_to_total_6m,
    finance_trans_count_3m / NULLIF(total_trans_count_6m, 0) AS finance_trans_count_3m_to_total_6m,
    finance_trans_sum_3m / NULLIF(total_trans_sum_6m, 0) AS finance_trans_sum_3m_to_total_6m,

    -- Отношение 3 месяца по категориям к 12 месяцам всех трат
    dom_rem_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS dom_rem_trans_count_3m_to_total_12m,
    dom_rem_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS dom_rem_trans_sum_3m_to_total_12m,
    cafe_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS cafe_trans_count_3m_to_total_12m,
    cafe_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS cafe_trans_sum_3m_to_total_12m,
    rent_auto_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS rent_auto_trans_count_3m_to_total_12m,
    rent_auto_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS rent_auto_trans_sum_3m_to_total_12m,
    transport_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS transport_trans_count_3m_to_total_12m,
    transport_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS transport_trans_sum_3m_to_total_12m,
    travel_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS travel_trans_count_3m_to_total_12m,
    travel_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS travel_trans_sum_3m_to_total_12m,
    medicine_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS medicine_trans_count_3m_to_total_12m,
    medicine_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS medicine_trans_sum_3m_to_total_12m,
    online_shops_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS online_shops_trans_count_3m_to_total_12m,
    online_shops_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS online_shops_trans_sum_3m_to_total_12m,
    music_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS music_trans_count_3m_to_total_12m,
    music_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS music_trans_sum_3m_to_total_12m,
    lombards_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS lombards_trans_count_3m_to_total_12m,
    lombards_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS lombards_trans_sum_3m_to_total_12m,
    zoo_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS zoo_trans_count_3m_to_total_12m,
    zoo_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS zoo_trans_sum_3m_to_total_12m,
    air_tickets_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS air_tickets_trans_count_3m_to_total_12m,
    air_tickets_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS air_tickets_trans_sum_3m_to_total_12m,
    hotels_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS hotels_trans_count_3m_to_total_12m,
    hotels_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS hotels_trans_sum_3m_to_total_12m,
    courier_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS courier_trans_count_3m_to_total_12m,
    courier_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS courier_trans_sum_3m_to_total_12m,
    souvenirs_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS souvenirs_trans_count_3m_to_total_12m,
    souvenirs_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS souvenirs_trans_sum_3m_to_total_12m,
    card_transfer_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS card_transfer_trans_count_3m_to_total_12m,
    card_transfer_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS card_transfer_trans_sum_3m_to_total_12m,
    entertainment_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS entertainment_trans_count_3m_to_total_12m,
    entertainment_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS entertainment_trans_sum_3m_to_total_12m,
    taxes_fines_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS taxes_fines_trans_count_3m_to_total_12m,
    taxes_fines_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS taxes_fines_trans_sum_3m_to_total_12m,
    supermarkets_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS supermarkets_trans_count_3m_to_total_12m,
    supermarkets_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS supermarkets_trans_sum_3m_to_total_12m,
    sport_goods_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS sport_goods_trans_count_3m_to_total_12m,
    sport_goods_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS sport_goods_trans_sum_3m_to_total_12m,
    sber_services_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS sber_services_trans_count_3m_to_total_12m,
    sber_services_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS sber_services_trans_sum_3m_to_total_12m,
    gov_services_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS gov_services_trans_count_3m_to_total_12m,
    gov_services_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS gov_services_trans_sum_3m_to_total_12m,
    art_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS art_trans_count_3m_to_total_12m,
    art_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS art_trans_sum_3m_to_total_12m,
    pharmacies_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS pharmacies_trans_count_3m_to_total_12m,
    pharmacies_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS pharmacies_trans_sum_3m_to_total_12m,
    flowers_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS flowers_trans_count_3m_to_total_12m,
    flowers_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS flowers_trans_sum_3m_to_total_12m,
    train_tickets_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS train_tickets_trans_count_3m_to_total_12m,
    train_tickets_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS train_tickets_trans_sum_3m_to_total_12m,
    gambling_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS gambling_trans_count_3m_to_total_12m,
    gambling_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS gambling_trans_sum_3m_to_total_12m,
    digital_goods_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS digital_goods_trans_count_3m_to_total_12m,
    digital_goods_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS digital_goods_trans_sum_3m_to_total_12m,
    books_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS books_trans_count_3m_to_total_12m,
    books_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS books_trans_sum_3m_to_total_12m,
    fuel_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS fuel_trans_count_3m_to_total_12m,
    fuel_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS fuel_trans_sum_3m_to_total_12m,
    yandex_services_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS yandex_services_trans_count_3m_to_total_12m,
    yandex_services_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS yandex_services_trans_sum_3m_to_total_12m,
    beauty_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS beauty_trans_count_3m_to_total_12m,
    beauty_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS beauty_trans_sum_3m_to_total_12m,
    cinema_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS cinema_trans_count_3m_to_total_12m,
    cinema_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS cinema_trans_sum_3m_to_total_12m,
    charity_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS charity_trans_count_3m_to_total_12m,
    charity_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS charity_trans_sum_3m_to_total_12m,
    money_transfers_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS money_transfers_trans_count_3m_to_total_12m,
    money_transfers_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS money_transfers_trans_sum_3m_to_total_12m,
    auto_services_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS auto_services_trans_count_3m_to_total_12m,
    auto_services_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS auto_services_trans_sum_3m_to_total_12m,
    services_consulting_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS services_consulting_trans_count_3m_to_total_12m,
    services_consulting_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS services_consulting_trans_sum_3m_to_total_12m,
    cash_withdrawal_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS cash_withdrawal_trans_count_3m_to_total_12m,
    cash_withdrawal_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS cash_withdrawal_trans_sum_3m_to_total_12m,
    other_expenses_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS other_expenses_trans_count_3m_to_total_12m,
    other_expenses_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS other_expenses_trans_sum_3m_to_total_12m,
    utilities_communication_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS utilities_communication_trans_count_3m_to_total_12m,
    utilities_communication_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS utilities_communication_trans_sum_3m_to_total_12m,
    electronics_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS electronics_trans_count_3m_to_total_12m,
    electronics_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS electronics_trans_sum_3m_to_total_12m,
    jewelry_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS jewelry_trans_count_3m_to_total_12m,
    jewelry_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS jewelry_trans_sum_3m_to_total_12m,
    clothing_shoes_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS clothing_shoes_trans_count_3m_to_total_12m,
    clothing_shoes_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS clothing_shoes_trans_sum_3m_to_total_12m,
    education_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS education_trans_count_3m_to_total_12m,
    education_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS education_trans_sum_3m_to_total_12m,
    finance_trans_count_3m / NULLIF(total_trans_count_12m, 0) AS finance_trans_count_3m_to_total_12m,
    finance_trans_sum_3m / NULLIF(total_trans_sum_12m, 0) AS finance_trans_sum_3m_to_total_12m,

    -- Отношение 6 месяцев по категориям к 6 месяцам всех трат
    dom_rem_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS dom_rem_trans_count_6m_to_total_6m,
    dom_rem_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS dom_rem_trans_sum_6m_to_total_6m,
    cafe_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS cafe_trans_count_6m_to_total_6m,
    cafe_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS cafe_trans_sum_6m_to_total_6m,
    rent_auto_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS rent_auto_trans_count_6m_to_total_6m,
    rent_auto_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS rent_auto_trans_sum_6m_to_total_6m,
    transport_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS transport_trans_count_6m_to_total_6m,
    transport_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS transport_trans_sum_6m_to_total_6m,
    travel_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS travel_trans_count_6m_to_total_6m,
    travel_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS travel_trans_sum_6m_to_total_6m,
    medicine_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS medicine_trans_count_6m_to_total_6m,
    medicine_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS medicine_trans_sum_6m_to_total_6m,
    online_shops_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS online_shops_trans_count_6m_to_total_6m,
    online_shops_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS online_shops_trans_sum_6m_to_total_6m,
    music_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS music_trans_count_6m_to_total_6m,
    music_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS music_trans_sum_6m_to_total_6m,
    lombards_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS lombards_trans_count_6m_to_total_6m,
    lombards_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS lombards_trans_sum_6m_to_total_6m,
    zoo_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS zoo_trans_count_6m_to_total_6m,
    zoo_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS zoo_trans_sum_6m_to_total_6m,
    air_tickets_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS air_tickets_trans_count_6m_to_total_6m,
    air_tickets_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS air_tickets_trans_sum_6m_to_total_6m,
    hotels_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS hotels_trans_count_6m_to_total_6m,
    hotels_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS hotels_trans_sum_6m_to_total_6m,
    courier_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS courier_trans_count_6m_to_total_6m,
    courier_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS courier_trans_sum_6m_to_total_6m,
    souvenirs_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS souvenirs_trans_count_6m_to_total_6m,
    souvenirs_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS souvenirs_trans_sum_6m_to_total_6m,
    card_transfer_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS card_transfer_trans_count_6m_to_total_6m,
    card_transfer_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS card_transfer_trans_sum_6m_to_total_6m,
    entertainment_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS entertainment_trans_count_6m_to_total_6m,
    entertainment_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS entertainment_trans_sum_6m_to_total_6m,
    taxes_fines_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS taxes_fines_trans_count_6m_to_total_6m,
    taxes_fines_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS taxes_fines_trans_sum_6m_to_total_6m,
    supermarkets_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS supermarkets_trans_count_6m_to_total_6m,
    supermarkets_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS supermarkets_trans_sum_6m_to_total_6m,
    sport_goods_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS sport_goods_trans_count_6m_to_total_6m,
    sport_goods_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS sport_goods_trans_sum_6m_to_total_6m,
    sber_services_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS sber_services_trans_count_6m_to_total_6m,
    sber_services_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS sber_services_trans_sum_6m_to_total_6m,
    gov_services_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS gov_services_trans_count_6m_to_total_6m,
    gov_services_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS gov_services_trans_sum_6m_to_total_6m,
    art_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS art_trans_count_6m_to_total_6m,
    art_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS art_trans_sum_6m_to_total_6m,
    pharmacies_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS pharmacies_trans_count_6m_to_total_6m,
    pharmacies_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS pharmacies_trans_sum_6m_to_total_6m,
    flowers_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS flowers_trans_count_6m_to_total_6m,
    flowers_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS flowers_trans_sum_6m_to_total_6m,
    train_tickets_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS train_tickets_trans_count_6m_to_total_6m,
    train_tickets_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS train_tickets_trans_sum_6m_to_total_6m,
    gambling_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS gambling_trans_count_6m_to_total_6m,
    gambling_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS gambling_trans_sum_6m_to_total_6m,
    digital_goods_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS digital_goods_trans_count_6m_to_total_6m,
    digital_goods_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS digital_goods_trans_sum_6m_to_total_6m,
    books_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS books_trans_count_6m_to_total_6m,
    books_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS books_trans_sum_6m_to_total_6m,
    fuel_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS fuel_trans_count_6m_to_total_6m,
    fuel_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS fuel_trans_sum_6m_to_total_6m,
    yandex_services_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS yandex_services_trans_count_6m_to_total_6m,
    yandex_services_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS yandex_services_trans_sum_6m_to_total_6m,
    beauty_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS beauty_trans_count_6m_to_total_6m,
    beauty_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS beauty_trans_sum_6m_to_total_6m,
    cinema_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS cinema_trans_count_6m_to_total_6m,
    cinema_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS cinema_trans_sum_6m_to_total_6m,
    charity_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS charity_trans_count_6m_to_total_6m,
    charity_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS charity_trans_sum_6m_to_total_6m,
    money_transfers_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS money_transfers_trans_count_6m_to_total_6m,
    money_transfers_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS money_transfers_trans_sum_6m_to_total_6m,
    auto_services_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS auto_services_trans_count_6m_to_total_6m,
    auto_services_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS auto_services_trans_sum_6m_to_total_6m,
    services_consulting_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS services_consulting_trans_count_6m_to_total_6m,
    services_consulting_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS services_consulting_trans_sum_6m_to_total_6m,
    cash_withdrawal_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS cash_withdrawal_trans_count_6m_to_total_6m,
    cash_withdrawal_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS cash_withdrawal_trans_sum_6m_to_total_6m,
    other_expenses_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS other_expenses_trans_count_6m_to_total_6m,
    other_expenses_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS other_expenses_trans_sum_6m_to_total_6m,
    utilities_communication_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS utilities_communication_trans_count_6m_to_total_6m,
    utilities_communication_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS utilities_communication_trans_sum_6m_to_total_6m,
    electronics_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS electronics_trans_count_6m_to_total_6m,
    electronics_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS electronics_trans_sum_6m_to_total_6m,
    jewelry_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS jewelry_trans_count_6m_to_total_6m,
    jewelry_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS jewelry_trans_sum_6m_to_total_6m,
    clothing_shoes_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS clothing_shoes_trans_count_6m_to_total_6m,
    clothing_shoes_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS clothing_shoes_trans_sum_6m_to_total_6m,
    education_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS education_trans_count_6m_to_total_6m,
    education_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS education_trans_sum_6m_to_total_6m,
    finance_trans_count_6m / NULLIF(total_trans_count_6m, 0) AS finance_trans_count_6m_to_total_6m,
    finance_trans_sum_6m / NULLIF(total_trans_sum_6m, 0) AS finance_trans_sum_6m_to_total_6m,

    -- Отношение 6 месяцев по категориям к 12 месяцам всех трат
    dom_rem_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS dom_rem_trans_count_6m_to_total_12m,
    dom_rem_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS dom_rem_trans_sum_6m_to_total_12m,
    cafe_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS cafe_trans_count_6m_to_total_12m,
    cafe_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS cafe_trans_sum_6m_to_total_12m,
    rent_auto_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS rent_auto_trans_count_6m_to_total_12m,
    rent_auto_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS rent_auto_trans_sum_6m_to_total_12m,
    transport_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS transport_trans_count_6m_to_total_12m,
    transport_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS transport_trans_sum_6m_to_total_12m,
    travel_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS travel_trans_count_6m_to_total_12m,
    travel_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS travel_trans_sum_6m_to_total_12m,
    medicine_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS medicine_trans_count_6m_to_total_12m,
    medicine_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS medicine_trans_sum_6m_to_total_12m,
    online_shops_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS online_shops_trans_count_6m_to_total_12m,
    online_shops_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS online_shops_trans_sum_6m_to_total_12m,
    music_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS music_trans_count_6m_to_total_12m,
    music_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS music_trans_sum_6m_to_total_12m,
    lombards_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS lombards_trans_count_6m_to_total_12m,
    lombards_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS lombards_trans_sum_6m_to_total_12m,
    zoo_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS zoo_trans_count_6m_to_total_12m,
    zoo_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS zoo_trans_sum_6m_to_total_12m,
    air_tickets_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS air_tickets_trans_count_6m_to_total_12m,
    air_tickets_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS air_tickets_trans_sum_6m_to_total_12m,
    hotels_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS hotels_trans_count_6m_to_total_12m,
    hotels_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS hotels_trans_sum_6m_to_total_12m,
    courier_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS courier_trans_count_6m_to_total_12m,
    courier_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS courier_trans_sum_6m_to_total_12m,
    souvenirs_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS souvenirs_trans_count_6m_to_total_12m,
    souvenirs_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS souvenirs_trans_sum_6m_to_total_12m,
    card_transfer_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS card_transfer_trans_count_6m_to_total_12m,
    card_transfer_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS card_transfer_trans_sum_6m_to_total_12m,
    entertainment_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS entertainment_trans_count_6m_to_total_12m,
    entertainment_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS entertainment_trans_sum_6m_to_total_12m,
    taxes_fines_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS taxes_fines_trans_count_6m_to_total_12m,
    taxes_fines_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS taxes_fines_trans_sum_6m_to_total_12m,
    supermarkets_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS supermarkets_trans_count_6m_to_total_12m,
    supermarkets_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS supermarkets_trans_sum_6m_to_total_12m,
    sport_goods_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS sport_goods_trans_count_6m_to_total_12m,
    sport_goods_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS sport_goods_trans_sum_6m_to_total_12m,
    sber_services_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS sber_services_trans_count_6m_to_total_12m,
    sber_services_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS sber_services_trans_sum_6m_to_total_12m,
    gov_services_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS gov_services_trans_count_6m_to_total_12m,
    gov_services_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS gov_services_trans_sum_6m_to_total_12m,
    art_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS art_trans_count_6m_to_total_12m,
    art_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS art_trans_sum_6m_to_total_12m,
    pharmacies_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS pharmacies_trans_count_6m_to_total_12m,
    pharmacies_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS pharmacies_trans_sum_6m_to_total_12m,
    flowers_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS flowers_trans_count_6m_to_total_12m,
    flowers_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS flowers_trans_sum_6m_to_total_12m,
    train_tickets_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS train_tickets_trans_count_6m_to_total_12m,
    train_tickets_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS train_tickets_trans_sum_6m_to_total_12m,
    gambling_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS gambling_trans_count_6m_to_total_12m,
    gambling_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS gambling_trans_sum_6m_to_total_12m,
    digital_goods_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS digital_goods_trans_count_6m_to_total_12m,
    digital_goods_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS digital_goods_trans_sum_6m_to_total_12m,
    books_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS books_trans_count_6m_to_total_12m,
    books_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS books_trans_sum_6m_to_total_12m,
    fuel_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS fuel_trans_count_6m_to_total_12m,
    fuel_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS fuel_trans_sum_6m_to_total_12m,
    yandex_services_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS yandex_services_trans_count_6m_to_total_12m,
    yandex_services_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS yandex_services_trans_sum_6m_to_total_12m,
    beauty_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS beauty_trans_count_6m_to_total_12m,
    beauty_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS beauty_trans_sum_6m_to_total_12m,
    cinema_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS cinema_trans_count_6m_to_total_12m,
    cinema_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS cinema_trans_sum_6m_to_total_12m,
    charity_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS charity_trans_count_6m_to_total_12m,
    charity_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS charity_trans_sum_6m_to_total_12m,
    money_transfers_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS money_transfers_trans_count_6m_to_total_12m,
    money_transfers_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS money_transfers_trans_sum_6m_to_total_12m,
    auto_services_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS auto_services_trans_count_6m_to_total_12m,
    auto_services_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS auto_services_trans_sum_6m_to_total_12m,
    services_consulting_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS services_consulting_trans_count_6m_to_total_12m,
    services_consulting_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS services_consulting_trans_sum_6m_to_total_12m,
    cash_withdrawal_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS cash_withdrawal_trans_count_6m_to_total_12m,
    cash_withdrawal_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS cash_withdrawal_trans_sum_6m_to_total_12m,
    other_expenses_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS other_expenses_trans_count_6m_to_total_12m,
    other_expenses_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS other_expenses_trans_sum_6m_to_total_12m,
    utilities_communication_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS utilities_communication_trans_count_6m_to_total_12m,
    utilities_communication_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS utilities_communication_trans_sum_6m_to_total_12m,
    electronics_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS electronics_trans_count_6m_to_total_12m,
    electronics_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS electronics_trans_sum_6m_to_total_12m,
    jewelry_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS jewelry_trans_count_6m_to_total_12m,
    jewelry_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS jewelry_trans_sum_6m_to_total_12m,
    clothing_shoes_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS clothing_shoes_trans_count_6m_to_total_12m,
    clothing_shoes_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS clothing_shoes_trans_sum_6m_to_total_12m,
    education_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS education_trans_count_6m_to_total_12m,
    education_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS education_trans_sum_6m_to_total_12m,
    finance_trans_count_6m / NULLIF(total_trans_count_12m, 0) AS finance_trans_count_6m_to_total_12m,
    finance_trans_sum_6m / NULLIF(total_trans_sum_12m, 0) AS finance_trans_sum_6m_to_total_12m,

    -- Средняя транзакция за последний месяц
    total_trans_sum_1m / NULLIF(total_trans_count_1m, 0) AS avg_trans_1m,
    
    -- Средняя транзакция за предыдущий месяц (рассчитывается как разница между 2-м и 1-м месяцем)
    (total_trans_sum_2m - total_trans_sum_1m) / NULLIF((total_trans_count_2m - total_trans_count_1m), 0) AS avg_trans_prev_1m,
    
    -- Разница средней транзакции: последний месяц - предыдущий месяц
    (total_trans_sum_1m / NULLIF(total_trans_count_1m, 0) -
    (total_trans_sum_2m - total_trans_sum_1m) / NULLIF((total_trans_count_2m - total_trans_count_1m), 0)
    ) AS diff_avg_trans_1m,
    
    -- Средняя транзакция за последние 3 месяца
    total_trans_sum_3m / NULLIF(total_trans_count_3m, 0) AS avg_trans_3m,
    
    -- Средняя транзакция за предыдущие 3 месяца (рассчитывается как разница между 6-м и 3-м месяцем)
    (total_trans_sum_6m - total_trans_sum_3m) / NULLIF((total_trans_count_6m - total_trans_count_3m), 0) AS avg_trans_prev_3m,
    
    -- Разница средней транзакции: за последние 3 месяца - предыдущие 3 месяца
    (total_trans_sum_3m / NULLIF(total_trans_count_3m, 0) -
    (total_trans_sum_6m - total_trans_sum_3m) / NULLIF((total_trans_count_6m - total_trans_count_3m), 0)
    ) AS diff_avg_trans_3m,
    
    -- Средняя транзакция за последние 12 месяцев
    total_trans_sum_12m / NULLIF(total_trans_count_12m, 0) AS avg_trans_12m,
    
    -- Средняя транзакция за предыдущие 12 месяцев
    total_trans_sum_24_12 / NULLIF(total_trans_count_24_12, 0) AS avg_trans_prev_12m,
    
    -- Разница средней транзакции: за последние 12 месяцев - предыдущие 12 месяцев
    (total_trans_sum_12m / NULLIF(total_trans_count_12m, 0) -
    total_trans_sum_24_12 / NULLIF(total_trans_count_24_12, 0)
    ) AS diff_avg_trans_12m,
    
    -- Отношение средней транзакции: последний месяц / предыдущий месяц
    (total_trans_sum_1m / NULLIF(total_trans_count_1m, 0)) /
    ((total_trans_sum_2m - total_trans_sum_1m) / NULLIF((total_trans_count_2m - total_trans_count_1m), 0))
        AS ratio_avg_trans_1m,
    
    -- Отношение средней транзакции: последние 12 месяцев / предыдущие 12 месяцев
    (total_trans_sum_12m / NULLIF(total_trans_count_12m, 0)) /
    (total_trans_sum_24_12 / NULLIF(total_trans_count_24_12, 0))
        AS ratio_avg_trans_12m,
    
    -- Отношение средней транзакции: последние 3 месяца / предыдущие 3 месяца
    (total_trans_sum_3m / NULLIF(total_trans_count_3m, 0)) /
    ((total_trans_sum_6m - total_trans_sum_3m) / NULLIF((total_trans_count_6m - total_trans_count_3m), 0))
        AS ratio_avg_trans_3m,
    
    -- Количество дней с первой и последней транзакции
    (:report_date - first_trans_dt) AS days_since_first_trans,
    (:report_date - last_trans_dt) AS days_since_last_trans,
    
    -- Максимальные транзакции
    (max_trans_1m - max_trans_prev_1m) AS diff_max_trans_1m,
    (max_trans_12m - max_trans_prev_12m) AS diff_max_trans_12m,
    (max_trans_3m - max_trans_prev_3m) AS diff_max_trans_3m,
    max_trans_1m AS max_trans_1m_value,
    max_trans_12m AS max_trans_12m_value,
    max_trans_3m AS max_trans_3m_value,
    max_trans_1m / NULLIF(max_trans_prev_1m, 0) AS ratio_max_trans_1m,
    max_trans_12m / NULLIF(max_trans_prev_12m, 0) AS ratio_max_trans_12m,
    max_trans_3m / NULLIF(max_trans_prev_3m, 0) AS ratio_max_trans_3m,
    
    -- Минимальные транзакции
    (min_trans_1m - min_trans_prev_1m) AS diff_min_trans_1m,
    (min_trans_12m - min_trans_prev_12m) AS diff_min_trans_12m,
    (min_trans_3m - min_trans_prev_3m) AS diff_min_trans_3m,
    min_trans_1m AS min_trans_1m_value,
    min_trans_12m AS min_trans_12m_value,
    min_trans_3m AS min_trans_3m_value,
    min_trans_1m / NULLIF(min_trans_prev_1m, 0) AS ratio_min_trans_1m,
    min_trans_12m / NULLIF(min_trans_prev_12m, 0) AS ratio_min_trans_12m,
    min_trans_3m / NULLIF(min_trans_prev_3m, 0) AS ratio_min_trans_3m,
    
    -- Разница суммы транзакций
    (total_trans_sum_1m - (total_trans_sum_2m - total_trans_sum_1m)) AS diff_total_trans_sum_1m,
    (total_trans_sum_12m - total_trans_sum_24_12) AS diff_total_trans_sum_12m,
    (total_trans_sum_3m - (total_trans_sum_6m - total_trans_sum_3m)) AS diff_total_trans_sum_3m

FROM (
SELECT 
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS total_trans_count_1m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS total_trans_sum_1m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS total_trans_count_2m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS total_trans_sum_2m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS total_trans_count_3m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS total_trans_sum_3m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS total_trans_count_4m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS total_trans_sum_4m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS total_trans_count_6m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS total_trans_sum_6m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS total_trans_count_12m,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS total_trans_sum_12m,

    -- Агрегаты за предыдущие 12 месяцев (от 24 до 12 месяцев до отчетной даты)
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -24) AND trans_dt < ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS total_trans_count_24_12,
    SUM(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -24) AND trans_dt < ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS total_trans_sum_24_12,
    
    -- Первая и последняя транзакция
    MIN(trans_dt) AS first_trans_dt,
    MAX(trans_dt) AS last_trans_dt,
    
    -- Максимальные транзакции
    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE NULL END) AS max_trans_1m,
    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE NULL END) AS max_trans_2m,
    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE NULL END) AS max_trans_3m,
    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE NULL END) AS max_trans_4m,
    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE NULL END) AS max_trans_6m,
    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE NULL END) AS max_trans_12m,

    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -2) AND trans_dt < ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE NULL END) AS max_trans_prev_1m,  
    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -6) AND trans_dt < ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE NULL END) AS max_trans_prev_3m,
    MAX(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -24) AND trans_dt < ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE NULL END) AS max_trans_prev_12m,
    
    -- Минимальные транзакции
    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE NULL END) AS min_trans_1m,
    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE NULL END) AS min_trans_2m,
    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE NULL END) AS min_trans_3m,
    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE NULL END) AS min_trans_4m,
    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE NULL END) AS min_trans_6m,
    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE NULL END) AS min_trans_12m,

    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -2) AND trans_dt < ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE NULL END) AS min_trans_prev_1m,  
    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -6) AND trans_dt < ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE NULL END) AS min_trans_prev_3m,
    MIN(CASE WHEN trans_dt >= ADD_MONTHS(:report_date, -24) AND trans_dt < ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE NULL END) AS min_trans_prev_12m,


    -- Дом и ремонт
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS dom_rem_trans_count_1m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS dom_rem_trans_sum_1m,
    MAX(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS dom_rem_trans_max_1m,
    MIN(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS dom_rem_trans_min_1m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS dom_rem_trans_count_2m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS dom_rem_trans_sum_2m,
    MAX(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS dom_rem_trans_max_2m,
    MIN(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS dom_rem_trans_min_2m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS dom_rem_trans_count_3m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS dom_rem_trans_sum_3m,
    MAX(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS dom_rem_trans_max_3m,
    MIN(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS dom_rem_trans_min_3m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS dom_rem_trans_count_4m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS dom_rem_trans_sum_4m,
    MAX(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS dom_rem_trans_max_4m,
    MIN(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS dom_rem_trans_min_4m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS dom_rem_trans_count_6m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS dom_rem_trans_sum_6m,
    MAX(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS dom_rem_trans_max_6m,
    MIN(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS dom_rem_trans_min_6m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS dom_rem_trans_count_12m,
    SUM(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS dom_rem_trans_sum_12m,
    MAX(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS dom_rem_trans_max_12m,
    MIN(CASE WHEN category = 'Дом и ремонт' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS dom_rem_trans_min_12m,

    -- Кафе и рестораны
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS cafe_trans_count_1m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS cafe_trans_sum_1m,
    MAX(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS cafe_trans_max_1m,
    MIN(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS cafe_trans_min_1m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS cafe_trans_count_2m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS cafe_trans_sum_2m,
    MAX(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS cafe_trans_max_2m,
    MIN(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS cafe_trans_min_2m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS cafe_trans_count_3m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS cafe_trans_sum_3m,
    MAX(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS cafe_trans_max_3m,
    MIN(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS cafe_trans_min_3m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS cafe_trans_count_4m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS cafe_trans_sum_4m,
    MAX(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS cafe_trans_max_4m,
    MIN(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS cafe_trans_min_4m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS cafe_trans_count_6m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS cafe_trans_sum_6m,
    MAX(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS cafe_trans_max_6m,
    MIN(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS cafe_trans_min_6m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS cafe_trans_count_12m,
    SUM(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS cafe_trans_sum_12m,
    MAX(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS cafe_trans_max_12m,
    MIN(CASE WHEN category = 'Кафе и рестораны' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS cafe_trans_min_12m,

    -- Аренда авто
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS rent_auto_trans_count_1m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS rent_auto_trans_sum_1m,
    MAX(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS rent_auto_trans_max_1m,
    MIN(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS rent_auto_trans_min_1m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS rent_auto_trans_count_2m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS rent_auto_trans_sum_2m,
    MAX(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS rent_auto_trans_max_2m,
    MIN(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS rent_auto_trans_min_2m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS rent_auto_trans_count_3m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS rent_auto_trans_sum_3m,
    MAX(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS rent_auto_trans_max_3m,
    MIN(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS rent_auto_trans_min_3m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS rent_auto_trans_count_4m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS rent_auto_trans_sum_4m,
    MAX(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS rent_auto_trans_max_4m,
    MIN(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS rent_auto_trans_min_4m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS rent_auto_trans_count_6m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS rent_auto_trans_sum_6m,
    MAX(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS rent_auto_trans_max_6m,
    MIN(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS rent_auto_trans_min_6m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS rent_auto_trans_count_12m,
    SUM(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS rent_auto_trans_sum_12m,
    MAX(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS rent_auto_trans_max_12m,
    MIN(CASE WHEN category = 'Аренда авто' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS rent_auto_trans_min_12m,

    -- Транспорт
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS transport_trans_count_1m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS transport_trans_sum_1m,
    MAX(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS transport_trans_max_1m,
    MIN(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS transport_trans_min_1m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS transport_trans_count_2m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS transport_trans_sum_2m,
    MAX(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS transport_trans_max_2m,
    MIN(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS transport_trans_min_2m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS transport_trans_count_3m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS transport_trans_sum_3m,
    MAX(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS transport_trans_max_3m,
    MIN(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS transport_trans_min_3m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS transport_trans_count_4m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS transport_trans_sum_4m,
    MAX(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS transport_trans_max_4m,
    MIN(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS transport_trans_min_4m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS transport_trans_count_6m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS transport_trans_sum_6m,
    MAX(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS transport_trans_max_6m,
    MIN(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS transport_trans_min_6m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS transport_trans_count_12m,
    SUM(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS transport_trans_sum_12m,
    MAX(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS transport_trans_max_12m,
    MIN(CASE WHEN category = 'Транспорт' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS transport_trans_min_12m,

    -- Путешествия
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS travel_trans_count_1m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS travel_trans_sum_1m,
    MAX(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS travel_trans_max_1m,
    MIN(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS travel_trans_min_1m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS travel_trans_count_2m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS travel_trans_sum_2m,
    MAX(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS travel_trans_max_2m,
    MIN(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS travel_trans_min_2m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS travel_trans_count_3m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS travel_trans_sum_3m,
    MAX(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS travel_trans_max_3m,
    MIN(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS travel_trans_min_3m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS travel_trans_count_4m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS travel_trans_sum_4m,
    MAX(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS travel_trans_max_4m,
    MIN(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS travel_trans_min_4m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS travel_trans_count_6m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS travel_trans_sum_6m,
    MAX(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS travel_trans_max_6m,
    MIN(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS travel_trans_min_6m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS travel_trans_count_12m,
    SUM(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS travel_trans_sum_12m,
    MAX(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS travel_trans_max_12m,
    MIN(CASE WHEN category = 'Путешествия' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS travel_trans_min_12m,

    -- Медицина
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS medicine_trans_count_1m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS medicine_trans_sum_1m,
    MAX(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS medicine_trans_max_1m,
    MIN(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS medicine_trans_min_1m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS medicine_trans_count_2m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS medicine_trans_sum_2m,
    MAX(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS medicine_trans_max_2m,
    MIN(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS medicine_trans_min_2m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS medicine_trans_count_3m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS medicine_trans_sum_3m,
    MAX(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS medicine_trans_max_3m,
    MIN(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS medicine_trans_min_3m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS medicine_trans_count_4m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS medicine_trans_sum_4m,
    MAX(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS medicine_trans_max_4m,
    MIN(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS medicine_trans_min_4m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS medicine_trans_count_6m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS medicine_trans_sum_6m,
    MAX(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS medicine_trans_max_6m,
    MIN(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS medicine_trans_min_6m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS medicine_trans_count_12m,
    SUM(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS medicine_trans_sum_12m,
    MAX(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS medicine_trans_max_12m,
    MIN(CASE WHEN category = 'Медицина' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS medicine_trans_min_12m,

    -- Онлайн магазины
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS online_shops_trans_count_1m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS online_shops_trans_sum_1m,
    MAX(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS online_shops_trans_max_1m,
    MIN(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS online_shops_trans_min_1m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS online_shops_trans_count_2m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS online_shops_trans_sum_2m,
    MAX(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS online_shops_trans_max_2m,
    MIN(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS online_shops_trans_min_2m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS online_shops_trans_count_3m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS online_shops_trans_sum_3m,
    MAX(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS online_shops_trans_max_3m,
    MIN(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS online_shops_trans_min_3m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS online_shops_trans_count_4m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS online_shops_trans_sum_4m,
    MAX(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS online_shops_trans_max_4m,
    MIN(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS online_shops_trans_min_4m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS online_shops_trans_count_6m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS online_shops_trans_sum_6m,
    MAX(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS online_shops_trans_max_6m,
    MIN(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS online_shops_trans_min_6m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS online_shops_trans_count_12m,
    SUM(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS online_shops_trans_sum_12m,
    MAX(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS online_shops_trans_max_12m,
    MIN(CASE WHEN category = 'Онлайн магазины' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS online_shops_trans_min_12m,

    -- Музыка
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS music_trans_count_1m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS music_trans_sum_1m,
    MAX(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS music_trans_max_1m,
    MIN(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS music_trans_min_1m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS music_trans_count_2m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS music_trans_sum_2m,
    MAX(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS music_trans_max_2m,
    MIN(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS music_trans_min_2m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS music_trans_count_3m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS music_trans_sum_3m,
    MAX(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS music_trans_max_3m,
    MIN(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS music_trans_min_3m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS music_trans_count_4m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS music_trans_sum_4m,
    MAX(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS music_trans_max_4m,
    MIN(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS music_trans_min_4m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS music_trans_count_6m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS music_trans_sum_6m,
    MAX(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS music_trans_max_6m,
    MIN(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS music_trans_min_6m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS music_trans_count_12m,
    SUM(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS music_trans_sum_12m,
    MAX(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS music_trans_max_12m,
    MIN(CASE WHEN category = 'Музыка' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS music_trans_min_12m,

    -- Ломбарды
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS lombards_trans_count_1m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS lombards_trans_sum_1m,
    MAX(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS lombards_trans_max_1m,
    MIN(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS lombards_trans_min_1m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS lombards_trans_count_2m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS lombards_trans_sum_2m,
    MAX(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS lombards_trans_max_2m,
    MIN(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS lombards_trans_min_2m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS lombards_trans_count_3m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS lombards_trans_sum_3m,
    MAX(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS lombards_trans_max_3m,
    MIN(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS lombards_trans_min_3m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS lombards_trans_count_4m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS lombards_trans_sum_4m,
    MAX(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS lombards_trans_max_4m,
    MIN(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS lombards_trans_min_4m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS lombards_trans_count_6m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS lombards_trans_sum_6m,
    MAX(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS lombards_trans_max_6m,
    MIN(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS lombards_trans_min_6m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS lombards_trans_count_12m,
    SUM(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS lombards_trans_sum_12m,
    MAX(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS lombards_trans_max_12m,
    MIN(CASE WHEN category = 'Ломбарды' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS lombards_trans_min_12m,

    -- Зоомагазины
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS zoo_trans_count_1m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS zoo_trans_sum_1m,
    MAX(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS zoo_trans_max_1m,
    MIN(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS zoo_trans_min_1m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS zoo_trans_count_2m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS zoo_trans_sum_2m,
    MAX(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS zoo_trans_max_2m,
    MIN(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS zoo_trans_min_2m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS zoo_trans_count_3m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS zoo_trans_sum_3m,
    MAX(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS zoo_trans_max_3m,
    MIN(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS zoo_trans_min_3m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS zoo_trans_count_4m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS zoo_trans_sum_4m,
    MAX(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS zoo_trans_max_4m,
    MIN(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS zoo_trans_min_4m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS zoo_trans_count_6m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS zoo_trans_sum_6m,
    MAX(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS zoo_trans_max_6m,
    MIN(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS zoo_trans_min_6m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS zoo_trans_count_12m,
    SUM(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS zoo_trans_sum_12m,
    MAX(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS zoo_trans_max_12m,
    MIN(CASE WHEN category = 'Зоомагазины' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS zoo_trans_min_12m,

    -- Авиабилеты
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS air_tickets_trans_count_1m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS air_tickets_trans_sum_1m,
    MAX(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS air_tickets_trans_max_1m,
    MIN(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS air_tickets_trans_min_1m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS air_tickets_trans_count_2m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS air_tickets_trans_sum_2m,
    MAX(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS air_tickets_trans_max_2m,
    MIN(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS air_tickets_trans_min_2m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS air_tickets_trans_count_3m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS air_tickets_trans_sum_3m,
    MAX(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS air_tickets_trans_max_3m,
    MIN(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS air_tickets_trans_min_3m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS air_tickets_trans_count_4m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS air_tickets_trans_sum_4m,
    MAX(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS air_tickets_trans_max_4m,
    MIN(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS air_tickets_trans_min_4m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS air_tickets_trans_count_6m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS air_tickets_trans_sum_6m,
    MAX(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS air_tickets_trans_max_6m,
    MIN(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS air_tickets_trans_min_6m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS air_tickets_trans_count_12m,
    SUM(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS air_tickets_trans_sum_12m,
    MAX(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS air_tickets_trans_max_12m,
    MIN(CASE WHEN category = 'Авиабилеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS air_tickets_trans_min_12m,

    -- Гостиницы
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS hotels_trans_count_1m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS hotels_trans_sum_1m,
    MAX(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS hotels_trans_max_1m,
    MIN(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS hotels_trans_min_1m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS hotels_trans_count_2m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS hotels_trans_sum_2m,
    MAX(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS hotels_trans_max_2m,
    MIN(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS hotels_trans_min_2m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS hotels_trans_count_3m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS hotels_trans_sum_3m,
    MAX(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS hotels_trans_max_3m,
    MIN(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS hotels_trans_min_3m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS hotels_trans_count_4m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS hotels_trans_sum_4m,
    MAX(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS hotels_trans_max_4m,
    MIN(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS hotels_trans_min_4m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS hotels_trans_count_6m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS hotels_trans_sum_6m,
    MAX(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS hotels_trans_max_6m,
    MIN(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS hotels_trans_min_6m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS hotels_trans_count_12m,
    SUM(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS hotels_trans_sum_12m,
    MAX(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS hotels_trans_max_12m,
    MIN(CASE WHEN category = 'Гостиницы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS hotels_trans_min_12m,

    -- Услуги курьера
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS courier_trans_count_1m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS courier_trans_sum_1m,
    MAX(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS courier_trans_max_1m,
    MIN(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS courier_trans_min_1m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS courier_trans_count_2m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS courier_trans_sum_2m,
    MAX(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS courier_trans_max_2m,
    MIN(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS courier_trans_min_2m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS courier_trans_count_3m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS courier_trans_sum_3m,
    MAX(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS courier_trans_max_3m,
    MIN(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS courier_trans_min_3m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS courier_trans_count_4m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS courier_trans_sum_4m,
    MAX(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS courier_trans_max_4m,
    MIN(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS courier_trans_min_4m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS courier_trans_count_6m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS courier_trans_sum_6m,
    MAX(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS courier_trans_max_6m,
    MIN(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS courier_trans_min_6m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS courier_trans_count_12m,
    SUM(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS courier_trans_sum_12m,
    MAX(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS courier_trans_max_12m,
    MIN(CASE WHEN category = 'Услуги курьера' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS courier_trans_min_12m,

    -- Сувениры
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS souvenirs_trans_count_1m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS souvenirs_trans_sum_1m,
    MAX(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS souvenirs_trans_max_1m,
    MIN(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS souvenirs_trans_min_1m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS souvenirs_trans_count_2m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS souvenirs_trans_sum_2m,
    MAX(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS souvenirs_trans_max_2m,
    MIN(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS souvenirs_trans_min_2m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS souvenirs_trans_count_3m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS souvenirs_trans_sum_3m,
    MAX(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS souvenirs_trans_max_3m,
    MIN(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS souvenirs_trans_min_3m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS souvenirs_trans_count_4m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS souvenirs_trans_sum_4m,
    MAX(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS souvenirs_trans_max_4m,
    MIN(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS souvenirs_trans_min_4m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS souvenirs_trans_count_6m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS souvenirs_trans_sum_6m,
    MAX(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS souvenirs_trans_max_6m,
    MIN(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS souvenirs_trans_min_6m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS souvenirs_trans_count_12m,
    SUM(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS souvenirs_trans_sum_12m,
    MAX(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS souvenirs_trans_max_12m,
    MIN(CASE WHEN category = 'Сувениры' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS souvenirs_trans_min_12m,

    -- Перевод на карту
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS card_transfer_trans_count_1m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS card_transfer_trans_sum_1m,
    MAX(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS card_transfer_trans_max_1m,
    MIN(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS card_transfer_trans_min_1m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS card_transfer_trans_count_2m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS card_transfer_trans_sum_2m,
    MAX(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS card_transfer_trans_max_2m,
    MIN(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS card_transfer_trans_min_2m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS card_transfer_trans_count_3m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS card_transfer_trans_sum_3m,
    MAX(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS card_transfer_trans_max_3m,
    MIN(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS card_transfer_trans_min_3m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS card_transfer_trans_count_4m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS card_transfer_trans_sum_4m,
    MAX(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS card_transfer_trans_max_4m,
    MIN(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS card_transfer_trans_min_4m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS card_transfer_trans_count_6m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS card_transfer_trans_sum_6m,
    MAX(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS card_transfer_trans_max_6m,
    MIN(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS card_transfer_trans_min_6m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS card_transfer_trans_count_12m,
    SUM(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS card_transfer_trans_sum_12m,
    MAX(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS card_transfer_trans_max_12m,
    MIN(CASE WHEN category = 'Перевод на карту' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS card_transfer_trans_min_12m,

    -- Развлечения
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS entertainment_trans_count_1m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS entertainment_trans_sum_1m,
    MAX(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS entertainment_trans_max_1m,
    MIN(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS entertainment_trans_min_1m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS entertainment_trans_count_2m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS entertainment_trans_sum_2m,
    MAX(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS entertainment_trans_max_2m,
    MIN(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS entertainment_trans_min_2m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS entertainment_trans_count_3m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS entertainment_trans_sum_3m,
    MAX(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS entertainment_trans_max_3m,
    MIN(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS entertainment_trans_min_3m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS entertainment_trans_count_4m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS entertainment_trans_sum_4m,
    MAX(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS entertainment_trans_max_4m,
    MIN(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS entertainment_trans_min_4m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS entertainment_trans_count_6m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS entertainment_trans_sum_6m,
    MAX(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS entertainment_trans_max_6m,
    MIN(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS entertainment_trans_min_6m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS entertainment_trans_count_12m,
    SUM(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS entertainment_trans_sum_12m,
    MAX(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS entertainment_trans_max_12m,
    MIN(CASE WHEN category = 'Развлечения' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS entertainment_trans_min_12m,

    -- Налоги и штрафы
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS taxes_fines_trans_count_1m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS taxes_fines_trans_sum_1m,
    MAX(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS taxes_fines_trans_max_1m,
    MIN(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS taxes_fines_trans_min_1m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS taxes_fines_trans_count_2m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS taxes_fines_trans_sum_2m,
    MAX(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS taxes_fines_trans_max_2m,
    MIN(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS taxes_fines_trans_min_2m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS taxes_fines_trans_count_3m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS taxes_fines_trans_sum_3m,
    MAX(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS taxes_fines_trans_max_3m,
    MIN(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS taxes_fines_trans_min_3m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS taxes_fines_trans_count_4m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS taxes_fines_trans_sum_4m,
    MAX(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS taxes_fines_trans_max_4m,
    MIN(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS taxes_fines_trans_min_4m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS taxes_fines_trans_count_6m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS taxes_fines_trans_sum_6m,
    MAX(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS taxes_fines_trans_max_6m,
    MIN(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS taxes_fines_trans_min_6m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS taxes_fines_trans_count_12m,
    SUM(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS taxes_fines_trans_sum_12m,
    MAX(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS taxes_fines_trans_max_12m,
    MIN(CASE WHEN category = 'Налоги и штрафы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS taxes_fines_trans_min_12m,

    -- Супермаркеты
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS supermarkets_trans_count_1m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS supermarkets_trans_sum_1m,
    MAX(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS supermarkets_trans_max_1m,
    MIN(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS supermarkets_trans_min_1m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS supermarkets_trans_count_2m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS supermarkets_trans_sum_2m,
    MAX(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS supermarkets_trans_max_2m,
    MIN(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS supermarkets_trans_min_2m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS supermarkets_trans_count_3m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS supermarkets_trans_sum_3m,
    MAX(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS supermarkets_trans_max_3m,
    MIN(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS supermarkets_trans_min_3m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS supermarkets_trans_count_4m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS supermarkets_trans_sum_4m,
    MAX(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS supermarkets_trans_max_4m,
    MIN(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS supermarkets_trans_min_4m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS supermarkets_trans_count_6m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS supermarkets_trans_sum_6m,
    MAX(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS supermarkets_trans_max_6m,
    MIN(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS supermarkets_trans_min_6m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS supermarkets_trans_count_12m,
    SUM(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS supermarkets_trans_sum_12m,
    MAX(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS supermarkets_trans_max_12m,
    MIN(CASE WHEN category = 'Супермаркеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS supermarkets_trans_min_12m,

    -- Спорттовары
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS sport_goods_trans_count_1m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS sport_goods_trans_sum_1m,
    MAX(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS sport_goods_trans_max_1m,
    MIN(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS sport_goods_trans_min_1m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS sport_goods_trans_count_2m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS sport_goods_trans_sum_2m,
    MAX(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS sport_goods_trans_max_2m,
    MIN(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS sport_goods_trans_min_2m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS sport_goods_trans_count_3m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS sport_goods_trans_sum_3m,
    MAX(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS sport_goods_trans_max_3m,
    MIN(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS sport_goods_trans_min_3m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS sport_goods_trans_count_4m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS sport_goods_trans_sum_4m,
    MAX(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS sport_goods_trans_max_4m,
    MIN(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS sport_goods_trans_min_4m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS sport_goods_trans_count_6m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS sport_goods_trans_sum_6m,
    MAX(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS sport_goods_trans_max_6m,
    MIN(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS sport_goods_trans_min_6m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS sport_goods_trans_count_12m,
    SUM(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS sport_goods_trans_sum_12m,
    MAX(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS sport_goods_trans_max_12m,
    MIN(CASE WHEN category = 'Спорттовары' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS sport_goods_trans_min_12m,

    -- Сервисы Сбера
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS sber_services_trans_count_1m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS sber_services_trans_sum_1m,
    MAX(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS sber_services_trans_max_1m,
    MIN(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS sber_services_trans_min_1m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS sber_services_trans_count_2m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS sber_services_trans_sum_2m,
    MAX(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS sber_services_trans_max_2m,
    MIN(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS sber_services_trans_min_2m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS sber_services_trans_count_3m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS sber_services_trans_sum_3m,
    MAX(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS sber_services_trans_max_3m,
    MIN(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS sber_services_trans_min_3m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS sber_services_trans_count_4m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS sber_services_trans_sum_4m,
    MAX(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS sber_services_trans_max_4m,
    MIN(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS sber_services_trans_min_4m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS sber_services_trans_count_6m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS sber_services_trans_sum_6m,
    MAX(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS sber_services_trans_max_6m,
    MIN(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS sber_services_trans_min_6m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS sber_services_trans_count_12m,
    SUM(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS sber_services_trans_sum_12m,
    MAX(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS sber_services_trans_max_12m,
    MIN(CASE WHEN category = 'Сервисы Сбера' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS sber_services_trans_min_12m,

    -- Госуслуги
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS gov_services_trans_count_1m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS gov_services_trans_sum_1m,
    MAX(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS gov_services_trans_max_1m,
    MIN(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS gov_services_trans_min_1m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS gov_services_trans_count_2m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS gov_services_trans_sum_2m,
    MAX(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS gov_services_trans_max_2m,
    MIN(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS gov_services_trans_min_2m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS gov_services_trans_count_3m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS gov_services_trans_sum_3m,
    MAX(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS gov_services_trans_max_3m,
    MIN(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS gov_services_trans_min_3m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS gov_services_trans_count_4m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS gov_services_trans_sum_4m,
    MAX(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS gov_services_trans_max_4m,
    MIN(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS gov_services_trans_min_4m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS gov_services_trans_count_6m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS gov_services_trans_sum_6m,
    MAX(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS gov_services_trans_max_6m,
    MIN(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS gov_services_trans_min_6m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS gov_services_trans_count_12m,
    SUM(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS gov_services_trans_sum_12m,
    MAX(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS gov_services_trans_max_12m,
    MIN(CASE WHEN category = 'Госуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS gov_services_trans_min_12m,

    -- Искусство
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS art_trans_count_1m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS art_trans_sum_1m,
    MAX(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS art_trans_max_1m,
    MIN(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS art_trans_min_1m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS art_trans_count_2m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS art_trans_sum_2m,
    MAX(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS art_trans_max_2m,
    MIN(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS art_trans_min_2m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS art_trans_count_3m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS art_trans_sum_3m,
    MAX(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS art_trans_max_3m,
    MIN(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS art_trans_min_3m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS art_trans_count_4m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS art_trans_sum_4m,
    MAX(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS art_trans_max_4m,
    MIN(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS art_trans_min_4m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS art_trans_count_6m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS art_trans_sum_6m,
    MAX(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS art_trans_max_6m,
    MIN(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS art_trans_min_6m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS art_trans_count_12m,
    SUM(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS art_trans_sum_12m,
    MAX(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS art_trans_max_12m,
    MIN(CASE WHEN category = 'Искусство' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS art_trans_min_12m,

    -- Аптеки
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS pharmacies_trans_count_1m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS pharmacies_trans_sum_1m,
    MAX(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS pharmacies_trans_max_1m,
    MIN(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS pharmacies_trans_min_1m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS pharmacies_trans_count_2m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS pharmacies_trans_sum_2m,
    MAX(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS pharmacies_trans_max_2m,
    MIN(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS pharmacies_trans_min_2m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS pharmacies_trans_count_3m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS pharmacies_trans_sum_3m,
    MAX(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS pharmacies_trans_max_3m,
    MIN(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS pharmacies_trans_min_3m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS pharmacies_trans_count_4m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS pharmacies_trans_sum_4m,
    MAX(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS pharmacies_trans_max_4m,
    MIN(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS pharmacies_trans_min_4m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS pharmacies_trans_count_6m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS pharmacies_trans_sum_6m,
    MAX(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS pharmacies_trans_max_6m,
    MIN(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS pharmacies_trans_min_6m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS pharmacies_trans_count_12m,
    SUM(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS pharmacies_trans_sum_12m,
    MAX(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS pharmacies_trans_max_12m,
    MIN(CASE WHEN category = 'Аптеки' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS pharmacies_trans_min_12m,

    -- Цветы и растения
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS flowers_trans_count_1m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS flowers_trans_sum_1m,
    MAX(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS flowers_trans_max_1m,
    MIN(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS flowers_trans_min_1m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS flowers_trans_count_2m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS flowers_trans_sum_2m,
    MAX(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS flowers_trans_max_2m,
    MIN(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS flowers_trans_min_2m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS flowers_trans_count_3m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS flowers_trans_sum_3m,
    MAX(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS flowers_trans_max_3m,
    MIN(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS flowers_trans_min_3m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS flowers_trans_count_4m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS flowers_trans_sum_4m,
    MAX(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS flowers_trans_max_4m,
    MIN(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS flowers_trans_min_4m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS flowers_trans_count_6m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS flowers_trans_sum_6m,
    MAX(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS flowers_trans_max_6m,
    MIN(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS flowers_trans_min_6m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS flowers_trans_count_12m,
    SUM(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS flowers_trans_sum_12m,
    MAX(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS flowers_trans_max_12m,
    MIN(CASE WHEN category = 'Цветы и растения' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS flowers_trans_min_12m,

    -- Ж/д билеты
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS train_tickets_trans_count_1m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS train_tickets_trans_sum_1m,
    MAX(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS train_tickets_trans_max_1m,
    MIN(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS train_tickets_trans_min_1m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS train_tickets_trans_count_2m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS train_tickets_trans_sum_2m,
    MAX(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS train_tickets_trans_max_2m,
    MIN(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS train_tickets_trans_min_2m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS train_tickets_trans_count_3m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS train_tickets_trans_sum_3m,
    MAX(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS train_tickets_trans_max_3m,
    MIN(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS train_tickets_trans_min_3m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS train_tickets_trans_count_4m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS train_tickets_trans_sum_4m,
    MAX(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS train_tickets_trans_max_4m,
    MIN(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS train_tickets_trans_min_4m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS train_tickets_trans_count_6m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS train_tickets_trans_sum_6m,
    MAX(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS train_tickets_trans_max_6m,
    MIN(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS train_tickets_trans_min_6m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS train_tickets_trans_count_12m,
    SUM(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS train_tickets_trans_sum_12m,
    MAX(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS train_tickets_trans_max_12m,
    MIN(CASE WHEN category = 'Ж/д билеты' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS train_tickets_trans_min_12m,

    -- Азартные игры
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS gambling_trans_count_1m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS gambling_trans_sum_1m,
    MAX(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS gambling_trans_max_1m,
    MIN(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS gambling_trans_min_1m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS gambling_trans_count_2m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS gambling_trans_sum_2m,
    MAX(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS gambling_trans_max_2m,
    MIN(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS gambling_trans_min_2m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS gambling_trans_count_3m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS gambling_trans_sum_3m,
    MAX(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS gambling_trans_max_3m,
    MIN(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS gambling_trans_min_3m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS gambling_trans_count_4m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS gambling_trans_sum_4m,
    MAX(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS gambling_trans_max_4m,
    MIN(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS gambling_trans_min_4m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS gambling_trans_count_6m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS gambling_trans_sum_6m,
    MAX(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS gambling_trans_max_6m,
    MIN(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS gambling_trans_min_6m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS gambling_trans_count_12m,
    SUM(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS gambling_trans_sum_12m,
    MAX(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS gambling_trans_max_12m,
    MIN(CASE WHEN category = 'Азартные игры' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS gambling_trans_min_12m,

    -- Цифровые товары
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS digital_goods_trans_count_1m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS digital_goods_trans_sum_1m,
    MAX(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS digital_goods_trans_max_1m,
    MIN(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS digital_goods_trans_min_1m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS digital_goods_trans_count_2m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS digital_goods_trans_sum_2m,
    MAX(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS digital_goods_trans_max_2m,
    MIN(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS digital_goods_trans_min_2m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS digital_goods_trans_count_3m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS digital_goods_trans_sum_3m,
    MAX(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS digital_goods_trans_max_3m,
    MIN(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS digital_goods_trans_min_3m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS digital_goods_trans_count_4m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS digital_goods_trans_sum_4m,
    MAX(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS digital_goods_trans_max_4m,
    MIN(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS digital_goods_trans_min_4m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS digital_goods_trans_count_6m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS digital_goods_trans_sum_6m,
    MAX(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS digital_goods_trans_max_6m,
    MIN(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS digital_goods_trans_min_6m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS digital_goods_trans_count_12m,
    SUM(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS digital_goods_trans_sum_12m,
    MAX(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS digital_goods_trans_max_12m,
    MIN(CASE WHEN category = 'Цифровые товары' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS digital_goods_trans_min_12m,

    -- Книги
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS books_trans_count_1m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS books_trans_sum_1m,
    MAX(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS books_trans_max_1m,
    MIN(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS books_trans_min_1m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS books_trans_count_2m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS books_trans_sum_2m,
    MAX(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS books_trans_max_2m,
    MIN(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS books_trans_min_2m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS books_trans_count_3m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS books_trans_sum_3m,
    MAX(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS books_trans_max_3m,
    MIN(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS books_trans_min_3m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS books_trans_count_4m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS books_trans_sum_4m,
    MAX(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS books_trans_max_4m,
    MIN(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS books_trans_min_4m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS books_trans_count_6m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS books_trans_sum_6m,
    MAX(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS books_trans_max_6m,
    MIN(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS books_trans_min_6m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS books_trans_count_12m,
    SUM(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS books_trans_sum_12m,
    MAX(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS books_trans_max_12m,
    MIN(CASE WHEN category = 'Книги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS books_trans_min_12m,

    -- Топливо
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS fuel_trans_count_1m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS fuel_trans_sum_1m,
    MAX(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS fuel_trans_max_1m,
    MIN(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS fuel_trans_min_1m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS fuel_trans_count_2m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS fuel_trans_sum_2m,
    MAX(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS fuel_trans_max_2m,
    MIN(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS fuel_trans_min_2m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS fuel_trans_count_3m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS fuel_trans_sum_3m,
    MAX(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS fuel_trans_max_3m,
    MIN(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS fuel_trans_min_3m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS fuel_trans_count_4m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS fuel_trans_sum_4m,
    MAX(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS fuel_trans_max_4m,
    MIN(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS fuel_trans_min_4m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS fuel_trans_count_6m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS fuel_trans_sum_6m,
    MAX(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS fuel_trans_max_6m,
    MIN(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS fuel_trans_min_6m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS fuel_trans_count_12m,
    SUM(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS fuel_trans_sum_12m,
    MAX(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS fuel_trans_max_12m,
    MIN(CASE WHEN category = 'Топливо' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS fuel_trans_min_12m,

    -- Сервисы Яндекса
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS yandex_services_trans_count_1m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS yandex_services_trans_sum_1m,
    MAX(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS yandex_services_trans_max_1m,
    MIN(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS yandex_services_trans_min_1m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS yandex_services_trans_count_2m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS yandex_services_trans_sum_2m,
    MAX(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS yandex_services_trans_max_2m,
    MIN(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS yandex_services_trans_min_2m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS yandex_services_trans_count_3m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS yandex_services_trans_sum_3m,
    MAX(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS yandex_services_trans_max_3m,
    MIN(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS yandex_services_trans_min_3m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS yandex_services_trans_count_4m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS yandex_services_trans_sum_4m,
    MAX(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS yandex_services_trans_max_4m,
    MIN(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS yandex_services_trans_min_4m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS yandex_services_trans_count_6m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS yandex_services_trans_sum_6m,
    MAX(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS yandex_services_trans_max_6m,
    MIN(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS yandex_services_trans_min_6m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS yandex_services_trans_count_12m,
    SUM(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS yandex_services_trans_sum_12m,
    MAX(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS yandex_services_trans_max_12m,
    MIN(CASE WHEN category = 'Сервисы Яндекса' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS yandex_services_trans_min_12m,

    -- Красота
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS beauty_trans_count_1m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS beauty_trans_sum_1m,
    MAX(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS beauty_trans_max_1m,
    MIN(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS beauty_trans_min_1m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS beauty_trans_count_2m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS beauty_trans_sum_2m,
    MAX(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS beauty_trans_max_2m,
    MIN(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS beauty_trans_min_2m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS beauty_trans_count_3m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS beauty_trans_sum_3m,
    MAX(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS beauty_trans_max_3m,
    MIN(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS beauty_trans_min_3m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS beauty_trans_count_4m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS beauty_trans_sum_4m,
    MAX(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS beauty_trans_max_4m,
    MIN(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS beauty_trans_min_4m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS beauty_trans_count_6m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS beauty_trans_sum_6m,
    MAX(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS beauty_trans_max_6m,
    MIN(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS beauty_trans_min_6m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS beauty_trans_count_12m,
    SUM(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS beauty_trans_sum_12m,
    MAX(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS beauty_trans_max_12m,
    MIN(CASE WHEN category = 'Красота' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS beauty_trans_min_12m,

    -- Кино
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS cinema_trans_count_1m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS cinema_trans_sum_1m,
    MAX(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS cinema_trans_max_1m,
    MIN(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS cinema_trans_min_1m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS cinema_trans_count_2m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS cinema_trans_sum_2m,
    MAX(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS cinema_trans_max_2m,
    MIN(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS cinema_trans_min_2m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS cinema_trans_count_3m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS cinema_trans_sum_3m,
    MAX(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS cinema_trans_max_3m,
    MIN(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS cinema_trans_min_3m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS cinema_trans_count_4m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS cinema_trans_sum_4m,
    MAX(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS cinema_trans_max_4m,
    MIN(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS cinema_trans_min_4m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS cinema_trans_count_6m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS cinema_trans_sum_6m,
    MAX(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS cinema_trans_max_6m,
    MIN(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS cinema_trans_min_6m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS cinema_trans_count_12m,
    SUM(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS cinema_trans_sum_12m,
    MAX(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS cinema_trans_max_12m,
    MIN(CASE WHEN category = 'Кино' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS cinema_trans_min_12m,

    -- Благотворительность
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS charity_trans_count_1m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS charity_trans_sum_1m,
    MAX(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS charity_trans_max_1m,
    MIN(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS charity_trans_min_1m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS charity_trans_count_2m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS charity_trans_sum_2m,
    MAX(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS charity_trans_max_2m,
    MIN(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS charity_trans_min_2m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS charity_trans_count_3m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS charity_trans_sum_3m,
    MAX(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS charity_trans_max_3m,
    MIN(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS charity_trans_min_3m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS charity_trans_count_4m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS charity_trans_sum_4m,
    MAX(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS charity_trans_max_4m,
    MIN(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS charity_trans_min_4m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS charity_trans_count_6m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS charity_trans_sum_6m,
    MAX(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS charity_trans_max_6m,
    MIN(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS charity_trans_min_6m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS charity_trans_count_12m,
    SUM(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS charity_trans_sum_12m,
    MAX(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS charity_trans_max_12m,
    MIN(CASE WHEN category = 'Благотворительность' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS charity_trans_min_12m,

    -- Денежные переводы
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS money_transfers_trans_count_1m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS money_transfers_trans_sum_1m,
    MAX(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS money_transfers_trans_max_1m,
    MIN(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS money_transfers_trans_min_1m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS money_transfers_trans_count_2m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS money_transfers_trans_sum_2m,
    MAX(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS money_transfers_trans_max_2m,
    MIN(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS money_transfers_trans_min_2m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS money_transfers_trans_count_3m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS money_transfers_trans_sum_3m,
    MAX(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS money_transfers_trans_max_3m,
    MIN(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS money_transfers_trans_min_3m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS money_transfers_trans_count_4m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS money_transfers_trans_sum_4m,
    MAX(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS money_transfers_trans_max_4m,
    MIN(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS money_transfers_trans_min_4m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS money_transfers_trans_count_6m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS money_transfers_trans_sum_6m,
    MAX(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS money_transfers_trans_max_6m,
    MIN(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS money_transfers_trans_min_6m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS money_transfers_trans_count_12m,
    SUM(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS money_transfers_trans_sum_12m,
    MAX(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS money_transfers_trans_max_12m,
    MIN(CASE WHEN category = 'Денежные переводы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS money_transfers_trans_min_12m,

    -- Автоуслуги
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS auto_services_trans_count_1m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS auto_services_trans_sum_1m,
    MAX(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS auto_services_trans_max_1m,
    MIN(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS auto_services_trans_min_1m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS auto_services_trans_count_2m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS auto_services_trans_sum_2m,
    MAX(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS auto_services_trans_max_2m,
    MIN(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS auto_services_trans_min_2m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS auto_services_trans_count_3m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS auto_services_trans_sum_3m,
    MAX(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS auto_services_trans_max_3m,
    MIN(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS auto_services_trans_min_3m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS auto_services_trans_count_4m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS auto_services_trans_sum_4m,
    MAX(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS auto_services_trans_max_4m,
    MIN(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS auto_services_trans_min_4m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS auto_services_trans_count_6m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS auto_services_trans_sum_6m,
    MAX(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS auto_services_trans_max_6m,
    MIN(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS auto_services_trans_min_6m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS auto_services_trans_count_12m,
    SUM(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS auto_services_trans_sum_12m,
    MAX(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS auto_services_trans_max_12m,
    MIN(CASE WHEN category = 'Автоуслуги' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS auto_services_trans_min_12m,

    -- Услуги и консультации
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS services_consult_trans_count_1m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS services_consult_trans_sum_1m,
    MAX(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS services_consult_trans_max_1m,
    MIN(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS services_consult_trans_min_1m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS services_consult_trans_count_2m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS services_consult_trans_sum_2m,
    MAX(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS services_consult_trans_max_2m,
    MIN(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS services_consult_trans_min_2m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS services_consult_trans_count_3m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS services_consult_trans_sum_3m,
    MAX(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS services_consult_trans_max_3m,
    MIN(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS services_consult_trans_min_3m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS services_consult_trans_count_4m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS services_consult_trans_sum_4m,
    MAX(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS services_consult_trans_max_4m,
    MIN(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS services_consult_trans_min_4m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS services_consult_trans_count_6m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS services_consult_trans_sum_6m,
    MAX(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS services_consult_trans_max_6m,
    MIN(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS services_consult_trans_min_6m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS services_consult_trans_count_12m,
    SUM(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS services_consult_trans_sum_12m,
    MAX(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS services_consult_trans_max_12m,
    MIN(CASE WHEN category = 'Услуги и консультации' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS services_consult_trans_min_12m,

    -- Снятие наличных
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS cash_withdraw_trans_count_1m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS cash_withdraw_trans_sum_1m,
    MAX(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS cash_withdraw_trans_max_1m,
    MIN(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS cash_withdraw_trans_min_1m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS cash_withdraw_trans_count_2m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS cash_withdraw_trans_sum_2m,
    MAX(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS cash_withdraw_trans_max_2m,
    MIN(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS cash_withdraw_trans_min_2m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS cash_withdraw_trans_count_3m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS cash_withdraw_trans_sum_3m,
    MAX(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS cash_withdraw_trans_max_3m,
    MIN(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS cash_withdraw_trans_min_3m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS cash_withdraw_trans_count_4m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS cash_withdraw_trans_sum_4m,
    MAX(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS cash_withdraw_trans_max_4m,
    MIN(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS cash_withdraw_trans_min_4m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS cash_withdraw_trans_count_6m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS cash_withdraw_trans_sum_6m,
    MAX(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS cash_withdraw_trans_max_6m,
    MIN(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS cash_withdraw_trans_min_6m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS cash_withdraw_trans_count_12m,
    SUM(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS cash_withdraw_trans_sum_12m,
    MAX(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS cash_withdraw_trans_max_12m,
    MIN(CASE WHEN category = 'Снятие наличных' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS cash_withdraw_trans_min_12m,

    -- Прочие расходы
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS other_expenses_trans_count_1m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS other_expenses_trans_sum_1m,
    MAX(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS other_expenses_trans_max_1m,
    MIN(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS other_expenses_trans_min_1m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS other_expenses_trans_count_2m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS other_expenses_trans_sum_2m,
    MAX(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS other_expenses_trans_max_2m,
    MIN(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS other_expenses_trans_min_2m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS other_expenses_trans_count_3m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS other_expenses_trans_sum_3m,
    MAX(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS other_expenses_trans_max_3m,
    MIN(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS other_expenses_trans_min_3m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS other_expenses_trans_count_4m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS other_expenses_trans_sum_4m,
    MAX(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS other_expenses_trans_max_4m,
    MIN(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS other_expenses_trans_min_4m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS other_expenses_trans_count_6m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS other_expenses_trans_sum_6m,
    MAX(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS other_expenses_trans_max_6m,
    MIN(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS other_expenses_trans_min_6m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS other_expenses_trans_count_12m,
    SUM(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS other_expenses_trans_sum_12m,
    MAX(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS other_expenses_trans_max_12m,
    MIN(CASE WHEN category = 'Прочие расходы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS other_expenses_trans_min_12m,


    -- ЖКУ, связь
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS jku_svyaz_trans_count_1m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS jku_svyaz_trans_sum_1m,
    MAX(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS jku_svyaz_trans_max_1m,
    MIN(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS jku_svyaz_trans_min_1m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS jku_svyaz_trans_count_2m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS jku_svyaz_trans_sum_2m,
    MAX(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS jku_svyaz_trans_max_2m,
    MIN(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS jku_svyaz_trans_min_2m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS jku_svyaz_trans_count_3m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS jku_svyaz_trans_sum_3m,
    MAX(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS jku_svyaz_trans_max_3m,
    MIN(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS jku_svyaz_trans_min_3m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS jku_svyaz_trans_count_4m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS jku_svyaz_trans_sum_4m,
    MAX(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS jku_svyaz_trans_max_4m,
    MIN(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS jku_svyaz_trans_min_4m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS jku_svyaz_trans_count_6m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS jku_svyaz_trans_sum_6m,
    MAX(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS jku_svyaz_trans_max_6m,
    MIN(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS jku_svyaz_trans_min_6m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS jku_svyaz_trans_count_12m,
    SUM(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS jku_svyaz_trans_sum_12m,
    MAX(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS jku_svyaz_trans_max_12m,
    MIN(CASE WHEN category = 'ЖКУ, связь' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS jku_svyaz_trans_min_12m,

    -- Техника и электроника
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS tech_electro_trans_count_1m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS tech_electro_trans_sum_1m,
    MAX(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS tech_electro_trans_max_1m,
    MIN(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS tech_electro_trans_min_1m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS tech_electro_trans_count_2m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS tech_electro_trans_sum_2m,
    MAX(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS tech_electro_trans_max_2m,
    MIN(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS tech_electro_trans_min_2m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS tech_electro_trans_count_3m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS tech_electro_trans_sum_3m,
    MAX(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS tech_electro_trans_max_3m,
    MIN(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS tech_electro_trans_min_3m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS tech_electro_trans_count_4m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS tech_electro_trans_sum_4m,
    MAX(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS tech_electro_trans_max_4m,
    MIN(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS tech_electro_trans_min_4m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS tech_electro_trans_count_6m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS tech_electro_trans_sum_6m,
    MAX(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS tech_electro_trans_max_6m,
    MIN(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS tech_electro_trans_min_6m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS tech_electro_trans_count_12m,
    SUM(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS tech_electro_trans_sum_12m,
    MAX(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS tech_electro_trans_max_12m,
    MIN(CASE WHEN category = 'Техника и электроника' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS tech_electro_trans_min_12m,

    -- Ювелирные изделия
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS jewelry_trans_count_1m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS jewelry_trans_sum_1m,
    MAX(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS jewelry_trans_max_1m,
    MIN(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS jewelry_trans_min_1m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS jewelry_trans_count_2m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS jewelry_trans_sum_2m,
    MAX(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS jewelry_trans_max_2m,
    MIN(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS jewelry_trans_min_2m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS jewelry_trans_count_3m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS jewelry_trans_sum_3m,
    MAX(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS jewelry_trans_max_3m,
    MIN(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS jewelry_trans_min_3m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS jewelry_trans_count_4m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS jewelry_trans_sum_4m,
    MAX(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS jewelry_trans_max_4m,
    MIN(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS jewelry_trans_min_4m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS jewelry_trans_count_6m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS jewelry_trans_sum_6m,
    MAX(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS jewelry_trans_max_6m,
    MIN(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS jewelry_trans_min_6m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS jewelry_trans_count_12m,
    SUM(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS jewelry_trans_sum_12m,
    MAX(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS jewelry_trans_max_12m,
    MIN(CASE WHEN category = 'Ювелирные изделия' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS jewelry_trans_min_12m,

    -- Одежда и обувь
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS clothes_footwear_trans_count_1m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS clothes_footwear_trans_sum_1m,
    MAX(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS clothes_footwear_trans_max_1m,
    MIN(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS clothes_footwear_trans_min_1m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS clothes_footwear_trans_count_2m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS clothes_footwear_trans_sum_2m,
    MAX(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS clothes_footwear_trans_max_2m,
    MIN(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS clothes_footwear_trans_min_2m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS clothes_footwear_trans_count_3m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS clothes_footwear_trans_sum_3m,
    MAX(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS clothes_footwear_trans_max_3m,
    MIN(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS clothes_footwear_trans_min_3m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS clothes_footwear_trans_count_4m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS clothes_footwear_trans_sum_4m,
    MAX(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS clothes_footwear_trans_max_4m,
    MIN(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS clothes_footwear_trans_min_4m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS clothes_footwear_trans_count_6m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS clothes_footwear_trans_sum_6m,
    MAX(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS clothes_footwear_trans_max_6m,
    MIN(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS clothes_footwear_trans_min_6m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS clothes_footwear_trans_count_12m,
    SUM(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS clothes_footwear_trans_sum_12m,
    MAX(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS clothes_footwear_trans_max_12m,
    MIN(CASE WHEN category = 'Одежда и обувь' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS clothes_footwear_trans_min_12m,

    -- Образование
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS education_trans_count_1m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS education_trans_sum_1m,
    MAX(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS education_trans_max_1m,
    MIN(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS education_trans_min_1m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS education_trans_count_2m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS education_trans_sum_2m,
    MAX(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS education_trans_max_2m,
    MIN(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS education_trans_min_2m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS education_trans_count_3m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS education_trans_sum_3m,
    MAX(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS education_trans_max_3m,
    MIN(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS education_trans_min_3m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS education_trans_count_4m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS education_trans_sum_4m,
    MAX(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS education_trans_max_4m,
    MIN(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS education_trans_min_4m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS education_trans_count_6m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS education_trans_sum_6m,
    MAX(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS education_trans_max_6m,
    MIN(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS education_trans_min_6m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS education_trans_count_12m,
    SUM(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS education_trans_sum_12m,
    MAX(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS education_trans_max_12m,
    MIN(CASE WHEN category = 'Образование' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS education_trans_min_12m,

    -- Финансы
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_cnt ELSE 0 END) AS finance_trans_count_1m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum ELSE 0 END) AS finance_trans_sum_1m,
    MAX(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS finance_trans_max_1m,
    MIN(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -1) THEN trans_sum END) AS finance_trans_min_1m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_cnt ELSE 0 END) AS finance_trans_count_2m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum ELSE 0 END) AS finance_trans_sum_2m,
    MAX(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS finance_trans_max_2m,
    MIN(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -2) THEN trans_sum END) AS finance_trans_min_2m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_cnt ELSE 0 END) AS finance_trans_count_3m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum ELSE 0 END) AS finance_trans_sum_3m,
    MAX(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS finance_trans_max_3m,
    MIN(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -3) THEN trans_sum END) AS finance_trans_min_3m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_cnt ELSE 0 END) AS finance_trans_count_4m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum ELSE 0 END) AS finance_trans_sum_4m,
    MAX(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS finance_trans_max_4m,
    MIN(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -4) THEN trans_sum END) AS finance_trans_min_4m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_cnt ELSE 0 END) AS finance_trans_count_6m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum ELSE 0 END) AS finance_trans_sum_6m,
    MAX(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS finance_trans_max_6m,
    MIN(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -6) THEN trans_sum END) AS finance_trans_min_6m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_cnt ELSE 0 END) AS finance_trans_count_12m,
    SUM(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum ELSE 0 END) AS finance_trans_sum_12m,
    MAX(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS finance_trans_max_12m,
    MIN(CASE WHEN category = 'Финансы' AND trans_dt >= ADD_MONTHS(:report_date, -12) THEN trans_sum END) AS finance_trans_min_12m

    from transactions 
    group by
    client_did, report_date) t;


